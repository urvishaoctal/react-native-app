(self.modernJsonp=self.modernJsonp||[]).push([["6325"],{17314:function(e,a,t){t.d(a,{Z:()=>d});var n,i,r=t(813653),l=t(831423),s=0,o=0;let d=function(e,a,t){var d=a&&t||0,u=a||Array(16),c=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:i;if(null==c||null==p){var m=e.random||(e.rng||r.Z)();null==c&&(c=n=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==p&&(p=i=(m[6]<<8|m[7])&16383)}var g=void 0!==e.msecs?e.msecs:Date.now(),h=void 0!==e.nsecs?e.nsecs:o+1,y=g-s+(h-o)/1e4;if(y<0&&void 0===e.clockseq&&(p=p+1&16383),(y<0||g>s)&&void 0===e.nsecs&&(h=0),h>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");s=g,o=h,i=p;var f=((0xfffffff&(g+=122192928e5))*1e4+h)%0x100000000;u[d++]=f>>>24&255,u[d++]=f>>>16&255,u[d++]=f>>>8&255,u[d++]=255&f;var _=g/0x100000000*1e4&0xfffffff;u[d++]=_>>>8&255,u[d++]=255&_,u[d++]=_>>>24&15|16,u[d++]=_>>>16&255,u[d++]=p>>>8|128,u[d++]=255&p;for(var x=0;x<6;++x)u[d+x]=c[x];return a||(0,l.Z)(u)}},135885:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>r});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardAttribution_pin",selections:[{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};i.hash="610a35d46510240eb58e262c1909310c";let r=i},5375:function(e,a,t){var n,i,r;t.r(a),t.d(a,{default:()=>s});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardBody_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[r={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{args:null,kind:"FragmentSpread",name:"RecipeMetadata_recipe"}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null}],storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},r,{args:null,kind:"FragmentSpread",name:"usePinImageUrls_pin"},{args:null,kind:"FragmentSpread",name:"useNormalizePinData_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardAttribution_pin"}],type:"Pin",abstractKey:null};l.hash="81db65fd15680cc0281b801ed4a8cb94";let s=l},716125:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CutoutObject_pin",selections:[{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"}],type:"Pin",abstractKey:null};n.hash="f1b62436c05814e4188c8863a11dce6b";let i=n},431225:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CutoutObjects_pin",selections:[{args:null,kind:"FragmentSpread",name:"CutoutObject_pin"},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"}],type:"Pin",abstractKey:null};n.hash="d2b8de09e9a0bd76025dff9de4c764e8";let i=n},500698:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Descriptors_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null}],type:"Pin",abstractKey:null};n.hash="9d15639e8d9dd61426917dc218fbb3a6";let i=n},212480:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"OneBar_oneBarModules",selections:[{alias:"entityId",args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"OneBarModule_oneBarModules"}],type:"OneBarModule",abstractKey:null};n.hash="45cea1099e24f55ebce4abebdb411447";let i=n},815025:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>r});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RecipeMetadata_recipe",selections:[{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:n,storageKey:null}],storageKey:null}],type:"RecipeMetadata",abstractKey:null};i.hash="12f77507a9fdec344b44b7e659fa5ac1";let r=i},984110:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsImageContent_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"}],type:"Pin",abstractKey:null};n.hash="727c8ab2c1c256e3b4478a36890f92d6";let i=n},55575:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={fragment:{argumentDefinitions:r=[{defaultValue:null,kind:"LocalArgument",name:"pinId"}],kind:"Fragment",metadata:null,name:"RelatedProductsPageQuery",selections:[{alias:null,args:l=[{kind:"Variable",name:"pin",variableName:"pinId"}],concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[s,{args:null,kind:"FragmentSpread",name:"RelatedProductsPage_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:r,kind:"Operation",name:"RelatedProductsPageQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o=[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o,storageKey:'images(spec:"orig")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"f208fe307530ca4ea705ee56b7245b5be8f9b9b8638528bcbb8692bf123b40e6",metadata:{},name:"RelatedProductsPageQuery",operationKind:"query",text:null}};n.hash="0f7b98a1f02dbf8528df0452aa26efd4";let i=n;var r,l,s,o,d=n.default||n;if("query"===d.params.operationKind)if(window.__pwsCacheRelayConcreteRequest)window.__pwsCacheRelayConcreteRequest(d);else{let e=[d.params.name,d.params.id].join(":");window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__=window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__||{},window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__[e]=d}},376985:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsPage_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchPageWithPinData_pin"}],type:"Pin",abstractKey:null};n.hash="91d05676e413b7b47653c2f8fa609093";let i=n},758809:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsUnifiedFeed_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchMasonryGrid_pin"}],type:"Pin",abstractKey:null};n.hash="20c2c7f4ff982fb93a9608faa14f3ed2";let i=n},582328:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StelaCutouts_pin",selections:[{args:null,kind:"FragmentSpread",name:"StelaCutout_pin"},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"}],type:"Pin",abstractKey:null};n.hash="2d79886cca650301394af9cbacdeede4";let i=n},584411:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthCropperContainer_pin",selections:[{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"FlashlightSpotlightDots_pin"}],type:"Pin",abstractKey:null};n.hash="939d46d8644385a7918ed8179ce77a4c";let i=n},165135:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n=(r=[{defaultValue:null,kind:"LocalArgument",name:"pinId"}],l=[{kind:"Variable",name:"pin",variableName:"pinId"}],s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},u=[{kind:"Literal",name:"spec",value:"564x"}],g=[{kind:"Literal",name:"spec",value:"736x"}],h=[m={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],y=[{kind:"Literal",name:"spec",value:"474x"}],f=[{kind:"Literal",name:"spec",value:"236x"}],_={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},S=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],w={alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:v=[s],storageKey:null},b={alias:"image236x",args:f,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:v,storageKey:'additionalImagesPerSpec(spec:"236x")'},k={alias:"image474x",args:y,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:v,storageKey:'additionalImagesPerSpec(spec:"474x")'},P={alias:"image564x",args:u,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:v,storageKey:'additionalImagesPerSpec(spec:"564x")'},C={alias:"image736x",args:g,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:v,storageKey:'additionalImagesPerSpec(spec:"736x")'},F={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},T={alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},j=[p],{fragment:{argumentDefinitions:r,kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPageFetchData_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:r,kind:"Operation",name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},o,{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},d],storageKey:null},{alias:"imageSpec_564x",args:u,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[c,p,m],storageKey:'images(spec:"564x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[c,p,m,s],storageKey:'images(spec:"orig")'},{alias:"imageSpec_736x",args:g,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"736x")'},{alias:"imageSpec_474x",args:y,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:f,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},o,d,{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[_,{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[x,{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[_,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:S,storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:S,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[s,_,w,{alias:null,args:null,concreteType:"Brand",kind:"LinkedField",name:"brand",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"signature",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ShippingInfo",kind:"LinkedField",name:"shippingInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"freeShippingPrice",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"freeShippingValue",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariantSet",kind:"LinkedField",name:"variantSet",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionMetadata",kind:"LinkedField",name:"dimensionMetadata",plural:!0,selections:[_,{alias:null,args:null,kind:"ScalarField",name:"values",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariant",kind:"LinkedField",name:"variants",plural:!0,selections:v,storageKey:null}],storageKey:null},b,k,P,C],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[_,w,{alias:null,args:null,kind:"ScalarField",name:"itemId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"itemSetId",storageKey:null},b,k,P,C],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[F,T,I],storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null},I,s],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},R,{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},x,{alias:"imageSpec_60x60",args:[{kind:"Literal",name:"spec",value:"60x60"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:j,storageKey:'images(spec:"60x60")'},{alias:"imageSpec_136x136",args:[{kind:"Literal",name:"spec",value:"136x136"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:j,storageKey:'images(spec:"136x136")'},{alias:"imageSpec_170x",args:[{kind:"Literal",name:"spec",value:"170x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:j,storageKey:'images(spec:"170x")'},{alias:"imageSpec_600x315",args:[{kind:"Literal",name:"spec",value:"600x315"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:j,storageKey:'images(spec:"600x315")'},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null},{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[R,_,{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},p,I],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[R,T,{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},F,I],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isOosProduct",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStaleProduct",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:v,storageKey:null},I],storageKey:null},{alias:null,args:null,concreteType:"ProductMetadataV2",kind:"LinkedField",name:"productPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"ItemMetadata",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"additionalImagesLength",storageKey:null}],storageKey:null},I],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shoppingFlags",storageKey:null},{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isShopTheLook",storageKey:null},I],storageKey:null},I],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"4f98fda893ba1980532b9905b28f196e419e75b106a6485f5f63653917b888e1",metadata:{},name:"UnauthDesktopFlashlightPageFetchDataPinQuery",operationKind:"query",text:null}});n.hash="c1c702b23a1454b46f8e2fa9d8036257";let i=n;var r,l,s,o,d,u,c,p,m,g,h,y,f,_,x,S,v,w,b,k,P,C,F,T,I,R,j,E=n.default||n;if("query"===E.params.operationKind)if(window.__pwsCacheRelayConcreteRequest)window.__pwsCacheRelayConcreteRequest(E);else{let e=[E.params.name,E.params.id].join(":");window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__=window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__||{},window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__[e]=E}},514336:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchData_pin",selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPage_pin"}],type:"Pin",abstractKey:null};n.hash="01839fc3bcd9cdaf206873364167d157";let i=n},579652:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>r});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"orig")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardBody_pin"},{args:null,kind:"FragmentSpread",name:"UnauthCropperContainer_pin"}],type:"Pin",abstractKey:null};i.hash="93612431e09eadc717c32d98e8d91e06";let r=i},172359:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCarousel_story",selections:[{alias:null,args:null,concreteType:"StoryAction",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"objects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:"storyId",args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyType",storageKey:null},{args:null,kind:"FragmentSpread",name:"CSSCarouselModule_story"}],type:"Story",abstractKey:null};n.hash="f426019c8f8e2668ff17a413d85a72dd";let i=n},829187:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsImageContent_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsUnifiedFeed_pin"}],type:"Pin",abstractKey:null};n.hash="3a9a747c3135f426fe0cf32ca9147a5d";let i=n},934209:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCropper_pin",selections:[{args:null,kind:"FragmentSpread",name:"useSamSegmentation_pin"},{args:null,kind:"FragmentSpread",name:"StelaCutouts_pin"},{args:null,kind:"FragmentSpread",name:"CutoutObjects_pin"}],type:"Pin",abstractKey:null};n.hash="66496d579d49595f2dec36d1c939738c";let i=n},922081:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchImageContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchImage_pin"},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"}],type:"Pin",abstractKey:null};n.hash="0266a98499053ece967eca560905770c";let i=n},452486:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchImage_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"}],type:"Pin",abstractKey:null};n.hash="5bacba9a50f154e988220cb4b6be32b2";let i=n},331921:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchLayout_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchImageContainer_pin"}],type:"Pin",abstractKey:null};n.hash="3c3f391c3bf9eec79c18ed9a3fe63800";let i=n},553593:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchPageWithPinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchContainer_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchLayout_pin"}],type:"Pin",abstractKey:null};n.hash="a97627ca011ed4139267bc5a970d6d7a";let i=n},799956:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>r});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useNormalizePinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"orig")'},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:n=[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null};i.hash="01a93671cde480baa2cfd8b781589acd";let r=i},160187:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useSamSegmentation_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],type:"Pin",abstractKey:null};n.hash="50c726067ab8af873ed4afded90b7bed";let i=n},742235:function(e,a,t){t.r(a),t.d(a,{default:()=>S});var n,i=t(281098),r=t(667294),l=t(167912),s=t(825332),o=t(20256),d=t(618140),u=t(29313),c=t(748130),p=t(289032),m=t(525839),g=t(816358),h=t(809295),y=t(15667),f=t(271910),_=t(785893);let x=(void 0!==n||(n=t(212480)).hash&&"45cea1099e24f55ebce4abebdb411447"!==n.hash&&console.error("The definition of 'OneBar_oneBarModules' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function S({center:e=!1,hasProductFiltersApplied:a,hrefOverride:t,itemHeight:n=d.Lu,marginBottom:S=d.JC,oneBarModulesKey:v,oneBarModulesRest:w,onFilterButtonClick:b,paddingBottom:k=d.uS,paddingX:P=d.jf,variant:C,viewParameter:F,viewType:T}){(0,i.Z)("OneBar","/app/common/react/components/OneBar/OneBar.tsx");let I=(0,r.useRef)(null),R=I.current?.firstElementChild?.firstElementChild?.firstElementChild,[j,E]=(0,r.useState)(0),[Z,M]=(0,r.useState)(0),[A,D]=(0,r.useState)(!1),[L,K]=(0,r.useState)(!1),[$,O]=(0,r.useState)(0),N=(0,s.TH)(),B=(0,m.ZP)(),{isRTL:z}=(0,y.B)(),U=(0,r.useRef)(!1),V=new h.ZP,G=(0,l.useFragment)(x,v),H=G&&[G]||w,W=e&&(R?.clientWidth||0)>=(R?.scrollWidth||0);(0,r.useEffect)(()=>{let e=e=>{"Tab"===e.key&&(U.current=!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]),(0,r.useEffect)(()=>{E(0)},[N]),(0,r.useEffect)(()=>{M(R?.clientWidth||0);let e=(0,p.Z)(()=>{M(R?.clientWidth||0)},100,{maxWait:200});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[R]),(0,r.useEffect)(()=>{let e=I.current;return e&&g.Z.addObstruction("top",e),()=>{e&&g.Z.removeObstruction("top",e)}}),(0,r.useEffect)(()=>{let e=R?.scrollWidth||0,a=0;for(let e=0;e<j;e+=1)a+=R?.children[e]?.offsetWidth||0;let t=e-a,n=Z>=e;n&&E(0),D(j>0&&!n),K(t>Z&&j<H.length&&!n),O(a)},[R,j,H.length,Z,$,z]);let Y=()=>{j+3<H.length?E(j+3):E(H.length-1)},X=()=>{j-3>=0?E(j-3):E(0)},q=(0,r.useRef)(null),{isFiltersDrawerFocused:Q}=(0,u.e)()||{isFiltersDrawerFocused:!1},[J,ee]=(0,r.useState)(Q);return(0,r.useEffect)(()=>{!Q&&J&&q.current?.focus(),ee(Q)},[Q,J]),H.length>0&&(0,_.jsx)(f.q,{children:({hovered:e,onMouseEnter:i,onMouseLeave:r})=>(0,_.jsxs)(o.xu,{ref:I,color:"default",dangerouslySetInlineStyle:{__style:{paddingBottom:k}},"data-root-margin":"search-one-bar","data-test-id":"scrollable-one-bar-root",marginBottom:S,onMouseEnter:i,onMouseLeave:r,position:"relative",children:[(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{overflowX:"clip"}},paddingX:P,position:"relative",children:(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{[z?"right":"left"]:`-${$}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,_.jsx)(o.kC,{alignItems:"center",gap:{row:2,column:0},height:n,justifyContent:W?"center":void 0,children:H.map((e,n)=>(0,_.jsx)(o.xu,{ref:1===n?q:void 0,onFocus:()=>{U.current||E(n)},onMouseDown:()=>U.current=!0,tabIndex:1===n?-1:void 0,children:(0,_.jsx)(c.Z,{hasProductFiltersApplied:a,hrefOverride:t,impressionsFramework:V,index:n,module:e,oneBarModulesKey:G??null,onFilterButtonClick:b,variant:C,viewParameter:F,viewType:T})},`OneBarModule-${e.entityId||e.id||""}`))})})}),e&&(0,_.jsxs)(o.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{background:(0,d.KC)(z,A,L),paddingBottom:d.uS,paddingLeft:d.EA,paddingRight:d.EA,pointerEvents:"none"}},"data-test-id":"one-bar-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:A&&(0,_.jsx)(o.hU,{accessibilityLabel:B._('Back', 'oneBar.navArrow.back', 'Accessibility laber for a button that navigates back to previous search guides'),bgColor:"white",icon:"arrow-back",onClick:X})}),(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:L&&(0,_.jsx)(o.hU,{accessibilityLabel:B._('Forward', 'oneBar.navArrow.forward', 'Accessibility laber for a button that navigates forward to see more search guides'),bgColor:"white",icon:"arrow-forward",onClick:Y})})]})]})})}},699473:function(e,a,t){t.d(a,{Z:()=>r});var n=t(450808);let i=`pulsing {
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
}`,r={css:(0,n.Ll)([i]),animation:"pulsing 2s infinite"}},241646:function(e,a,t){t.d(a,{n:()=>n});let n=20},583270:function(e,a,t){t.d(a,{Z:()=>i});var n=t(378888);function i(e,a,t){let i=(0,n.mB)(e.search),r=parseFloat(i.x??""),l=parseFloat(i.y??""),s=parseFloat(i.w??""),o=parseFloat(i.h??"");if(function(...e){return e.every(e=>e>=0&&e<=1)}(r,l,s,o)&&a&&t)return{x:Math.floor(r*a),y:Math.floor(l*t),w:Math.floor(s*a),h:Math.floor(o*t)};{let e=parseInt(i.x??"",10),a=parseInt(i.y??"",10),t=parseInt(i.w??"",10),n=parseInt(i.h??"",10);return!function(...e){return e.every(Number.isInteger)}(e,a,t,n)?null:{x:e,y:a,w:t,h:n}}}},351222:function(e,a,t){t.d(a,{Pw:()=>n,SB:()=>i,ZP:()=>l,x9:()=>r});let n=80,i=55,r=e=>"phone"===e?i:n;function l(e,a){return a?0:r(e)}},166379:function(e,a,t){t.d(a,{Z:()=>l,k:()=>i.kH});var n=t(281098),i=t(654937),r=t(15667);let l=({dateFormatType:e,useUTC:a=!0,value:t})=>{(0,n.Z)("PrettyDate","/app/packages/dates/PrettyDate.tsx");let l=(0,r.B)();return(0,i.ZP)(l.locale,t,e,a)}},469167:function(e,a,t){t.r(a),t.d(a,{default:()=>j});var n=t(281098),i=t(667294),r=t(20256),l=t(748065),s=t(980787),o=t(722194);function d(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}let u={},c=e=>{let a=e.__id||e.id;return"string"==typeof a&&a||null};class p{constructor(){d(this,"idMap",new Map),d(this,"objMap",new WeakMap)}get(e){let a=c(e);return this.objMap.get(e)??(a?this.idMap.get(a):void 0)}has(e){let a=c(e);return this.objMap.has(e)??(!!a&&this.idMap.has(a))}set(e,a){let t=c(e);t&&this.idMap.set(t,a),this.objMap.set(e,a)}reset(){this.idMap=new Map,this.objMap=new WeakMap}}function m(e,a){return"number"==typeof e?e:"lg1"===a?e[a]??e.lg??1:e[a]??1}var g=t(467925),h=t(947543),y=t(699473),f=t(461951),_=t(369416),x=t(785893);let{css:S,animation:v}=y.Z,w={backgroundColor:f.zsO,animation:v,borderRadius:f.saV};function b({data:e}){(0,n.Z)("SkeletonPin","/app/common/react/components/SkeletonLoadingStates/SkeletonPin.tsx");let{height:a}=e;return(0,x.jsxs)(i.Fragment,{children:[(0,x.jsx)(_.Z,{unsafeCSS:S}),(0,x.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:w},"data-test-id":"skeleton-pin",children:(0,x.jsx)(r.xu,{height:a})})]})}var k=t(93966),P=t(274320),C=t(15667),F=t(647709),T=t(603316),I=t(160374),R=t(183152);function j(e){(0,n.Z)("Masonry","/app/packages/gestaltExtensions/Masonry/Masonry.tsx");let{align:a,cacheKey:t,id:d,isFetching:c,isGridCentered:y=!0,items:f,layout:S,loadItems:v,masonryRef:w,optOutFluidGridExperiment:j=!1,renderItem:E,scrollContainerRef:Z,virtualize:M=!0,getColumnSpanConfig:A,_getResponsiveModuleConfigForSecondItem:D,isLoadingStateEnabled:L,initialLoadingStatePinCount:K,isLoadingAccessibilityLabel:$,isLoadedAccessibilityLabel:O}=e,N=(0,F.ZP)(),B=(0,C.B)(),{isAuthenticated:z,isRTL:U}=B,{logContextEvent:V}=(0,s.u)(),G=(0,P.r)(),H="desktop"===N,W=(0,R.Zv)(),Y=(0,I.DB)(),X=((0,i.useRef)(f.map(()=>({fetchTimestamp:Date.now(),measureTimestamp:Date.now(),hasRendered:!1,pageCount:0}))),H&&!j),{experimentalColumnWidth:q,experimentalGutter:Q}=(0,g.Z)(X),J=e.serverRender??!!H,ee="flexible"===S||"uniformRowFlexible"===S||"desktop"!==N||X,ea=(ee&&S?.startsWith("uniformRow")?"uniformRowFlexible":void 0)??(J?"serverRenderedFlexible":"flexible"),et=e.columnWidth??q??k.yF;ee&&(et=Math.floor(et));let en=e.gutterWidth??Q??(H?k.oX:1),ei=e.minCols??k.yc,er=((0,i.useRef)(0),et+en),el=function(e){if(null==e)return;let a=function(e){let a=u[e];return a&&a.screenWidth===window.innerWidth||(u[e]={screenWidth:window.innerWidth}),u[e]}(e);return a.measurementCache||(a.measurementCache=new p),a.measurementCache}(t),es=(0,i.useCallback)(()=>Z?.current||window,[Z]),eo=(0,i.useRef)(!0),{anyEnabled:ed}=G.checkExperiment("web_masonry_pin_overlap_calculation_and_logging"),{anyEnabled:eu}=G.checkExperiment("web_masonry_fluid_reflow"),{anyEnabled:ec}=G.checkExperiment("visual_search_stl_eligibility_check_migration_gss_css",{dangerouslySkipActivation:!0}),ep=y&&eo.current?"centered":"",{className:em,styles:eg}=function(e){let a=`m_${Object.keys(e).sort().reduce((a,t)=>{let n=e[t];return null==n||"object"==typeof n||"function"==typeof n?a:"boolean"==typeof n?a+(n?"t":"f"):a+n},"").replace(/\:/g,"\\:")}`,{flexible:t,gutterWidth:n,isRTL:i,itemWidth:r,maxColumns:l,minColumns:s,items:o,getColumnSpanConfig:d,_getResponsiveModuleConfigForSecondItem:u}=e,c=d?o.map((e,a)=>({index:a,columnSpanConfig:d(e)??1})).filter(e=>1!==e.columnSpanConfig):[],p=r+n,g=Array.from({length:l+1-s},(e,a)=>a+s).map(e=>{let g,h,y=e===s?0:e*p,f=e===l?null:(e+1)*p-.01;d&&u&&o.length>1&&(g=d(o[0]),h=u(o[1]));let{styles:_,numberOfVisibleItems:x}=c.reduce((i,l)=>{let{columnSpanConfig:s}=l,d=Math.min(function({columnCount:e,columnSpanConfig:a,firstItemColumnSpanConfig:t,isFlexibleWidthItem:n,secondItemResponsiveModuleConfig:i}){let r=e<=2?"sm":e<=4?"md":e<=6?"lg1":e<=8?"lg":"xl",l=m(a,r);if(n){let a=m(t,r);l="number"==typeof i?i:i?Math.max(i.min,Math.min(i.max,e-a)):1}return l}({columnCount:e,columnSpanConfig:s,isFlexibleWidthItem:!!h&&l===o[1],firstItemColumnSpanConfig:g??1,secondItemResponsiveModuleConfig:h??1}),e),u=null!=l.index&&i.numberOfVisibleItems>=d+l.index,c=t?100/e*d:r*d+n*(d-1),{numberOfVisibleItems:p}=i;return u?p-=d-1:l.index<p&&(p+=1),{styles:i.styles.concat(function({className:e,index:a,columnSpanConfig:t,visible:n,width:i,flexible:r}){let l="number"==typeof t?t:btoa(JSON.stringify(t));return r?`
      .${e} .static[data-column-span="${l}"]:nth-child(${a+1}) {
        visibility: ${n?"visible":"hidden"} !important;
        position: ${n?"inherit":"absolute"} !important;
        width: ${i}% !important;
      }`:`
      .${e} .static[data-column-span="${l}"]:nth-child(${a+1}) {
        visibility: ${n?"visible":"hidden"} !important;
        position: ${n?"inherit":"absolute"} !important;
        width: ${i}px !important;
      }`}({className:a,index:l.index,columnSpanConfig:s,visible:u,width:c,flexible:t})),numberOfVisibleItems:p}},{styles:"",numberOfVisibleItems:e}),S=t?`
      .${a} .static {
        box-sizing: border-box;
        width: calc(100% / ${e}) !important;
      }
    `:`
      .${a} {
        max-width: ${e*p}px;
      }

      .${a} .static {
        width: ${r}px !important;
      }
    `;return{minWidth:y,maxWidth:f,styles:`
      .${a} .static:nth-child(-n+${x}) {
        position: static !important;
        visibility: visible !important;
        float: ${i?"right":"left"};
        display: block;
      }

      .${a} .static {
        padding: 0 ${n/2}px;
      }

      ${S}

      ${_}
    `}}),h=g.map(({minWidth:e,maxWidth:a,styles:t})=>`
    @container (min-width: ${e}px) ${a?`and (max-width: ${a}px)`:""} {
      ${t}
    }
  `),y=g.map(({minWidth:e,maxWidth:a,styles:t})=>`
    @media (min-width: ${e}px) ${a?`and (max-width: ${a}px)`:""} {
      ${t}
    }
  `),f=`
    ${h.join("")}
    @supports not (container-type: inline-size) {
      ${y.join("")}
    }
  `;return{className:a,styles:`
    .masonryContainer:has(.${a}) {
      container-type: inline-size;
    }

    .masonryContainer > .centered {
      margin-left: auto;
      margin-right: auto;
    }

    .${a} .static {
      position: absolute !important;
      visibility: hidden !important;
    }

    ${f}
  `}}({gutterWidth:en,flexible:ee,items:f,isRTL:U,itemWidth:et,maxColumns:e.maxColumns??Math.max(f.length,k.g5),minColumns:ei,getColumnSpanConfig:A,_getResponsiveModuleConfigForSecondItem:D}),eh=`${ep} ${em}`.trim(),{anyEnabled:ey,expName:ef,group:e_,isMeasureAllEnabled:ex}=(0,h.Z)(),eS=((0,i.useRef)(void 0),(0,i.useRef)(f.length)),ev=(0,i.useRef)(0),ew=(0,i.useRef)(null);(0,i.useEffect)(()=>{eS.current=f.length,ev.current+=1},[f]),(0,i.useEffect)(()=>{if(eo.current&&(eo.current=!1),window.earlyGridRenderStats){let e={...(0,I.M3)({earlyHydrationConfig:Y,handlerId:W,requestContext:B}),status:window.earlyGridRenderStats.status??"unknown"};(0,T.nP)(`earlyHydrationDebug.masonry.earlyGridRender.status.${window.earlyGridRenderStats.status}`,{tags:e}),(0,T.LY)("earlyHydrationDebug.masonry.earlyGridRender.init",window.earlyGridRenderStats.init,{tags:e}),window.earlyGridRenderStats.start&&(0,T.LY)("earlyHydrationDebug.masonry.earlyGridRender.start",window.earlyGridRenderStats.start,{tags:e}),window.earlyGridRenderStats.end&&(0,T.LY)("earlyHydrationDebug.masonry.earlyGridRender.end",window.earlyGridRenderStats.end,{tags:e})}},[]),(0,i.useEffect)(()=>()=>{},[]);let eb=(0,i.useCallback)(e=>{let a=e.reduce((e,a)=>e+a),t=a/e.length;(0,T.S0)("webapp.masonry.multiColumnWhitespace.average",t,{sampleRate:1,tags:{experimentalMasonryGroup:e_||"unknown",handlerId:W,isAuthenticated:z,multiColumnItemSpan:e.length}}),(0,T.S0)("webapp.masonry.twoColWhitespace",t,{sampleRate:1,tags:{columnWidth:et,minCols:ei}}),V({event_type:15878,component:14468,aux_data:{total_whitespace_px:a}}),V({event_type:16062,component:14468,aux_data:{average_whitespace_px:t}}),V({event_type:16063,component:14468,aux_data:{max_whitespace_px:Math.max(...e)}}),e.forEach(a=>{a>=50&&((0,T.nP)("webapp.masonry.multiColumnWhitespace.over50",{sampleRate:1,tags:{experimentalMasonryGroup:e_||"unknown",handlerId:W,isAuthenticated:z,multiColumnItemSpan:e.length}}),V({event_type:16261,component:14468})),a>=100&&((0,T.nP)("webapp.masonry.multiColumnWhitespace.over100",{sampleRate:1,tags:{experimentalMasonryGroup:e_||"unknown",handlerId:W,isAuthenticated:z,multiColumnItemSpan:e.length}}),V({event_type:16262,component:14468}))}),(0,T.nP)("webapp.masonry.multiColumnWhitespace.count",{sampleRate:1,tags:{experimentalMasonryGroup:e_||"unknown",handlerId:W,isAuthenticated:z,multiColumnItemSpan:e.length}})},[et,V,ei,z,W,e_]),{_items:ek,_renderItem:eP}=function({initialLoadingStatePinCount:e=50,infiniteScrollPinCount:a=10,isFetching:t,items:r=[],renderItem:l,isLoadingStateEnabled:s}){(0,n.Z)("useSkeletonPins","/app/packages/gestaltExtensions/Masonry/useSkeletonPins.tsx");let o=+(r.filter(e=>"object"==typeof e&&null!==e&&"type"in e&&"closeup_module"===e.type).length>0),d=s&&t,u=(0,i.useMemo)(()=>Array.from({length:r.length>o?a:e}).reduce((e,a,t)=>[...e,{height:t%2==0?356:236,key:`skeleton-pin-${t}`,isSkeleton:!0}],[]),[r.length,o,a,e]);return{_items:(0,i.useMemo)(()=>d?[...r,...u]:r,[d,r,u]),_renderItem:(0,i.useMemo)(()=>s?e=>{let{itemIdx:a,data:t}=e;return a>=r.length&&t&&"object"==typeof t&&"key"in t&&"height"in t?(0,x.jsx)(b,{data:t},t.key):l(e)}:l,[s,l,r.length])}}({isLoadingStateEnabled:L,items:f,renderItem:(0,i.useCallback)(e=>(0,x.jsx)(o.Z,{name:"MasonryItem",children:E(e)}),[E]),isFetching:c,initialLoadingStatePinCount:K}),eC=L&&c,eF=(0,i.useRef)(new Set);(0,i.useEffect)(()=>{if(!ed)return;let e=setTimeout(()=>{requestAnimationFrame(()=>{let e=Array.from(ew.current?.querySelectorAll("[data-grid-item-idx]")??[]);if(0===e.length)return;let a=e.map(e=>{let a=e.getAttribute("data-grid-item-idx");return{rect:e.getBoundingClientRect(),itemIdx:a}}),t=0,n=0,i=0,r=0,l=0,s=0;for(let e=0;e<a.length;e+=1){let o=a[e]?.rect,d=a[e]?.itemIdx;for(let u=e+1;u<a.length;u+=1){let e=a[u]?.rect,c=a[u]?.itemIdx;if(o&&e&&d&&c){let a=[d,c].sort().join("|");if(!eF.current.has(a)&&o.right>=e.left&&o.left<=e.right&&o.bottom>=e.top&&o.top<=e.bottom&&o.height>0&&e.height>0){eF.current.add(a),t+=1;let d=Math.max(0,Math.min(o.right,e.right)-Math.max(o.left,e.left))*Math.max(0,Math.min(o.bottom,e.bottom)-Math.max(o.top,e.top));d>8e4?s+=1:d>4e4?l+=1:d>1e4?r+=1:d>5e3?i+=1:d>2500&&(n+=1)}}}}t>0&&(0,T.QX)("webapp.masonry.pinOverlapHits",t,{tags:{isAuthenticated:z,isDesktop:H,handlerId:W,experimentalMasonryGroup:e_||"unknown",fluidResizeExperiment:eu?"true":"false",visualSearchSTLexperiment:ec?"true":"false"}}),n>0&&(0,T.QX)("webapp.masonry.pinOverlap.AreaPx.over2500",n,{tags:{isAuthenticated:z,isDesktop:H,handlerId:W,experimentalMasonryGroup:e_||"unknown",fluidResizeExperiment:eu?"true":"false",visualSearchSTLexperiment:ec?"true":"false"}}),i>0&&(0,T.QX)("webapp.masonry.pinOverlap.AreaPx.over5000",i,{tags:{isAuthenticated:z,isDesktop:H,handlerId:W,experimentalMasonryGroup:e_||"unknown",fluidResizeExperiment:eu?"true":"false",visualSearchSTLexperiment:ec?"true":"false"}}),r>0&&(0,T.QX)("webapp.masonry.pinOverlap.AreaPx.over10000",r,{tags:{isAuthenticated:z,isDesktop:H,handlerId:W,experimentalMasonryGroup:e_||"unknown",fluidResizeExperiment:eu?"true":"false",visualSearchSTLexperiment:ec?"true":"false"}}),l>0&&(0,T.QX)("webapp.masonry.pinOverlap.AreaPx.over40000",l,{tags:{isAuthenticated:z,isDesktop:H,handlerId:W,experimentalMasonryGroup:e_||"unknown",fluidResizeExperiment:eu?"true":"false",visualSearchSTLexperiment:ec?"true":"false"}}),s>0&&(0,T.QX)("webapp.masonry.pinOverlap.AreaPx.over80000",s,{tags:{isAuthenticated:z,isDesktop:H,handlerId:W,experimentalMasonryGroup:e_||"unknown",fluidResizeExperiment:eu?"true":"false",visualSearchSTLexperiment:ec?"true":"false"}})})},1e3);return()=>{clearTimeout(e)}},[et,e_,eu,z,H,ed,f,W,ec]);let eT=(0,l.Z)(),eI=(0,i.useCallback)(e=>{w&&(w.current=e)},[w]);return(0,x.jsxs)(i.Fragment,{children:[L&&!eo.current&&(0,x.jsx)(r.xu,{"aria-live":"polite",display:"visuallyHidden",children:eC?$:O}),(0,x.jsx)("div",{ref:ew,"aria-busy":L?!!eC:void 0,className:"masonryContainer","data-test-id":"masonry-container",id:d,style:X?{padding:`0 ${en/2}px`}:void 0,children:(0,x.jsxs)("div",{className:eh,children:[J&&eo.current?(0,x.jsx)(_.Z,{"data-test-id":"masonry-ssr-styles",unsafeCSS:eg}):null,(0,x.jsx)(r.xu,{"data-test-id":"max-width-container",marginBottom:0,marginEnd:"auto",marginStart:"auto",marginTop:0,maxWidth:e.maxColumns?er*e.maxColumns:void 0,children:ey?(0,x.jsx)(r.GX,{ref:eT?eI:e=>{w&&(w.current=e)},_dynamicHeights:!0,_getResponsiveModuleConfigForSecondItem:D,_logTwoColWhitespace:eb,_measureAll:ex,align:a,columnWidth:et,getColumnSpanConfig:A,gutterWidth:en,items:ek,layout:ee?ea:S??"basic",loadItems:v,measurementStore:el,minCols:ei,renderItem:eP,scrollContainer:es,virtualBufferFactor:.3,virtualize:M}):(0,x.jsx)(r.Rk,{ref:eT?eI:e=>{w&&(w.current=e)},_dynamicHeights:!0,_fluidResize:eu,_getResponsiveModuleConfigForSecondItem:D,_logTwoColWhitespace:eb,align:a,columnWidth:et,getColumnSpanConfig:A,gutterWidth:en,items:ek,layout:ee?ea:S??"basic",loadItems:v,measurementStore:el,minCols:ei,renderItem:eP,scrollContainer:es,virtualBufferFactor:.3,virtualize:M})})]})})]})}},115247:function(e,a,t){t.d(a,{Z:()=>l});var n=t(667294);function i(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class r extends n.Component{constructor(...e){super(...e),i(this,"ref",(0,n.createRef)()),i(this,"observer",null),i(this,"handleVisibilityChanged",(e,a)=>{this.props.onVisibilityChange(e,a)})}componentDidMount(){this.ref&&this.ref.current&&(this.observer=new window.IntersectionObserver(this.handleVisibilityChanged,this.props.options),this.observer.observe(this.ref.current))}componentWillUnmount(){this.observer&&(this.observer.unobserve(this.ref.current),delete this.observer)}render(){return this.props.children(this.ref)}}let l=r},377654:function(e,a,t){t.d(a,{Rq:()=>n,Vf:()=>i,jd:()=>r,oy:()=>l});let n=e=>"ios"===e&&(window.devicePixelRatio||1)*window.screen.height==2436,i=28,r=e=>window.innerHeight>=748&&n(e),l=()=>"undefined"!=typeof window&&!!window.navigator&&(/iPad/.test(navigator.platform)||"MacIntel"===navigator.platform&&"ontouchend"in document&&Math.min(window.screen.width,window.screen.height)>=700)},914061:function(e,a,t){t.r(a),t.d(a,{default:()=>u});var n=t(281098),i=t(20256),r=t(93966),l=t(377654),s=t(657389),o=t(15667),d=t(785893);let u=({children:e,dataLayoutShiftBoundaryId:a,hasFixedHeader:t=!1,hasGutter:u=!0,height:c,showKeychainError:p=!1,useViewport:m=!1})=>{(0,n.Z)("MobilePageContainer","/app/packages/layout/MobilePageContainer.tsx");let g=(0,o.B)(),h=(0,l.jd)(g.userAgent.platform)?l.Vf:0;return(0,d.jsx)(i.xu,{"data-layout-shift-boundary-id":a||"PageContainer",height:m?`calc(100vh - ${h}px)`:c,paddingX:u?r.D6:void 0,paddingY:t||p?void 0:3,children:(0,d.jsx)(s.C,{value:!!u,children:e})})}},267828:function(e,a,t){t.d(a,{r:()=>n});function n(e,a,t){return!!(e&&e.trim().length>0&&a&&!t)}},918874:function(e,a,t){t.d(a,{Z:()=>s}),t(167912);var n,i=t(415546),r=t(19585);let l=(void 0!==n||(n=t(799956)).hash&&"01a93671cde480baa2cfd8b781589acd"!==n.hash&&console.error("The definition of 'useNormalizePinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),s=e=>{let a,t=(0,r.Z)(),n=(0,i.Z)(l,e),s=n.trackedLink||n.link||n.imageSpec_orig&&n.imageSpec_orig.url,{richMetadata:o,richSummary:d}=n,u=t._('Saved from ', 'Closeup pin annotation', 'Closeup pin annotation');return o&&o.products&&o.products[0]&&o&&o.products[0].name&&o.products[0].offerSummary&&(u=t._('Product sold by ', 'pin annotation', 'pin annotation'),a=(o.products?.[0]||void 0)?.offerSummary),!a&&d&&d&&d.products&&d.products[0]&&d&&d.products[0].name&&d.products[0].offerSummary&&(u=t._('Product sold by ', 'pin annotation', 'pin annotation')),{pinLink:s,pinCreditPrefix:u,pinTitle:n.closeupUnifiedTitle,pinDescription:n.closeupUnifiedDescription,pinCategory:n.category}}},622481:function(e,a,t){t.d(a,{Z:()=>n});let n=(0,t(667294).createContext)(null)},282803:function(e,a,t){t.d(a,{Z:()=>n});let n=(0,t(667294).createContext)(null)},255957:function(e,a,t){t.d(a,{Z:()=>E});var n=t(281098),i=t(667294),r=t(286036),l=t(457636),s=t(592109),o=t(901360),d=t(392824),u=t(67831),c=t(703393),p=t(735201),m=t(868178),g=t(891631),h=t(594885),y=t(579358),f=t(970773),_=t(361423),x=t(15667),S=t(112114),v=t(603316),w=t(785893);let b=["initial_app_load","client_route_push"],k=(0,s.XV)("PwtSurface"),P="NavigationComplete",C="VisuallyComplete",F=()=>{(0,p._T)()},T=e=>{if(e.metricConfig.constraints.every(a=>e.constraintMap[a])){let t=Math.max(...e.metricConfig.constraints.map(a=>e.constraintMap[a])),{metricConfig:{metricId:n,pwtStaticContext:i,annotateExperiments:r},annotations:s,binaryAnnotations:u,constraintMap:m,startTime:g,imageTimings:h,spans:f,traceId:_}=e;(0,d.L8)(`Report_PWT_Complete_${(0,l.KJ)(n)}`,g,t);let x=(0,c.W)({annotateExperiments:[...r??[]],annotations:s,binaryAnnotations:u,constraintMap:m,endTime:t,imageTimings:h,metricId:n,pwtStaticContext:i,startTime:g,traceId:_,spans:f});try{var a=String(x.binaryAnnotationMap["metricId.surface"].value);let e=performance.getEntriesByType("resource").filter(e=>e.name.includes("i.pinimg")).reduce((e,a)=>{let t=a.name.replace(".jpg","").split("/");return{[t[t.length-1]]:{downloadSize:a.name.split("/")[3].split("x")[0]},...e}},{});[...Array.from(document.getElementsByTagName("img")).map(a=>{let t=a.src.replace(".jpg","").split("/"),n=t[t.length-1];if(e[n]){let t=(0,y.rZ)(a)?.width||1,i=e[n].downloadSize;return{fileName:n,renderedSize:t,downloadedSize:i,ratio:i/t}}return{fileName:n,renderedSize:1,downloadedSize:1,ratio:1}}),...Array.from(document.querySelectorAll('div[role="img"]')).map(a=>{let t=a.style.backgroundImage.split('"')[1].replace(".jpg","").split("/"),n=t[t.length-1];if(e[n]&&a instanceof HTMLDivElement){let t=(0,y.rZ)(a)?.width||1,i=e[n].downloadSize;return{fileName:n,renderedSize:t,downloadedSize:i,ratio:i/t}}return{fileName:n,renderedSize:1,downloadedSize:1,ratio:1}})].forEach(e=>{let{ratio:t,fileName:n,downloadedSize:i}=e;e.ratio>1.05&&(0,o.A9)(`checkImageRatio.${a}`,{count:Math.round(10*t)/10,tags:{fileName:`${i}_${n}`}})})}catch(e){(0,o.H)("image_ratio_check_error",{error:e})}return(0,p._T)(),{...e,result:x,status:"DONE"}}return k(`Remaining constraints: ${e.metricConfig.constraints.filter(a=>!e.constraintMap[a]).join(", ")}`),e},I=(e,a)=>{let{constraint:t,time:n}=a,i=(0,l.KJ)(e.metricConfig.metricId);return _.Z?e.metricConfig.constraints.find(e=>e===t)?e.constraintMap[t]?(k(`constraint "${t}" is already complete.`),(0,o.H)("duplicated_constraint_complete",{constraint:t,action:i}),e):(k(`marking constraint "${t}" as complete ${n||performance.now()}`),n?(0,d.ZP)(`constraint_${t}_is_complete`,n):(0,d.ZP)(`constraint_${t}_is_complete`),T({...e,constraintMap:{...e.constraintMap,[t]:n||_.Z.now()}})):(k(`marked constraint "${t}" is not a required constraint.`),e):((0,o.H)("missing_window_performance",{action:i}),e)},R=(e,a)=>{if(k("dispatch action",a),"INIT_ROUTE"===a.type)return((e,a)=>{let{metricConfig:t,startTime:n,isSampled:i,disablePWTLogging:r}=a;if(r||"TIMING"!==e.status||n===e.startTime||F(),!t)return{status:"DISABLED",metricConfig:null};let s=(0,l.KJ)(t.metricId);if("TIMING"===e.status&&e.startTime===n&&e.constraintMap[P])return(0,o.H)("duplicated_init_route_action",{action:s}),e;if(!r){let e=(0,S.H)();(0,o.A9)(`handler.${s}`,{tags:{handler:e}});let a=void 0!==t.metricId.isAuthenticated&&{tags:{isAuth:t.metricId.isAuthenticated}}||void 0;"Other"===t.pwtStaticContext.browserName&&!1===t.metricId.isAuthenticated&&"initial_app_load"===t.metricId.navigationType?((0,o.A9)(`TIMING.${s}`,{tags:{userAgent:window?.navigator?.userAgent}}),(0,o.A9)(`TIMING.sampled.${s}`,{tags:{userAgent:window?.navigator?.userAgent},sampleRate:.03})):((0,o.A9)(`TIMING.${s}`),(0,o.A9)(`TIMING.sampled.${s}`,{sampleRate:.03})),(0,m.C)({resultLog:`TIMING.${s}`,annotateExperiments:t.annotateExperiments||[],getExperimentGroup:t.pwtStaticContext.getExperimentGroup,options:a})}return I({traceId:(0,p.vc)()||(0,p.ZP)("initial_app_load"===t.metricId.navigationType,t.pwtStaticContext.serverData?.trace_id),status:"TIMING",metricConfig:t,startTime:n,constraintMap:{},annotations:{},binaryAnnotations:{},imageTimings:[],isSampled:i,spans:[]},{constraint:P,disablePWTLogging:r})})(e,a.payload);if("TIMING"!==e.status)return k(`ignoring action due to invalid state ${e.status}`,a),e;switch(a.type){case"ABORT":F();let t={type:"ABORT",reason:a.reason};return{...e,status:"DONE",result:t};case"ANNOTATE":let{name:n}=a.payload;if(!_.Z)return e;let i=_.Z.now();return k(`adding annotation {${n}: ${i}}`),{...e,annotations:{...e.annotations,...{[n]:i}}};case"BINARY_ANNOTATE":let{name:r,value:s,annotationType:d}=a.payload;return k(`adding binary annotation {${r}: ${s}}`),{...e,binaryAnnotations:{...e.binaryAnnotations,...{[r]:{value:s,type:d}}}};case"MARK_CONSTRAINT_COMPLETE":return I(e,a.payload);case"REMOVE_CONSTRAINT":return((e,a)=>{if(!_.Z){let a=(0,l.KJ)(e.metricConfig.metricId);(0,o.H)("missing_window_performance",{action:a})}k(`removing constraint "${a}"`);let t=e.metricConfig.constraints.filter(e=>e!==a),{[a]:n,...i}=e.constraintMap;return T({...e,constraintMap:i,metricConfig:{...e.metricConfig,constraints:t}})})(e,a.payload);case"SET_SEGMENT":var u=a.payload;if(!_.Z){let a=(0,l.KJ)(e.metricConfig.metricId);(0,o.H)("missing_window_performance",{action:a})}k(`updating pwt segment to "${u}"`);let c={...e.metricConfig.metricId,segment:u};return{...e,metricConfig:{...e.metricConfig,metricId:c}};case"SET_VISUALLY_COMPLETE_RESULT":{let{payload:{imageTimings:t}}=a;if(0===t.length)return F(),{...e,status:"DONE",result:{type:"ABORT",reason:"visuallyComplete_noImages"}};let n=Math.max(...t.map(e=>e.responseEnd||0));return I({...e,imageTimings:t},{constraint:C,time:n})}case"ADD_SUBSPAN":let{startTime:g}=e,{payload:{name:h,startTime:y,endTime:x,annotations:v,binaryAnnotations:w,parentId:b}}=a;return{...e,spans:[...e.spans,{name:h,id:(0,f.Z)(),startTime:y||g,endTime:x,annotationMap:{...v},binaryAnnotationMap:{...w},parentId:b}]};case"START_SUBSPAN":return{...e,spans:[...e.spans,{name:a.payload.name,id:(0,f.Z)(),startTime:_.Z?_.Z.now():0,endTime:1/0,annotationMap:{...a.payload.annotations},binaryAnnotationMap:{...a.payload.binaryAnnotations},parentId:a.payload.parentId}]};case"STOP_SUBSPAN":let R=e.spans.findIndex(e=>e.name===a.payload.name);return R>-1?(e.spans[R].endTime=_.Z?_.Z.now():0,a.payload.annotations&&(e.spans[R].annotationMap={...e.spans[R].annotationMap,...a.payload.annotations}),a.payload.binaryAnnotations&&(e.spans[R].binaryAnnotationMap={...e.spans[R].binaryAnnotationMap,...a.payload.binaryAnnotations})):(0,o.H)("invalid_subspan_stop_name",{name:a.payload.name}),e;default:let j=(0,l.KJ)(e.metricConfig.metricId);return(0,o.H)("invalid_pwt_surface_action",{action:j}),e}},j=new Set;function E({children:e,...a}){(0,n.Z)("PwtSurface","/app/packages/pwt-logger/PwtSurface.tsx");let t=(0,g.Z)(),s=(e=>{if(!e)return"initial_app_load";switch(e.action){case"PUSH":return"client_route_push";case"REPLACE":return"client_route_replace";default:return null}})(t),d=a.measureGridVisuallyComplete?["web_masonry_v2"]:[],c=[...a.annotateExperiments??[],...d],{context:p}=(({surface:e,constraints:a,segment:t,measureGridVisuallyComplete:n,annotateExperiments:l,customEnabledNavigationTypes:s,navigationInfo:{clientNavigation:o,navigationType:d},sampleRate:u})=>{let c=(0,i.useRef)("NOT_SET"),p=(0,h.Z)(),{getState:m,dispatch:g}=((e,a)=>{let t=(0,i.useRef)(a);return{getState:()=>t.current,dispatch:a=>{t.current=e(t.current,a)}}})(R,{status:"DISABLED",metricConfig:null}),y=(0,x.B)();if(c.current!==o&&(c.current=o,p)){let{isAuthenticated:i}=p,r=e&&d&&(s||b).includes(d)?{metricId:{type:"surface",surface:e,navigationType:d,isAuthenticated:i,segment:t},annotateExperiments:l,constraints:[P,...a||[],...n?[C]:[]],pwtStaticContext:p}:null;(0,v.nP)("webapp.pwt_surface.init_route",{tags:{surface:e,navigationType:d,isAuthenticated:i}});let c=!j.has(o);g({type:"INIT_ROUTE",payload:{metricConfig:r,startTime:o?o.time:0,isSampled:!u||Math.random()<u,disablePWTLogging:!c}}),c&&j.add(o)}let f=m();if((0,i.useEffect)(()=>()=>{j.delete(o)},[o]),(0,i.useEffect)(()=>{let e=e=>{g({type:"ABORT",reason:e})};r.Z.onSessionPause(e);let a=window.innerHeight,t=window.innerWidth,n=()=>{let e=Math.abs(window.innerHeight-a),i=Math.abs(window.innerWidth-t),r=window.innerHeight!==a,l=window.innerWidth!==t,s={handler:(0,S.H)(),deviceType:p?.deviceType??"unknown",isAuthenticated:p?.isAuthenticated??"unknown",platform:y.userAgent.platform??"unknown"};if((0,v.nP)("webapp.PwtLogger.handleResize",{sampleRate:1,tags:{...s,heightChanged:r,widthChanged:l}}),r&&(0,v.S0)("webapp.PwtLogger.resizeHeightDelta",e,{sampleRate:1,tags:s}),l&&(0,v.S0)("webapp.PwtLogger.resizeWidthDelta",i,{sampleRate:1,tags:s}),window.removeEventListener("resize",n),p?.deviceType==="phone"&&(!l&&r&&e<=150||!r&&!l)||p?.deviceType==="desktop"&&!r&&!l)return void(0,v.nP)("webapp.PwtLogger.skipResizeAbort",{sampleRate:1,tags:{...s,heightChanged:r,widthChanged:l}});g({type:"ABORT",reason:"windowResized"})};return window.addEventListener("resize",n),()=>{let a=m();k("handling unmount",a),"TIMING"===a.status&&F(),r.Z.removePauseListener(e),window.removeEventListener("resize",n)}},[]),"TIMING"!==f.status||!f.constraintMap[P])return{state:f,context:null};let{startTime:w,metricConfig:T}=f;return{state:f,context:{abort:e=>g({type:"ABORT",reason:e}),addAnnotation:e=>g({type:"ANNOTATE",payload:{name:e}}),addBinaryAnnotation:(e,a,t)=>g({type:"BINARY_ANNOTATE",payload:{name:e,value:a,annotationType:t}}),addSubspan:(e,a,t,n={},i={},r=null)=>g({type:"ADD_SUBSPAN",payload:{name:e,startTime:a,endTime:t,annotations:n,binaryAnnotations:i,parentId:r}}),getId:()=>w,getMetricId:()=>T.metricId,markConstraintComplete:e=>g({type:"MARK_CONSTRAINT_COMPLETE",payload:{constraint:e,time:_.Z?_.Z.now():0}}),removeConstraint:e=>g({type:"REMOVE_CONSTRAINT",payload:e}),setSegment:e=>g({type:"SET_SEGMENT",payload:e}),setVisuallyCompleteResult:T.constraints.includes(C)?e=>g({type:"SET_VISUALLY_COMPLETE_RESULT",payload:e}):null,startSubspan:(e,a={},t={},n=null)=>g({type:"START_SUBSPAN",payload:{name:e,annotations:a,binaryAnnotations:t,parentId:n}}),stopSubspan:(e,a={},t={},n=null)=>g({type:"STOP_SUBSPAN",payload:{name:e,annotations:a,binaryAnnotations:t,parentId:n}})}}})({...a,annotateExperiments:c,navigationInfo:{navigationType:s,clientNavigation:t}}),m=(0,u.A)(),y=!!m;return(0,i.useEffect)(()=>{if(y){let e=m?.getMetricId(),a=e?(0,l.KJ)(e):null;(0,o.H)("nested_pwt_surface",{action:a})}},[y]),(0,w.jsx)(u.S,{value:p,children:e})}},67831:function(e,a,t){t.d(a,{A:()=>i,S:()=>n});let{Provider:n,getMaybe:i}=(0,t(729434).Z)("pwtSurfaceContext")},891631:function(e,a,t){t.d(a,{Z:()=>r});var n=t(667294),i=t(622481);function r(){return(0,n.useContext)(i.Z)}},594885:function(e,a,t){t.d(a,{Z:()=>r});var n=t(667294),i=t(282803);function r(){return(0,n.useContext)(i.Z)}},636208:function(e,a,t){t.d(a,{Z:()=>n});function n(e,a,t,i=0){if(-1===a||-1===t||a===t)return e;let r=t+i,l=a+i;if(r<0||r>=e.length||l<0||l>=e.length)return e;let s=[...e],o=s[l],d=l<r?1:-1;for(let a=l;a!==r;a+=d)s[a]=e[a+d];return s[r]=o,s}},123998:function(e,a,t){t.d(a,{Z:()=>f}),t(281098);var n=t(667294),i=t(20256),r=t(390843),l=t(115247),s=t(15667),o=t(734215),d=t(998212),u=t(732888),c=t(738140),p=t(169053),m=t(785893);function g(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class h extends n.Component{constructor(e){super(e),g(this,"componentWillUnmount",()=>{this.unregisterComponent()}),g(this,"getContext",()=>{let{clientTrackingParams:e,component:a,element:t,objectId:n,timeSpentContext:i,view:r,viewParameter:l}=this.props;return{view:r||i?.view,viewParameter:l||i?.viewParameter,component:a||i?.component,element:t,objectId:n||i?.objectId,clientTrackingParams:e||i?.clientTrackingParams,getParentUuid:()=>this.getUuid(),getGrandparentUuid:()=>this.getParentId()}}),g(this,"getLoggerContext",()=>{let e={...this.getContext()};return delete e.getParentUuid,e}),g(this,"getParentId",()=>{let{timeSpentContext:e,shouldUseGrandparentId:a=!1}=this.props;if(a&&e&&e.getGrandparentUuid){let a=e.getGrandparentUuid();if(a)return a}return e?.getParentUuid?.()}),g(this,"getUuid",()=>this.state.timedPair?this.state.timedPair.uuid:void 0),g(this,"getTimedPair",()=>this.state.timedPair),g(this,"setTimedPair",(e,a)=>{this.setState({timedPair:e},()=>{a&&a()})}),g(this,"isRegistered",!1),g(this,"registerComponent",()=>{this.props.timeSpentManager.registerComponent(this),this.isRegistered=!0}),g(this,"unregisterComponent",()=>{this.isRegistered&&(this.props.timeSpentManager.unregisterComponent(this),this.isRegistered=!1)}),g(this,"handleVisibilityChange",e=>{let{intersectionRatio:a}=e[0],{bottom:t,left:n,right:i,top:r}=e[0].intersectionRect;a>0?this.registerComponent():0===a&&(0===t&&0===n&&0===i&&0===r?this.unregisterComponent():this.registerComponent())}),this.state={timedPair:new u.Z(this.getLoggerContext())}}componentDidUpdate(e){!this.isRegistered||e.view===this.props.view&&e.viewParameter===this.props.viewParameter&&e.component===this.props.component&&e.element===this.props.element&&e.objectId===this.props.objectId&&(0,o.Z)(e.auxData,this.props.auxData)&&(0,o.Z)(e.viewData,this.props.viewData)||(this.unregisterComponent(),setTimeout(this.registerComponent))}render(){let{children:e,intersectionObserverBoxHeight:a}=this.props;return(0,m.jsx)(c.$,{value:this.getContext(),children:(0,m.jsx)(l.Z,{onVisibilityChange:this.handleVisibilityChange,options:{threshold:0},children:t=>(0,m.jsx)(i.xu,{ref:t,height:a??"100%",children:n.Children.only(e)})})})}}function y(e){let a=(0,r.ou)(),t=(0,c.a)(),i=(0,d.Z)(),l=(0,p.EQ)(),{requestIdentifier:o=""}=(0,s.B)(),u={app_instance_id:o.slice(0,8),...e.auxData??{}};return(0,n.useEffect)(()=>{i?.setHistoryStackContext(a)},[a,i]),(0,n.useEffect)(()=>{i?.setPins(l??{})},[l,i]),i?(0,m.jsx)(h,{...e,auxData:u,timeSpentContext:t,timeSpentManager:i,children:e.children}):e.children}y.displayName="DeprecatedTimeSpent";let f=y},738140:function(e,a,t){t.d(a,{$:()=>n,a:()=>i});let{Provider:n,getMaybe:i}=(0,t(729434).Z)("timeSpentContext")},732888:function(e,a,t){t.d(a,{Z:()=>s,h:()=>l});var n=t(172045),i=t(17314);function r(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}let l="undefined"!=typeof window&&window.performance&&window.performance.now?()=>Math.floor((window.performance.timeOrigin+window.performance.now())*1e6):()=>1e6*Date.now(),s=class{constructor(e){r(this,"start",()=>(this.startTime=l(),this.startTime)),r(this,"end",()=>(this.endTime=l(),this.duration=this.startTime?this.endTime-this.startTime:null,this.duration));try{this.uuid=(0,n.Z)()}catch(e){this.uuid=(0,i.Z)()}e&&Object.assign(this,e)}}},359829:function(e,a,t){t.d(a,{Z:()=>n});function n(e,a){let t=0,n=!1,i=-1;return e.forEach((e,r)=>{let{x:l=0,y:s=0,h:o=0,w:d=0}=e,u=function(e,a){let{x:t,y:n,w:i,h:r}=e,{x:l,y:s,w:o,h:d}=a,u=Math.max(t,l),c=Math.min(t+i,l+o),p=Math.max(n,s),m=Math.min(n+r,s+d),g=u<c&&p<m?(c-u)*(m-p):0;return g/(i*r+o*d-g)}(a,{x:l,y:s,h:o,w:d});u>=.9&&u>t&&(t=u,n=!0,i=r)}),{isCropAreaOnDotArea:n,indexToHide:i}}},611304:function(e,a,t){t.d(a,{Z:()=>n});function n(e){return{h:e?.h??void 0,is_stela:e?.isStela??void 0,labelId:e?.labelId??void 0,label_x:e?.labelX??void 0,label_y:e?.labelY??void 0,label:e?.label??void 0,max_annotation_num_documents:e?.maxAnnotationNumDocuments??void 0,score:e?.score??void 0,show_on_closeup:e?.showOnCloseup??void 0,title:e?.title??void 0,w:e?.w??void 0,x:e?.x??void 0,y:e?.y??void 0}}},739067:function(e,a,t){t.d(a,{Z:()=>n});function n(e,a){let{x:t,y:n}=e,i=!1,r=0,l=a.length-1;for(;r<a.length;){let{x:e,y:s}=a[r],{x:o,y:d}=a[l];s>n!=d>n&&t<(o-e)*(n-s)/(d-s)+e&&(i=!i),l=r,r+=1}return i}},68408:function(e,a,t){t.d(a,{Z:()=>d});var n,i=t(667294);t(167912);var r=t(415546),l=t(274320),s=t(886981);let o=(void 0!==n||(n=t(160187)).hash&&"50c726067ab8af873ed4afded90b7bed"!==n.hash&&console.error("The definition of 'useSamSegmentation_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function d({boundingBox:e,pinKey:a}){let{checkExperiment:t}=(0,l.r)(),n=(0,r.Z)(o,a),d=t("dtn_exp6_uve4a").group,u=(0,i.useMemo)(()=>"enabled"===d?{detection_model:"dtn_exp6_yolov8",use_gss:!1,write_to_galaxy:!1}:"enabled_dtn_exp5_skip_gss"===d?{use_gss:!1,write_to_galaxy:!1}:{},[d]),{data:c}=(0,s.Z)(n.entityId?{name:"ApiResource",options:{url:`/v3/pins/${n.entityId}/segmentation/sam/`,data:{bounding_box:e?JSON.stringify({x:Math.min(Math.max(e.x||0,0),1),y:Math.min(Math.max(e.y||0,0),1),width:Math.min(Math.max(e.w||1,0),1),height:Math.min(Math.max(e.h||1,0),1)}):void 0,client:"visual_cutout",use_gss:!e,write_to_galaxy:!e,cleanup_masks:!0,...u}}}:null);return c}},751961:function(e,a,t){t.d(a,{Z:()=>l});var n=t(281098),i=t(366859),r=t(785893);let l=({children:e})=>((0,n.Z)("FeedItemPinRepWrapper","/app/www/FeedItemPinRepWrapper.tsx"),(0,r.jsx)(i.Z,{onTouch:e=>{if(e.target instanceof HTMLElement&&"IMG"===e.target.tagName){let a=e.target.getBoundingClientRect().top+window.scrollY-70;window.scrollTo(window.scrollX,a)}},pressState:"none",children:e}))},425140:function(e,a,t){t.d(a,{G:()=>x,Z:()=>S});var n=t(281098),i=t(667294),r=t(20256),l=t(469167),s=t(467925),o=t(93966),d=t(355363),u=t(62937),c=t(647709),p=t(341742),m=t(348268),g=t(357823),h=t(130858),y=t(79293),f=t(648200),_=t(785893);let x=25;function S({align:e,customLayoutType:a,getColumnSpanConfig:t,getResponsiveModuleConfigForSecondItem:x,emptyState:S,feedItems:v,feedKey:w,maxColumns:b,minColumns:k,pagination:{hasNext:P,isLoadingNext:C,loadNext:F,refetch:T},pullToRefresh:I,renderFeedItem:R,serverRender:j,isLoadingStateEnabled:E,isLoadingAccessibilityLabel:Z,isLoadedAccessibilityLabel:M,layout:A}){(0,n.Z)("SimpleFeed","/app/www/SimpleFeed.tsx");let D=(0,c.HG)(),{experimentalColumnWidth:L,experimentalGutter:K}=(0,s.Z)(),[$,O]=(0,i.useState)(!1),N=1===b?window.innerWidth:void 0,B="userSearch"===a?window.innerWidth-16:200,z=C&&0===v.length&&!$&&!E,U="desktopFlashlight"===a||"ideaPage"===a&&D?-2:o.qG,V=k??2;return"userSearch"===a&&(V=1),(0,p.Z)(()=>(window.addEventListener("online",F),()=>window.removeEventListener("online",F))),(0,_.jsxs)(r.xu,{"data-test-id":"MobileFeed",children:[(0,_.jsx)(g.Z,{enabled:!!I,onPull:()=>{T(),O(!0)},refreshing:$}),(0,_.jsxs)(r.xu,{"data-test-id":"grid",marginEnd:U,marginStart:U,opacity:$?.5:1,children:[(0,_.jsx)(d.Z,{isAtEndOfFeed:!P,isPlaceholderGrid:E&&C&&!v.length,itemCount:v.length,children:v.length?(0,_.jsx)(r.xu,{"data-test-id":"feed",marginTop:(0,m.kk)({isDesktop:D}),children:(0,_.jsx)(u.Z.Consumer,{children:n=>(0,_.jsx)(i.Fragment,{children:(0,_.jsx)(f.Z,{children:(0,_.jsx)(l.default,{_getResponsiveModuleConfigForSecondItem:x,align:e||("ideaPage"===a?"start":void 0),cacheKey:w,columnWidth:D?L??o.yF:N??B,getColumnSpanConfig:t,gutterWidth:D?K??4*o.jC:void 0,id:j?w:void 0,isFetching:C,isLoadedAccessibilityLabel:M??"",isLoadingAccessibilityLabel:Z??"",isLoadingStateEnabled:!!E,items:v,layout:A??void 0,loadItems:F,maxColumns:b,minCols:V,optOutFluidGridExperiment:null!=b,renderItem:({data:e,itemIdx:a})=>R(e,a),scrollContainerRef:n,serverRender:j})})})})}):C?(0,_.jsx)(h.Z,{}):S??null}),z&&(0,_.jsx)(r.xu,{column:12,paddingY:2,children:(0,_.jsx)(y.Z,{partialViewportWidth:"desktopFlashlight"===a})})]})]})}},290003:function(e,a,t){t.d(a,{Z:()=>eq});var n,i,r,l,s,o,d,u=t(281098),c=t(667294);t(167912);var p=t(616550),m=t(20256),g=t(415546),h=t(801082),y=t(525839),f=t(886981),_=t(634737),x=t(825332),S=t(241646),v=t(583270),w=t(785893);function b({isTopRow:e,image:a}){return(0,u.Z)("ShoppingUpsellStoryCardDetail","/app/common/react/components/shopping/ShoppingUpsellStoryCardDetail.tsx"),(0,w.jsxs)(m.zd,{height:e?217:168,wash:!0,width:e?236:117,children:[a.url&&(0,w.jsx)(m.Ee,{alt:a.alt||"",fit:"cover",naturalHeight:a.height??1,naturalWidth:a.width??1,src:a.url}),!!a.price&&(0,w.jsx)(m.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"18px",color:"#111",fontSize:"10px",fontWeight:"600",lineHeight:"24px",padding:"06px"}},"data-test-id":"shopping-upsell-price",height:24,left:!0,margin:1,paddingX:2,paddingY:1,position:"absolute",top:!0,children:a.price})]})}var k=t(980787),P=t(744862),C=t(351607),F=t(97484),T=t(47426),I=t(483858),R=t(865690);let j={container:{borderRadius:`${F.Oc}px ${F.Oc}px 25px 25px`,WebkitMaskImage:"-webkit-radial-gradient(white, black)"},content:{marginBottom:"2px"},visualOverlay:{backgroundColor:"rgba(0, 0, 0, .1)"}},E=({images:e,firstImageIndex:a})=>{let t=a+1,n=a+2;return(0,w.jsxs)(m.xu,{overflow:"hidden",rounding:4,children:[(0,w.jsx)(m.xu,{dangerouslySetInlineStyle:{__style:j.content},children:e.at(a)?(0,w.jsx)(b,{image:e[a],isTopRow:!0}):null}),e.length>n?(0,w.jsxs)(m.kC,{alignItems:"stretch",justifyContent:"between",children:[(0,w.jsx)(b,{image:e[t]}),(0,w.jsx)(b,{image:e[n]})]}):null]})};function Z({dangerouslySetActionUrl:e,query:a,story:t,slotIndex:n}){let i,r,l,s,o;(0,u.Z)("ShoppingUpsellStoryCard","/app/common/react/components/shopping/ShoppingUpsellStoryCard.tsx");let{logContextEvent:d}=(0,k.u)(),{action:p,id:g,objects:h,story_type:y,subtitle:f}=t,{text:_,url:x}=p||{},[S,v]=(0,c.useState)(!1),b=(0,c.useCallback)(()=>v(!0),[v]),F=(0,c.useCallback)(()=>v(!1),[v]),Z=(h||[]).reduce((e,a)=>"pin"!==a.type?e:[...e,{domain:a.domain,image:{alt:a.title||a.description,height:a.images?.["474x"]?.height,url:a.images?.["474x"]?.url,width:a.images?.["474x"]?.width,price:(a.rich_summary?.products?.[0]||{}).offer_summary?.price}}],[]),M=(Z[0]||{}).domain||void 0;["search_product_collage_story","shop_article_story"].includes(y)?(i=2,r=43,l={story_id:g,story_type:y,entered_query:a}):"shop_brand_story"===y||"shop_brand_affinity_story"===y?(i=1,r=92,M&&(l={story_type:y,commerce_data:JSON.stringify({domain:M})})):["stela_in_flashlight_card","stela_in_flashlight_onecol"].includes(y)?(i=72,r=3050):"related_domain_collage"===y?(i=72,r=3455):"related_products_collage"===y&&(i=1,r=3177);let A=()=>d({event_type:101,element:372,component:200,view_type:i,view_parameter:r,aux_data:{story_type:y}}),D=f?4:2;if(["related_domain_collage","shop_brand_story","shop_brand_affinity_story"].includes(y)&&p){let e=p.user;s=e&&(e.image_medium_url||e.image_large_url),o=e&&e.full_name}let L=e||x;if(!L)return null;let K=(0,T.Z)({url:L})?"nofollow":"none";return(0,w.jsx)(C.Fw,{componentType:200,contextLogData:l||{},impressionType:"Story",loggingId:y,slotIndex:n,viewParameter:r,viewType:i,children:({impressionTrackerRef:e})=>(0,w.jsx)(m.xu,{ref:e,children:(0,w.jsx)(m.Tg,{href:L,onTap:A,rel:K,children:(0,w.jsxs)(m.xu,{dangerouslySetInlineStyle:{__style:j.container},onMouseEnter:b,onMouseLeave:F,overflow:"hidden",position:"relative",children:[(0,w.jsx)(E,{firstImageIndex:+!!["related_domain_collage","related_products_collage"].includes(y),images:Z.map(({image:e})=>e)}),(0,w.jsx)(m.xu,{alignItems:"center",color:"secondary",display:"flex",justifyContent:"center",marginTop:2,paddingX:3,paddingY:D,rounding:"pill",children:(0,w.jsxs)(m.xu,{alignContent:"start",direction:"column",display:"flex",justifyContent:"center",margin:2,children:[f?(0,w.jsx)(m.xu,{marginBottom:1,children:(0,w.jsx)(m.xv,{align:"start",color:"subtle",children:f.format})}):null,(0,w.jsx)(m.xv,{align:"start",weight:"bold",children:_})]})}),o&&s&&(0,w.jsx)(m.xu,{margin:2,position:"absolute",right:!0,top:!0,children:(0,w.jsx)(P.qE,{name:o,outline:!0,size:"md",src:s})}),(0,w.jsx)(I.Z,{visibility:S?"visible":"none",children:(0,w.jsx)(R.Z,{additionalStyles:j.visualOverlay})})]})})})})}var M=t(19585),A=t(302148),D=t(941404);let L=(void 0!==n||(n=t(135885)).hash&&"610a35d46510240eb58e262c1909310c"!==n.hash&&console.error("The definition of 'BestPinCardAttribution_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),K=()=>{(0,D.NC)("click_best_pin_board",!0)},$=()=>{(0,D.NC)("click_best_pin_profile",!0)},O=({pin:e})=>{let{pinner:a}=e,{username:t,fullName:n}=a??{},i=a?.imageMediumUrl||a?.imageSmallUrl,r=`/${t??""}/`;return(0,w.jsx)(m.Tg,{fullWidth:!1,href:r,onTap:$,rounding:"circle",children:(0,w.jsx)(P.qE,{name:n??"",outline:!0,size:"sm",src:i??""})})},N=({pin:e})=>{let a=(0,M.Z)(),{board:t,pinner:n}=e,{name:i,privacy:r,url:l}=t??{},s=t?.entityId||"",{username:o,fullName:d}=n??{},u=`/${o??""}/`,c=(0,w.jsx)(m.xv,{inline:!0,size:"200",weight:"bold",children:(0,w.jsx)(m.rU,{display:"inlineBlock",href:u,onClick:$,underline:"hover",children:d})},d);return"protected"===r?(0,A.nk)(a._('{{ pinnerName }} saved this Pin', 'Showing who saved this pin, but not which board (private board), on closeup', 'Showing who saved this pin, but not which board (private board), on closeup'),{pinnerName:c}):(0,A.nk)(a._('{{ pinnerName }} saved to {{ boardName }}', 'Showing who saved this pin to which board on closeup', 'Showing who saved this pin to which board on closeup'),{pinnerName:c,boardName:(0,w.jsx)(m.xv,{inline:!0,size:"200",weight:"bold",children:(0,w.jsx)(m.rU,{href:l??"",onClick:K,children:i},"board")},s)})},B=({pinKey:e})=>{(0,u.Z)("BestPinCardAttribution","/app/packages/BestPinCard/BestPinCardAttribution.tsx");let a=(0,g.Z)(L,e);return(0,w.jsxs)(m.xu,{alignItems:"center","data-test-id":"pin-attribution",direction:"row",display:"flex",marginTop:3,children:[(0,w.jsx)(O,{pin:a}),(0,w.jsx)(m.xu,{marginEnd:2}),(0,w.jsx)(m.xv,{size:"200",children:(0,w.jsx)(N,{pin:a})})]})},z=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="underline")},U=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="none")};var V=t(521009);function G({pageType:e,pinCreditPrefix:a,pin:t,pinLink:n,viewParameter:i}){(0,u.Z)("BestPinCardClickthroughLink","/app/packages/BestPinCard/BestPinCardClickthroughLink.tsx");let r=(0,M.Z)(),l=(0,V.Z)();if("topic"!==e.page&&(!t.domain||"Uploaded by user"===t.domain))return null;let s="topic"!==e.page||e.isAuth?"100":"200",o="topic"===e.page&&!!t.nativeCreator,d=o?t.nativeCreator?.fullName:t.domain;return(0,w.jsx)(m.xu,{display:"flex",flex:"none",justifyContent:"start",marginBottom:2,children:(0,w.jsx)(m.rU,{display:"inlineBlock",href:o?`/${t.nativeCreator?.username||""}/`:n,onClick:()=>{"topic"===e.page?(0,D.NC)("click_topic_best_pin_link"):l({event_type:12,view_type:3,object_id_str:t.entityId,component:85,view_parameter:i})},rel:"nofollow",target:"blank",underline:"hover",children:(0,w.jsx)(m.xv,{size:s,children:(0,A.nk)(r._('{{ pinCreditPrefix }} {{ pinCredit }}', 'Tells the user where the pin is from in the form of "Saved from <website>"', 'Tells the user where the pin is from in the form of "Saved from <website>"'),{pinCreditPrefix:a,pinCredit:(0,w.jsx)(m.xv,{inline:!0,size:s,weight:"bold",children:"topic"!==e.page?(0,w.jsxs)("span",{"data-gestalt-valid-html":"Text",onBlur:U,onFocus:z,onMouseLeave:U,onMouseOver:z,children:[" ",t.domain]}):d},o?"creatorProfile":"pinLinkDomain")})})})})}var H=t(166379),W=t(110870),Y=t(267828),X=t(695263),q=t(918874),Q=t(873408),J=t(776250),ee=t(492841),ea=t(594414);let et=(void 0!==i||(i=t(815025)).hash&&"12f77507a9fdec344b44b7e659fa5ac1"!==i.hash&&console.error("The definition of 'RecipeMetadata_recipe' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function en({recipeKey:e}){(0,u.Z)("RecipeMetadata","/app/packages/recipePin/RecipeMetadata.tsx");let a=(0,g.Z)(et,e);if(a?.aggregateRating?.ratingValue&&a.aggregateRating.reviewCount){let e="number"==typeof a.cookTimes?.cook?.m&&"number"==typeof a.cookTimes.prep?.m?`${a.cookTimes.cook.m+a.cookTimes.prep.m} minutes \xb7 `:"";return(0,w.jsxs)(c.Fragment,{children:[(0,w.jsx)(ea.Z,{max_rating:a.aggregateRating.bestRating,rating:a.aggregateRating.ratingValue},a.aggregateRating.ratingValue),(0,w.jsx)(m.xv,{inline:!0,size:"200",children:` ${a.aggregateRating.reviewCount} \xb7 ${e}`})]})}return null}var ei=t(15667);let er=(void 0!==r||(r=t(5375)).hash&&"81db65fd15680cc0281b801ed4a8cb94"!==r.hash&&console.error("The definition of 'BestPinCardBody_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function el(e){(0,u.Z)("BestPinCardBody","/app/packages/BestPinCard/BestPinCardBody.tsx");let{pinKey:a,viewportSize:t,pageType:n}=e,i=(0,g.Z)(er,a),{pinCreditPrefix:r,pinLink:l}=(0,q.Z)(i),s=(0,Q.Z)(i),{description:o}=(0,X.eK)({richMetadataDescription:i.richMetadata?.description,richSummaryDisplayName:i.richSummary?.displayName,closeupUnifiedDescription:i.closeupUnifiedDescription});"videos_category"===n.page&&(o=(0,X.kt)(o,i.nativeCreator?.username||""));let d="wide"===t,c=(0,X.Ly)({pinTitle:i.title,gridTitle:i.gridTitle,richSummaryDisplayName:i.richSummary?.displayName??"",richMetadataTitle:i.richMetadata?.title??"",storyPinDataId:i.storyPinDataId,storyPinDataMetadataPinTitle:i.storyPinData?.metadata?.pinTitle,pinJoinVisualAnnotation:i.pinJoin?.visualAnnotation});(i.gridTitle||"").trim()&&c!==i.gridTitle&&(c=(0,X.EU)(i.gridTitle,200));let p=(0,Y.r)(i.richMetadata?.recipe?.name,!!i.richMetadata?.recipe?.categorizedIngredients,i.richMetadata?.recipe?.fromAggregatedData??!1)?i.richMetadata?.recipe:null,h=!!(i.richMetadata&&i.richMetadata.article&&i.richMetadata.article.datePublished)&&((e,a)=>{let t=new Date((e.richMetadata??{}).article?.datePublished??Date.now()),n=t.getTime();return new Date().getTime()-n<=63072e6?(0,w.jsx)(H.Z,{dateFormatType:H.k.LONG_MONTH_YEAR,useUTC:!1,value:t}):""})(i,0),y=(e=>{let a,t,n="";if(e.richMetadata&&e.richMetadata.article&&e.richMetadata.article.datePublished)return n;let i=(a=null,e.lastRepinDate&&(a=new Date(e.lastRepinDate)),t=null,(e.createdAt&&(t=new Date(e.createdAt)),a)?t?a>t?a:t:a:t);if(i&&i.getFullYear()===new Date().getFullYear()){let a=new Set(["film_music_books","art","home_decor","food_drink","womens_fashion","travel","weddings","hair_beauty","holidays_events","mens_fashion","products","celebrities","technology"]),{category:t}=e;a.has(t)&&(n=i?(0,w.jsx)(H.Z,{dateFormatType:H.k.LONG_MONTH_YEAR,useUTC:!1,value:i}):"")}return n})(i)||h,{isBot:f,isSocialBot:_}=(0,ei.B)();return(0,w.jsx)(m.xu,{alignContent:"between","data-test-id":"UnauthBestPinCardBodyContainer",direction:"column",display:"flex",flex:"grow",padding:8,position:"relative",width:"100%",children:(0,w.jsxs)(m.xu,{direction:"column",display:"flex",flex:"grow",position:"relative",children:[(0,w.jsx)(G,{pageType:n,pin:{entityId:i.entityId,domain:i.domain||"",nativeCreator:i.nativeCreator&&{fullName:i.nativeCreator.fullName,username:i.nativeCreator.username}},pinCreditPrefix:"topic"===n.page&&i.nativeCreator?"Created by":r,pinLink:l??"",viewParameter:(0,J.Z)({hasPin:!0,hasPinRichMetadata:!!i.richMetadata,hasPinRichMetadataProducts:!!i.richMetadata?.products,hasPinRichMetadataArticle:!!i.richMetadata?.article,hasPinRichMetadataRecipe:!!i.richMetadata?.recipe,hasPinStoryPinData:!!i.storyPinData})}),(0,w.jsx)(m.kC,{direction:"row",justifyContent:"between",children:(0,w.jsx)(m.xu,{display:"flex",marginEnd:3*!d,marginTop:3*!!d,overflow:"hidden",children:c&&(0,w.jsx)("h2",{"data-test-id":"UnauthBestPinCardTitle",style:{fontWeight:600,fontSize:"28px",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:c})})}),y?(0,w.jsx)(m.xu,{marginTop:1,children:(0,w.jsx)(m.xv,{color:"subtle",children:y})}):null,o&&(0,w.jsx)(m.xu,{display:"flex",marginTop:3,overflow:"hidden",children:(0,w.jsxs)("h3",{style:{fontWeight:"normal",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontSize:"14px"},children:[p&&(0,w.jsx)(en,{recipeKey:p}),o]})}),p&&(0,w.jsx)(ee.Z,{marginOverrides:p?{outerMarginTop:32,ingredientMarginBottom:4}:null,recipeProps:{recipe:{categorizedIngredients:p.categorizedIngredients,name:p.name,image:(0,W.Z)({imagesUrls:s,embedSrc:i.embed?.src,embedType:i.embed?.type,excludeOriginals:!f&&!_})}}}),(0,w.jsx)(m.xu,{alignItems:"center",direction:"row",display:"flex",justifyContent:"between",marginTop:2,children:(0,w.jsx)(B,{pinKey:i})})]})})}var es=t(642407),eo=t(633301);let ed={nw:0,ne:90,se:180,sw:270},eu={ne:[7,-7],se:[7,7],sw:[-7,7],nw:[-7,-7]},ec={nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};function ep({corner:e,x:a,y:t,size:n,cornerStyle:i}){return(0,u.Z)("CropperCorner","/app/packages/Cropper/CropperCorner.tsx"),(0,w.jsxs)("g",{"data-test-id":`cropper-corner-${e}`,style:{cursor:ec[e],pointerEvents:"auto"},transform:((e,a,t,n)=>{if("rounded"!==n)return`translate(${a}, ${t}), rotate(${ed[e]})`;{let[n,i]=eu[e];return`translate(${a+n}, ${t+i}), rotate(${ed[e]})`}})(e,a,t,i),children:[(0,w.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:n,stroke:"none",width:n,x:0,y:0}),"rounded"===i?(0,w.jsx)("path",{className:`cropperHandle ${e}`,d:"M16 0H24V8H16C11.5817 8 8 11.5817 8 16V24H0V16C0 7.16343 7.16345 0 16 0Z",fill:"#fff"}):(0,w.jsx)("path",{className:`cropperHandle ${e}`,d:`M ${n} 0 L 0 0 L 0 ${n}`,fill:"none",stroke:"#fff",strokeWidth:6})]})}let em={n:"ns-resize",s:"ns-resize",e:"ew-resize",w:"ew-resize"};function eg({edge:e,x:a,y:t,w:n,h:i}){return(0,u.Z)("CropperEdge","/app/packages/Cropper/CropperEdge.tsx"),(0,w.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:i,stroke:"none",style:{cursor:em[e],pointerEvents:"auto"},width:n,x:a,y:t})}function eh({x:e,y:a,w:t,h:n}){(0,u.Z)("CropperHandles","/app/packages/Cropper/CropperHandles.tsx");let i="rounded";return(0,w.jsxs)(c.Fragment,{children:[(0,w.jsx)(ep,{corner:"nw",cornerStyle:i,size:20,x:e,y:a}),(0,w.jsx)(ep,{corner:"ne",cornerStyle:i,size:20,x:e+t,y:a}),(0,w.jsx)(ep,{corner:"sw",cornerStyle:i,size:20,x:e,y:a+n}),(0,w.jsx)(ep,{corner:"se",cornerStyle:i,size:20,x:e+t,y:a+n}),(0,w.jsx)(eg,{edge:"n",h:30,w:Math.max(t-40,0),x:e+20,y:a-10}),(0,w.jsx)(eg,{edge:"e",h:Math.max(n-40,0),w:30,x:e+t-20,y:a+20}),(0,w.jsx)(eg,{edge:"s",h:30,w:Math.max(t-40,0),x:e+20,y:a+n-10}),(0,w.jsx)(eg,{edge:"w",h:Math.max(n-40,0),w:30,x:e-20,y:a+20})]})}var ey=t(598600),ef=t(187356),e_=t(369416),ex=t(341742),eS=t(378547);function ev(e){(0,u.Z)("Cropper","/app/packages/Cropper/Cropper.tsx");let{children:a,cropArea:t,imageSize:n,objectDetection:i,onChange:r,previewCropArea:l,showPreviewArea:s,viewParameter:o,viewType:d}=e,p=(0,V.Z)(),g=(0,c.useRef)(null),h=(0,c.useRef)(null),[y,f]=(0,c.useState)(0),[_,x]=(0,c.useState)(0),[S,v]=(0,c.useState)(0),[b,k]=(0,c.useState)(0),[P,C]=(0,c.useState)((0,ey.Z)({cropArea:t,imageSize:n})),[F,T]=(0,c.useState)(null),[I,R]=(0,c.useState)(null),[j,E]=(0,c.useState)(!1),[Z,M]=(0,c.useState)(!1),A=e=>{e.preventDefault(),e.stopPropagation();let{clientX:a,clientY:t}=e,n=a-y,i=t-_;M(!1),v(n),k(i);let r=e.target,l=r.classList.contains("cropperHandle"),s="shadowMask"===r.id,o="cropSection"===r.id,d=r.id===ef.P,u=r.id===eS.I;l?(T("resize"),r.classList.contains("ne")?R("ne"):r.classList.contains("nw")?R("nw"):r.classList.contains("se")?R("se"):r.classList.contains("sw")?R("sw"):r.classList.contains("n")?R("n"):r.classList.contains("s")?R("s"):r.classList.contains("e")?R("e"):r.classList.contains("w")&&R("w")):s?(T("select"),C(es.OI)):o?T("move"):(P.x<n&&n<P.x+P.w&&P.y<i&&i<P.y+P.h?T("move"):(T("select"),C(es.OI)),E(d||u))},D=e=>{if(!F)return;E(!1);let{clientX:a,clientY:t}=e,i=a-y,r=t-_;if("resize"===F){let e=Math.max(Math.min(i,(n.width??1)-es.SP),es.SP),a=Math.max(Math.min(r,(n.height??1)-es.SP),es.SP),{x:t,y:l,w:s,h:o}=P;switch(I){case"ne":e<t&&a>l+o?R("sw"):e<t?R("nw"):a>l+o&&R("se");break;case"nw":e>t+s&&a>l+o?R("se"):e>t+s?R("ne"):a>l+o&&R("sw");break;case"se":e<t&&a<l?R("nw"):e<t?R("sw"):a<l&&R("ne");break;case"sw":e>t+s&&a<l?R("ne"):e>t+s?R("se"):a<l&&R("nw");break;case"n":a>l+o&&R("s");break;case"s":a<l&&R("n");break;case"e":e<t&&R("w");break;case"w":e>t+s&&R("e")}switch(I){case"ne":C(({x:t,y:n,h:i})=>{let r=Math.max(e-t,es.xZ),l=Math.max(i+(n-a),es.xZ);return{x:t,y:l<=es.xZ?n:a,w:r,h:l}});break;case"nw":C(({x:t,y:n,w:i,h:r})=>{let l=Math.max(i+(t-e),es.xZ),s=Math.max(r+(n-a),es.xZ);return{x:l===es.xZ?t:e,y:s===es.xZ?n:a,w:l,h:s}});break;case"se":C(({x:t,y:n})=>{let i=Math.max(e-t,es.xZ),r=Math.max(a-n,es.xZ);return{x:t,y:n,w:i,h:r}});break;case"sw":C(({x:t,y:n,w:i})=>{let r=Math.max(i+(t-e),es.xZ),l=Math.max(a-n,es.xZ);return{x:r===es.xZ?t:e,y:n,w:r,h:l}});break;case"n":C(({x:e,y:t,w:n,h:i})=>{let r=Math.max(t-a+i,es.xZ);return{x:e,y:r===es.xZ?t:a,w:n,h:r}});break;case"s":C(({x:e,y:t,w:n})=>{let i=Math.max(a-t,es.xZ);return{x:e,y:t,w:n,h:i}});break;case"e":C(({x:a,y:t,h:n})=>{let i=Math.max(e-a,es.xZ);return{x:a,y:t,w:i,h:n}});break;case"w":C(({x:a,y:t,w:n,h:i})=>{let r=Math.max(n-e+a,es.xZ);return{x:r===es.xZ?a:e,y:t,w:r,h:i}})}}else if("move"===F){let e=i-S,a=r-b,t=Math.max(Math.min(P.x+e,(n.width??1)-P.w-es.SP),es.SP),l=Math.max(Math.min(P.y+a,(n.height??1)-P.h-es.SP),es.SP);v(i),k(r),C(({w:e,h:a})=>({x:t,y:l,w:e,h:a}))}else if("select"===F){let e=Math.max(Math.min(i,n.width??1),0),a=Math.max(Math.min(r,n.height??1),0);C({x:Math.min(S,e),y:Math.min(b,a),w:Math.abs(e-S),h:Math.abs(a-b)})}},L=()=>{if(T(null),R(null),E(!1),F){if(j&&"dots"===i)return void M(!0);if(0===P.w&&0===P.h)r({cropArea:{x:es.SP,y:es.SP,w:(n.width??1)-2*es.SP,h:(n.height??1)-2*es.SP},cropSource:5}),p({event_type:16586,view_type:d,view_parameter:o});else{let e,a,t=Math.max(Math.min(P.x,(n.width??1)-es.xZ-es.SP),es.SP),i=Math.max(Math.min(P.y,(n.height??1)-es.xZ-es.SP),es.SP);e=P.h<es.xZ?es.xZ:i+P.h>(n.height??1)-es.SP?(n.height??1)-i-es.SP:P.h,a=P.w<es.xZ?es.xZ:t+P.w>(n.width??1)-es.SP?(n.width??1)-t-es.SP:P.w,"move"===F?p({event_type:7603,view_type:d,view_parameter:o}):"resize"===F?p({event_type:7604,view_type:d,view_parameter:o}):"select"===F&&p({event_type:16584,view_type:d,view_parameter:o}),r({cropArea:{x:t,y:i,w:a,h:e},cropSource:6})}}};return(0,ex.Z)(()=>{if(h.current){let{x:e,y:a}=h.current.getBoundingClientRect();f(e),x(a)}}),(0,c.useEffect)(()=>{Z&&C(t??es.OI)},[t,Z]),(0,c.useEffect)(()=>{let e=h.current;return e&&(e.addEventListener("mousedown",A),window.addEventListener("mousemove",D),window.addEventListener("mouseup",L)),()=>{e&&(e.removeEventListener("mousedown",A),window.removeEventListener("mousemove",D),window.removeEventListener("mouseup",L))}}),(0,w.jsxs)(m.xu,{ref:h,dangerouslySetInlineStyle:{__style:{cursor:"crosshair"}},"data-test-id":"visual-search-cropper",height:"100%",left:!0,position:"absolute",top:!0,width:"100%",children:[(0,w.jsx)(e_.Z,{unsafeCSS:es.iC}),(0,w.jsxs)("svg",{"data-gestalt-valid-html":"Box",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:[(0,w.jsx)("defs",{children:(0,w.jsxs)("mask",{id:"Mask",children:[(0,w.jsx)("rect",{fill:"white",height:n.height??"100%",rx:"0",ry:"0",width:n.width??"100%",x:"0",y:"0"}),(0,w.jsx)("rect",{height:P.h,id:"hole",rx:0,ry:0,width:P.w,x:P.x,y:P.y},`${P.x}${P.y}`),(0,w.jsx)(eo.Z,{classNames:"preview-crop-area",in:s&&!F,mountOnEnter:!0,nodeRef:g,timeout:300,unmountOnExit:!0,children:(0,w.jsx)(m.xu,{ref:g,children:(0,w.jsx)("rect",{height:l.h,id:"preview",rx:4,ry:4,width:l.w,x:l.x,y:l.y},`${l.x}${l.y}`)})})]})}),(0,w.jsx)("rect",{fill:"rgba(0,0,0,0.5)",height:"100%",id:"shadowMask",mask:"url(#Mask)",width:"100%",x:"0",y:"0"}),(0,w.jsx)("use",{className:"v2cropSection","data-test-id":"cropper-section",fill:"rgba(0,0,0,0)",href:"#hole",id:"cropSection",stroke:"white",strokeWidth:"2",style:{cursor:"move"}})]}),a,(0,w.jsx)("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:"select"!==F&&(0,w.jsx)(eh,{h:P.h,w:P.w,x:P.x,y:P.y})})]})}var ew=t(941023),eb=t(359829),ek=t(74678),eP=t(556872),eC=t(611304);let eF=(void 0!==l||(l=t(584411)).hash&&"939d46d8644385a7918ed8179ce77a4c"!==l.hash&&console.error("The definition of 'UnauthCropperContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function eT({cropArea:e,customCropper:a,imageSignature:t,imageSize:n,pinKey:i,showAnimation:r,trafficSource:l,viewParameter:s,viewType:o}){(0,u.Z)("UnauthCropperContainer","/app/packages/Flashlight/UnauthCropperContainer.tsx");let d=(0,g.Z)(eF,i),[p,m]=(0,c.useState)("none"),[h,y]=(0,c.useState)(!1),[f,_]=(0,c.useState)({x:0,y:0,w:0,h:0}),[x,S]=(0,c.useState)({isCropAreaOnDotArea:!1,indexToHide:-1}),{indexToHide:v}=x,b=(0,c.useMemo)(()=>(d.visualObjects??[]).filter(e=>e.isStela).map(eC.Z),[d.visualObjects]);return(0,c.useEffect)(()=>{let a=b&&!!b.length,t=(0,ek.Z)({cropArea:e,scaledHeight:n.height??0,scaledWidth:n.width??0});a&&(m("dots"),S((0,eb.Z)(b,t)))},[e,n.height,n.width,b]),(0,w.jsx)(ev,{cropArea:e,imageSize:n,objectDetection:p,onChange:a,previewCropArea:f,showPreviewArea:!1,viewParameter:s,viewType:o,children:"dots"===p&&(0,w.jsx)(ew.Z,{currentSpotlightIdx:v,handleSpotlightClick:e=>{let{x:t,y:i,w:r,h:s,title:o}=b[e];a({cropArea:(0,eP.Z)({cropArea:{x:t,y:i,w:r,h:s},scaledHeight:n.height??0,scaledWidth:n.width??0}),cropSource:4,trafficSource:l,title:o||""})},handleSpotlightHover:e=>{if(e===v)return;let{x:a,y:t,w:i,h:r}=b[e];_((0,eP.Z)({cropArea:{x:a,y:t,w:i,h:r},scaledWidth:n.width??0,scaledHeight:n.height??0})),y(!0)},handleSpotlightUnhover:()=>{y(!1)},imageSignature:t,imageSize:n,pinKey:d,showAnimation:r,viewParameter:s,viewType:o})},JSON.stringify(e))}var eI=t(506662),eR=t(728994),ej=t(123998),eE=t(572227),eZ=t(351222),eM=t(378888),eA=t(870358),eD=t(85363),eL=t(845421),eK=t(588836),e$=t(425140);let eO=0,eN="",eB=(void 0!==s||(s=t(579652)).hash&&"93612431e09eadc717c32d98e8d91e06"!==s.hash&&console.error("The definition of 'UnauthDesktopFlashlightPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function ez(e){let{imageSpec_564x:a,imageSpec_orig:t,imageSignature:n}=e,i=a&&t,{url:r}=i??{},l=i?.width??1,s=i?.height??void 0;return"number"==typeof l&&"number"==typeof s&&l>564&&(s*=564/l,l=564),{width:l,height:s,url:r,imageSignature:n}}let eU=({data:e,index:a,viewParameter:t,productsURL:n})=>{switch(e.type){case"pin":return(0,w.jsx)(eL.Z,{duploQueryRef:null,pinId:e.id,slotIndex:a,viewParameter:t,viewType:72});case"story":return n&&(0,w.jsx)(Z,{dangerouslySetActionUrl:n,slotIndex:a,story:e});default:return null}},eV=({resourceOptions:e})=>{let a=(0,y.ZP)(),{data:t,isAtEnd:n,isFetching:i,fetchMore:r}=(0,f.Z)({name:"VisualLiveSearchResource",options:e}),l=(0,x.TH)(),s=`${l.pathname}products/${l.search}`;return(0,w.jsxs)(c.Fragment,{children:[t&&(0,w.jsx)(e$.Z,{customLayoutType:"desktopFlashlight",feedItems:t.results||[],feedKey:"flashlight-dweb-unauth",pagination:{loadNext:r,hasNext:n,isLoadingNext:i,refetch:()=>void 0},renderFeedItem:(e,a)=>eU({data:e,index:a,viewParameter:3050,productsURL:s})}),(0,w.jsx)(m.xH,{accessibilityLabel:a._('Loading visual search results...', 'unauthDesktopVisualSearch.flashlightFeed.loading', 'Accessibility label for loading visual search results'),show:i})]})},eG=({resourceOptions:e})=>{let a=(0,y.ZP)(),{data:t,isAtEnd:n,isFetching:i,fetchMore:r}=(0,f.Z)({name:"VisualLiveSearchProductFeedResource",options:e});return(0,w.jsxs)(c.Fragment,{children:[t&&(0,w.jsx)(e$.Z,{customLayoutType:"desktopFlashlight",feedItems:t||[],feedKey:"flashlight-products-dweb-unauth",pagination:{loadNext:r,hasNext:n,isLoadingNext:i,refetch:()=>void 0},renderFeedItem:(e,a)=>eU({data:e,index:a,viewParameter:3334})}),(0,w.jsx)(m.xH,{accessibilityLabel:a._('Loading visual search product results...', 'unauthDesktopVisualSearch.flashlightProductFeed.loading', 'Accessibility label for loading visual search product results'),show:i})]})};function eH({pinKey:e}){(0,u.Z)("UnauthDesktopFlashlightPage","/app/www/VisualSearch/UnauthDesktopFlashlightPage.tsx");let a=(0,y.ZP)(),{isRTL:t}=(0,ei.B)(),n=(0,V.Z)(),i=(0,x.s0)(),r=(0,x.TH)(),l=(0,c.useRef)(null),s=(0,p.$B)(),o=(0,eE.Z)(),{pinId:d}=(0,_.Z)(s.params.id||""),h=(0,eM.mB)(r.search),f=(0,v.Z)(r),b=function(e){let a=parseInt(e??"",10);switch(a){case 1:case 2:case 3:case 4:case 5:case 6:return a;default:return}}(h.cropSource),k=(0,eI.hd)(r),P=(0,g.Z)(eB,e),{getNormalizedPinImage:C}=(0,eR.Z)({pinKey:P});if((0,c.useEffect)(()=>{if(!f&&P){let{width:e,height:a}=C();i((0,eD.Z)({cropArea:{h:a-2*es.SP,w:e-2*es.SP,x:es.SP,y:es.SP},isProductPage:k,pinId:d,surfaceType:"flashlight"}),{replace:!0})}},[C,i,f,k,P,d]),(0,ex.Z)(()=>{n({event_type:13,view_type:72,view_parameter:3050,view_data:{pin_id:d}})}),(0,c.useEffect)(()=>{let e=l.current;return e&&eN===d&&(e.scrollTop=eO),()=>{e&&(eO=e.scrollTop,eN=d)}}),!P)return(0,w.jsx)(ej.Z,{objectId:"",view:72,children:(0,w.jsx)(m.xu,{dangerouslySetInlineStyle:{__style:{top:eZ.Pw}},position:"relative",children:(0,w.jsx)(m.xH,{accessibilityLabel:a._('Loading Pin data', 'unauthDesktopFlashlightPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0})})});let{imageSignature:F,description:T}=P,{width:I,height:R,url:j}=ez(P),E=function({initialCropArea:e,pin:a}){let t;if(e)t={...e};else{let{visualObjects:e}=a,{width:n=1,height:i=1}=ez(a);if(e&&e.length){let{x:a,y:r,w:l,h:s}=e[0];t=(0,eP.Z)({cropArea:{x:a,y:r,w:l,h:s},scaledWidth:n,scaledHeight:i})}else{let[e,a]=[n/6,i/6],[r,l]=[n-2*e,i-2*a];t={x:e,y:a,w:r,h:l}}}return{x:Math.floor(t.x??0),y:Math.floor(t.y??0),w:Math.floor(t.w??0),h:Math.floor(t.h??0)}}({initialCropArea:f,pin:P}),Z=r.state&&r.state.internalNavigation,M=I+S.n,A=(M??1)+24,D={pin_id:d,imageSignature:F,crop:(0,ek.Z)({cropArea:E,scaledWidth:I,scaledHeight:R}),crop_source:b||5},L={__style:{top:140}};return(0,w.jsx)(ej.Z,{objectId:"",view:72,children:(0,w.jsxs)(c.Fragment,{children:[(0,w.jsxs)(m.xu,{alignItems:"center",color:"default",dangerouslySetInlineStyle:{__style:{top:80}},display:"flex",height:60,position:"fixed",width:"100%",zIndex:new m.Ry(4),children:[!t&&(0,w.jsx)(m.xu,{left:!0,position:"absolute",children:(0,w.jsx)(eK.Z,{})}),(0,w.jsx)(m.xu,{flex:"grow",children:(0,w.jsx)(m.X6,{align:"center",size:"400",children:k?a._('Shop similar items', 'unauthDesktopFlashlightPage.flashlightProductsFeed.header', 'Header explaining results of flashlight products search'):a._('Visually similar results', 'unauthDesktopFlashlightPage.flashlightFeed.header', 'Header explaining results of flashlight search')})}),t&&(0,w.jsx)(m.xu,{position:"absolute",right:!0,children:(0,w.jsx)(eK.Z,{icon:"directional-arrow-left"})})]}),k?(0,w.jsx)(m.xu,{dangerouslySetInlineStyle:L,position:"relative",children:(0,w.jsx)(eG,{resourceOptions:D})}):(0,w.jsxs)(m.xu,{display:"flex",paddingX:12,children:[(0,w.jsxs)(m.xu,{ref:l,dangerouslySetInlineStyle:L,height:"calc(100% - 140px)",marginEnd:3,marginStart:3,overflow:"auto",position:"fixed",width:M,zIndex:new m.Ry(4),children:[(0,w.jsx)(m.xu,{dangerouslySetInlineStyle:{__style:{width:I,height:R}},"data-test-id":"flashlight-enabled-image",children:(0,w.jsxs)(m.zd,{height:R,rounding:2,width:I,children:[j&&(0,w.jsx)(m.Ee,{alt:T??"",naturalHeight:R??1,naturalWidth:I??1,src:j}),(0,w.jsx)(eT,{cropArea:E,customCropper:function({cropArea:e,cropSource:a}){let t=window.location.pathname+window.location.search,n=(0,eD.Z)({cropArea:e,cropSource:a??6,isProductPage:k,pinId:d,surfaceType:"flashlight"});o({action:"trigger",item:"cropper-changed",within:"flashlight-page"}),n!==t&&d&&i({pathname:`/pin/${d}/visual-search/`,search:(0,eA.Z)({cropArea:e,cropSource:a??6,surfaceType:"flashlight"})},{state:{internalNavigation:!0}})},imageSignature:F??void 0,imageSize:{height:R,width:I},pinKey:P,showAnimation:!Z,surfaceType:"flashlight",viewParameter:3050,viewType:72})]})}),(0,w.jsx)(m.xu,{"data-test-id":"closeupDescription",direction:"column",display:"flex",margin:5,maxWidth:I??1,position:"relative",children:(0,w.jsx)(el,{pageType:{isAuth:!1,page:"flashlight"},pinKey:P,viewportSize:"narrow"})})]}),(0,w.jsx)(m.xu,{dangerouslySetInlineStyle:{__style:{...L.__style,...t?{marginRight:`${A}px`}:{marginLeft:`${A}px`}}},position:"relative",width:"100%",children:(0,w.jsx)(eV,{resourceOptions:D})})]})]})})}let eW=(void 0!==o||(o=t(514336)).hash&&"01839fc3bcd9cdaf206873364167d157"!==o.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o),eY=(void 0!==d||(d=t(165135)).hash&&"c1c702b23a1454b46f8e2fa9d8036257"!==d.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchDataPinQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d);function eX(){let e=(0,p.$B)(),{pinId:a}=(0,_.Z)(e.params.id||""),t=(0,h.Z)({strategy:"LEGACY",query:eY,variables:{pinId:a},useGetLegacyData:({pinId:e})=>(0,f.Z)({name:"PinResource",options:{id:e,field_set_key:"detailed",fetch_visual_search_objects:!0}}).data}),n=t?.v3GetPinQuery?.__typename==="V3GetPin"?t.v3GetPinQuery.data:null,i=(0,g.Z)(eW,n);return(0,w.jsx)(eH,{pinKey:i})}function eq(){(0,u.Z)("UnauthDesktopFlashlightPageFetchData","/app/www/VisualSearch/UnauthDesktopFlashlightPageFetchData.tsx");let e=(0,y.ZP)();return(0,w.jsx)(c.Suspense,{fallback:(0,w.jsx)(m.xH,{accessibilityLabel:e._('Loading Pin data', 'unauthDesktopFlashlightPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0}),children:(0,w.jsx)(eX,{})})}},551651:function(e,a,t){t.d(a,{Z:()=>u});var n=t(281098),i=t(667294),r=t(346955),l=t(503246),s=t(706753),o=t(785893);class d extends i.Component{componentDidMount(){let{setCurrentPageData:e,viewData:a,viewParameter:t,viewType:n}=this.props;e({viewData:a,viewParameter:t,viewType:n})}componentDidUpdate(e){let{setCurrentPageData:a,viewData:t,viewParameter:n,viewType:i}=this.props;n===e.viewParameter&&i===e.viewType&&(0,l.ZP)(t,e.viewData)||a({viewData:t,viewParameter:n,viewType:i})}componentWillUnmount(){this.props.clearCurrentPageData()}render(){let{auxData:e,children:a,component:t,objectIdStr:n,viewData:i,viewParameter:r,viewType:l,clientTrackingParams:d}=this.props;return(0,o.jsx)(s.Z,{auxData:e,clientTrackingParams:d,component:t,objectIdStr:n,viewData:i,viewParameter:r,viewType:l,children:a})}}function u(e){(0,n.Z)("PageView","/app/www/analytics/PageView.tsx");let{setViewContextData:a,clearViewContextData:t}=(0,r.A$)();return(0,o.jsx)(d,{...e,clearCurrentPageData:t,setCurrentPageData:a})}},706753:function(e,a,t){t.d(a,{Z:()=>l});var n=t(667294),i=t(521009),r=t(941404);function l(e){let{auxData:a,clientTrackingParams:t,children:l,component:s,element:o,objectIdStr:d,viewData:u,viewParameter:c,viewType:p}=e,m=(0,i.Z)(),g=JSON.stringify(a),h=JSON.stringify(u);return(0,n.useEffect)(()=>{(({viewType:e,viewParameter:a,viewData:t,auxData:n,objectIdStr:i,component:l,clientTrackingParams:s,element:o},d)=>{let u,c=Object.keys(u={event_type:13,view_type:e,view_parameter:a,view_data:t,aux_data:n,object_id_str:i,component:l,clientTrackingParams:s,element:o}).reduce((e,a)=>(void 0===u[a]&&delete e[a],e),{...u});-1===Object.keys(c).indexOf("view_type")&&(0,r.My)("mweb.logging.null_view_type"),d(c)})(e,m)},[m,g,t,s,o,d,h,c,p]),n.Children.only(l)}},630894:function(e,a,t){t.d(a,{Z:()=>am});var n,i,r,l,s,o,d,u,c,p,m,g,h,y,f,_=t(281098),x=t(667294);t(167912);var S=t(616550),v=t(20256),w=t(355940),b=t(415546),k=t(801082),P=t(525839),C=t(900675),F=t(444185),T=t(634737),I=t(984126),R=t(825332),j=t(583270),E=t(258193),Z=t(642407),M=t(728994),A=t(378888),D=t(144633),L=t(74678),K=t(814685),$=t(330510),O=t(241646),N=t(980787),B=t(390843),z=t(163404),U=t(785893);function V({arrowType:e,viewParameter:a,viewType:t}){(0,_.Z)("FlashlightBackButton","/app/common/react/components/discover/Flashlight/FlashlightBackButton.tsx");let n=(0,P.ZP)(),i=(0,S.k6)(),r=(0,R.TH)(),{previous:l}=(0,B.ou)(),{logContextEvent:s}=(0,N.u)(),o=(0,z.Z)(r.pathname);return(0,U.jsx)(v.xu,{"data-test-id":"go-back-button",children:(0,U.jsx)(v.hU,{accessibilityLabel:n._('Go back', 'Accessible icon for close button', 'Accessible icon for close button'),icon:e??"directional-arrow-left",iconColor:"darkGray",onClick:()=>{if(s({event_type:101,view_type:t,element:34,view_parameter:a}),0===l.length)return void i.replace(`/pin/${o}/`);i.goBack()}})})}var G=t(37326),H=t(816358),W=t(645435);function Y({isProductPage:e,title:a,viewParameter:t,viewType:n}){(0,_.Z)("RelatedProductsHeader","/app/common/react/components/shopping/RelatedProducts/RelatedProductsHeader.tsx");let i=(0,x.useRef)(null);return(0,x.useEffect)(()=>(i.current&&H.Z.addObstruction("top",i.current),()=>{i.current&&H.Z.removeObstruction("top",i.current)})),(0,U.jsx)(W.Z,{position:e?"sticky":"fixed",shouldShowShadow:!0,children:(0,U.jsxs)(v.xu,{color:"default",dangerouslySetInlineStyle:{__style:{paddingBottom:"12px"}},display:"flex",justifyContent:"center",children:[(0,U.jsx)(v.xu,{alignItems:"center",display:"flex",height:48,left:!0,marginStart:5,position:"absolute",right:!0,width:48,children:(0,U.jsx)(V,{arrowType:a?"directional-arrow-left":"cancel",viewParameter:t,viewType:n})}),(0,U.jsx)(v.xu,{ref:i,alignItems:"center",color:"default","data-test-id":"related-products-header",display:"flex",height:48,children:(0,U.jsx)(G.Z,{title:a})})]})})}var X=t(527895),q=t(67831),Q=t(956077),J=t(271910);function ee({defaultPillColor:e,hoveredPillColor:a,pressedPillColor:t,isSelected:n,label:i,onTap:r,ref:l,selectedPillColor:s}){(0,_.Z)("DescriptorPill","/app/www/Descriptors/DescriptorPill.tsx");let[o,d]=(0,x.useState)(e);return(0,x.useEffect)(()=>{d(n?s:e)},[n,s,e]),(0,U.jsx)(v.iP,{onMouseDown:()=>d(t),onMouseEnter:()=>{n||d(a)},onMouseLeave:()=>{n||d(e)},onTap:r,rounding:4,tapStyle:"compress",children:(0,U.jsx)(v.xu,{ref:l,dangerouslySetInlineStyle:{__style:{background:o,backdropFilter:"blur(80px)"}},"data-test-id":`descriptor-pill-${i}`,paddingX:4,paddingY:2,rounding:4,children:(0,U.jsx)(v.kC,{alignItems:"center",minHeight:32,children:(0,U.jsx)(v.mg,{color:n?"light":"dark",overflow:"noWrap",children:i})})})})}var ea=t(19585);let et=({showBackArrow:e,showFwdArrow:a,handleClickBack:t,handleClickForward:n})=>{(0,_.Z)("DescriptorsNavigation","/app/www/Descriptors/DescriptorsNavigation.tsx");let i=(0,ea.Z)();return(0,U.jsxs)(v.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"descriptors-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginStart:2,children:e&&(0,U.jsx)(v.hU,{accessibilityLabel:i._('Back', 'descriptor.navArrow.back', 'Accessibility label for a button that navigates back to previous search guides'),bgColor:"washLight",dataTestId:"descriptor-bar-back-button",icon:"arrow-back",onClick:t,size:"md"})}),(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginEnd:2,children:a&&(0,U.jsx)(v.hU,{accessibilityLabel:i._('Forward', 'descriptor.navArrow.forward', 'Accessibility label for a button that navigates forward to see more search guides'),bgColor:"washLight",dataTestId:"descriptor-bar-forward-button",icon:"arrow-forward",onClick:n,size:"md"})})]})};var en=t(15667);let ei=(void 0!==n||(n=t(500698)).hash&&"9d15639e8d9dd61426917dc218fbb3a6"!==n.hash&&console.error("The definition of 'Descriptors_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function er({pressedPillColor:e,defaultPillColor:a,descriptorModules:t,hoveredPillColor:n,pinKey:i,selectedPillColor:r}){(0,_.Z)("Descriptors","/app/www/Descriptors/Descriptors.tsx");let[l,s]=(0,x.useState)(),[o,d]=(0,x.useState)(0),u=(0,R.s0)(),{search:c}=(0,R.TH)(),{barContainer:p,clientWidth:m,centerModules:g,offset:h,showBackArrow:y,showFwdArrow:f,handleClickForward:S,handleClickBack:w,onFocus:k,onMouseDown:P,setIndex:C}=(e=>{let a=(0,x.useRef)(null),{isRTL:t}=(0,en.B)(),n=(0,x.useRef)(!1),[i,r]=(0,x.useState)(0),[l,s]=(0,x.useState)(0),[o,d]=(0,x.useState)(!1),[u,c]=(0,x.useState)(!1),{current:p}=a,{clientWidth:m=0,scrollWidth:g=0}=p??{},h=m||0,y=!!p&&h>=(g||0),f=e.length;(0,x.useEffect)(()=>{let e=p?.scrollWidth||0,a=0;Array.from(p?.children||[]).slice(0,i).forEach(e=>{a+=e.offsetWidth||0}),s(a=Math.min(a,e-m+8));let t=e-a,n=h>=e;n&&0!==i&&r(0),d(i>0&&!n),c(t>h&&i<f&&!n)},[p,i,f,h,t,m]);let _=(0,x.useCallback)(e=>{if(!p)return;let a=Array.from(p.children);if(e<0||e>=a.length)return;let t=0;a.slice(0,e).forEach(e=>{t+=e?.offsetWidth??0});let n=a[e]?.offsetWidth??0;if(t<l){s(t),r(e);return}if(t+n>l+m){s(t+n-m),r(e);return}r(e)},[p,l,m]),S=(0,x.useCallback)(e=>{if("Tab"!==e.key)return;let a=Array.from(p?.children||[]),t=document.activeElement,n=a.findIndex(e=>e.contains(t));-1!==n&&(!e.shiftKey&&n<a.length-1?_(n+1):e.shiftKey&&n>0&&_(n-1))},[p,_]);return(0,x.useEffect)(()=>{if(p)return p.addEventListener("keydown",S,!0),()=>{p.removeEventListener("keydown",S,!0)}},[p,S]),{barContainer:a,centerModules:y,clientWidth:m,offset:l,showBackArrow:o,showFwdArrow:u,onFocus:()=>{n.current||r(i)},index:i,setIndex:r,handleClickForward:()=>{i+2<f?r(i+2):r(f-2)},handleClickBack:()=>{i-2>=0?r(i-2):r(0)},onMouseDown:()=>{n.current=!0}}})(t),F=(0,b.Z)(ei,i),{logContextEvent:T}=(0,N.u)(),{descriptorsRefs:I}=((e,a,t,n,i)=>{let{logContextEvent:r}=(0,N.u)(),l=(0,x.useRef)([]),s=(0,x.useRef)([]);return(0,x.useEffect)(()=>{let o=0,d=l.current.map((n,i)=>{let r=n?.offsetWidth||0,l=o,s=o+r;o+=r+4;let{auxData:d}=t[i]||{auxData:{}},u=e+a,c=l+16>e&&l<u,p=s>e&&s-16<u;return{moduleId:d?.moduleId||"",isVisible:c||p}});d.forEach((e,a)=>{let t=s.current[a];if((!t||!1===t.isVisible)&&e.isVisible){let{auxData:e}=i||{};r({event_type:9993,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:n||"",descriptor:e?.query}})}}),s.current=d},[l,e,a,t,r,n,i,s]),{descriptorsRefs:l}})(h,m,t,F.imageSignature||"",l);(0,x.useEffect)(()=>{if(void 0===l){let e=t.findIndex(e=>{let{display:a}=e,{isSelected:t}=a||{isSelected:!1};return t});-1!==e&&(s(t[e]),C(Math.max(0,e-1)))}},[t,l,C]),(0,x.useEffect)(()=>{d((e=>{if(!e)return 0;let a=e.getBoundingClientRect(),t=window.innerHeight;return a.bottom>t?a.bottom-t:0})(p.current))},[p]);let{cropSource:j}=(0,A.mB)(c);if(!Number.isNaN(j)&&5!==Number(j))return null;let E=e=>{let{id:a}=e,{id:t}=l||{};return null!=a&&t===a};return(0,U.jsx)(J.q,{children:({hovered:i,onMouseEnter:d,onMouseLeave:m})=>(0,U.jsxs)(v.xu,{dangerouslySetInlineStyle:{__style:{bottom:o}},"data-test-id":"scrollable-descriptor-bar-root",left:!0,onMouseEnter:d,onMouseLeave:m,overflow:"hidden",position:"absolute",right:!0,children:[(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{left:`-${h}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,U.jsx)(v.xu,{ref:p,display:"flex",justifyContent:g?"center":void 0,marginStart:2,paddingY:2,children:t.map((t,i)=>{let{action:l,display:o}=t,{feedUrl:d}=l||{};if(null==d)return null;let{displayText:p}=o||{};return(0,U.jsx)(v.xu,{marginEnd:1,onFocus:k,onMouseDown:P,children:(0,U.jsx)(ee,{ref:e=>{I.current[i]=e},defaultPillColor:a,hoveredPillColor:n,isSelected:E(t),label:p||"",onTap:()=>((e,a)=>{let t=E(e),{action:n}=e,{feedUrl:i}=n||{};if(i)if(t){let e=i,{surfaceType:a}=(0,A.mB)(c);a&&(e=i.replace(RegExp(`^(.*surfaceType=${a}).*$`),"$1")),u(e??"",{replace:!0}),s(void 0)}else{let{surfaceType:t}=(0,A.mB)(c),n=i;t&&(n=i.replace(/(surfaceType=)[^&]*/,`$1${t}`)),u(n??"",{replace:!0}),C(Math.max(0,a-1)),s(e)}let{auxData:r}=e;T({event_type:102,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:F.imageSignature||"",descriptor:r?.query}})})(t,i),pressedPillColor:e,selectedPillColor:r})},`descriptors-module-${t.id||i}`)})})}),i&&(0,U.jsx)(et,{handleClickBack:()=>{w();let{auxData:e}=l||{};T({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:F.imageSignature||"",descriptor:e?.query}})},handleClickForward:()=>{S();let{auxData:e}=l||{};T({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:F.imageSignature||"",descriptor:e?.query}})},showBackArrow:y,showFwdArrow:f})]})})}var el=t(790314);function es(e){return(0,x.useMemo)(()=>{let[a,t]=(0,el.Rn)({hexColor:e||"#FFFFFF",saturationMultiplier:3,brightnessMultiplier:1.6,minSaturationClamp:.15,mixVal:.3,minBrightnessClamp:0}),n=`rgba(${t[0]}, ${t[1]}, ${t[2]}, 0.8)`,i=`rgba(${a[0]}, ${a[1]}, ${a[2]}, 0.8)`,r=(0,el.e3)((0,el.rk)((0,el.t7)("rgba(117, 117, 112, 0.2)"),(0,el.t7)(n))),l=(0,el.e3)((0,el.rk)((0,el.t7)("rgba(117, 117, 112, 0.4)"),(0,el.t7)(n)));return{defaultColor:n,selectedColor:i,hoveredColor:r,pressedColor:l}},[e])}function eo({defaultPillColor:e,hoveredPillColor:a,pressedPillColor:t,viewParameter:n,viewType:i}){(0,_.Z)("VisualSearchCancelButton","/app/www/VisualSearch/VisualSearchCancelButton.tsx");let r=(0,P.ZP)(),l=(0,R.s0)(),s=(0,S.$B)(),{active:o,focused:d,hovered:u,onBlur:c,onFocus:p,onMouseDown:m,onMouseEnter:g,onMouseLeave:h,onMouseUp:y}=(0,J.Z)(),{pinId:f}=(0,T.Z)(s.params.id||""),{previous:x}=(0,B.ou)(),{logContextEvent:w}=(0,N.u)();return(0,U.jsx)(v.xu,{"data-test-id":"go-back-button",children:(0,U.jsx)(v.iP,{onBlur:c,onFocus:p,onMouseDown:m,onMouseEnter:g,onMouseLeave:h,onMouseUp:y,onTap:()=>{if(w({event_type:101,view_type:i,element:34,view_parameter:n}),0===x.length)return void l(`/pin/${f}/`,{replace:!0});l(-1)},tapStyle:"compress",children:(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{background:o?t:d||u?a:e,backdropFilter:"blur(80px)"}},padding:3,rounding:4,children:(0,U.jsx)(v.JO,{accessibilityLabel:r._('Go back', 'imageSearch.cancelButton', 'Cancel button for going back to the Pin page'),color:"default",icon:"cancel",size:24})})})})}var ed=t(442212),eu=t(274320),ec=t(359829),ep=t(870358),em=t(369416),eg=t(556872),eh=t(665290),ey=t(341742),ef=t(281503);let e_=Math.ceil(40),ex=e_+1;function eS({isHidden:e,isObjectLevelCrop:a,isSelected:t,maskHeight:n,maskId:i,maskUrl:r,maskWidth:l,maskX:s,maskY:o}){(0,_.Z)("CutoutGlow","/app/www/Cutouts/CutoutGlow.tsx");let{checkExperiment:d}=(0,eu.r)(),u="enabled_once"===d("web_cutout_glow").group,{insetIntensity:c,debugMode:p,showHiddenCutoutsinDebug:m}=function(e){let a=e.split("_");return{insetIntensity:""===a[0]||Number.isNaN(Number(a[0]))?void 0:Number(a[0]),debugMode:a.includes("debug"),showHiddenCutoutsinDebug:a.includes("all")}}(d("web_cutout_glow_inset").group),g=`glow-sweep-${i}`,h=Math.round(.35*n),y=n/2+h/2,f=a?.25:.5,{svgElement:S,maskStyle:w}=(0,ef.Z)({debugMode:p,insetIntensity:c,kind:"glow",maskHeight:n,maskId:i,maskUrl:r,maskWidth:l});return(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{left:s,top:o,...w,visibility:t?"hidden":"visible"}},"data-test-id":"cutout-item",height:n,id:eh.Ii,position:"absolute",width:l,children:(!e||m)&&(0,U.jsxs)(x.Fragment,{children:[S,(0,U.jsx)(em.Z,{unsafeCSS:`
          @keyframes ${g} {
            0%                    { mask-position: 0 -${y}px; opacity: ${f}; }
            ${e_}% { mask-position: 0  ${y}px; opacity: ${f}; }
            ${ex}%      { mask-position: 0  ${y}px; opacity: 0; }
            100%                  { mask-position: 0 -${y}px; opacity: 0; }
          }`}),(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"none",animation:u?`${g} 5s linear forwards`:`${g} 5s linear infinite`,animationDelay:"1s",maskImage:`
              radial-gradient(
                ellipse ${4*h}px ${h}px at center,
                white 0%,
                white 15%,
                rgba(255, 255, 255, 0.9) 30%,
                rgba(255, 255, 255, 0.7) 45%,
                rgba(255, 255, 255, 0.5) 55%,
                rgba(255, 255, 255, 0.3) 65%,
                rgba(255, 255, 255, 0.15) 72%,
                rgba(255, 255, 255, 0.06) 80%,
                rgba(255, 255, 255, 0.01) 90%,
                transparent 100%
              )`,maskPosition:`0 -${y}px`,maskSize:"100% 100%",maskRepeat:"no-repeat"}},"data-test-id":"cutout-glow-oval",height:"100%",opacity:0,width:"100%",children:(0,U.jsx)(v.Ee,{alt:"cutout-glow-background-image",color:"white",fetchPriority:"high",fit:"cover",loading:"eager",naturalHeight:n,naturalWidth:l,role:"presentation",src:a?void 0:"https://s.pinimg.com/webapp/cutout-glow-background-c870a580.jpg"})})]})})}var ev=t(854146);let ew=(void 0!==i||(i=t(716125)).hash&&"f1b62436c05814e4188c8863a11dce6b"!==i.hash&&console.error("The definition of 'CutoutObject_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function eb({isHovered:e,isObjectLevelCrop:a,isPinLevelCrop:t,isSelected:n,mask:i,pinKey:r,viewParameter:l,viewType:s}){(0,_.Z)("CutoutObject","/app/www/Cutouts/CutoutObject.tsx");let o=(0,$.D)(),{logContextEvent:d}=(0,N.u)(),u=(0,b.Z)(ew,r),{getNormalizedPinImage:c}=(0,M.Z)({pinKey:u,maxWidth:o?K.M:Z.Wm}),{height:p,width:m,url:g}=c(),{id:h,isHidden:y,maskHeight:f,maskUrl:S,maskWidth:v,maskX:w,maskY:k}=i;return(0,ey.Z)(()=>{y||d({event_type:120,element:14154,view_parameter:l,view_type:s,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}})}),(0,U.jsxs)(x.Fragment,{children:[(0,U.jsx)(ev.Z,{imageHeight:p,imageUrl:g,imageWidth:m,isHovered:e,isPinLevelCrop:t,isSelected:n,maskHeight:f,maskId:h,maskUrl:S,maskWidth:v,maskX:w,maskY:k}),(0,U.jsx)(eS,{isHidden:y,isObjectLevelCrop:a,isSelected:n,maskHeight:f,maskId:h,maskUrl:S,maskWidth:v,maskX:w,maskY:k})]})}let ek=(e,a,t)=>{let{maskX:n,maskY:i,maskWidth:r,maskHeight:l}=t;return e>=n&&e<=n+r&&a>=i&&a<=i+l},eP=(e,a,t)=>{if(a<0||t<0||a>=e.canvas.width||t>=e.canvas.height)return!1;try{let n=e.getImageData(a,t,1,1).data[0];return void 0!==n&&n>0}catch{return!1}},eC=e=>{let{id:a,mask_image:t,mask_bounds:n}=e;if(!a||!t||!n||2!==n.length)return!1;let[i,r]=n;if(!i||!r||2!==i.length||2!==r.length)return!1;let[l,s]=i,[o,d]=r;return[l,s,o,d].every(e=>"number"==typeof e&&!Number.isNaN(e))},eF=(void 0!==r||(r=t(431225)).hash&&"d2b8de09e9a0bd76025dff9de4c764e8"!==r.hash&&console.error("The definition of 'CutoutObjects_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function eT({bitmapMasks:e,hoveredCutoutIndex:a,imageContainerX:t,imageContainerY:n,pinKey:i,selectedCutoutIndex:r,setHoveredCutoutIndex:l,setSelectedCutoutIndex:s,trafficSource:o,viewParameter:d,viewType:u}){(0,_.Z)("CutoutObjects","/app/www/Cutouts/CutoutObjects.tsx");let c=(0,$.D)(),{logContextEvent:p}=(0,N.u)(),m=(0,R.TH)(),g=(0,R.s0)(),h=(0,b.Z)(eF,i),{getNormalizedPinImage:y}=(0,M.Z)({pinKey:h,maxWidth:c?K.M:Z.Wm}),f=(0,x.useRef)(null),[S,w]=(0,x.useState)(!1),{w:k,h:P,cropSource:C}=(0,A.mB)(m.search),{height:F,width:T}=y(),I=(0,x.useMemo)(()=>Number(k)===T&&Number(P)===F||void 0===k&&void 0===P,[P,F,T,k]),j=(0,x.useMemo)(()=>9===Number(C),[C]),{cutoutContexts:E,maskData:D}=function(e,a,t){let[n,i]=(0,x.useState)([]),[r,l]=(0,x.useState)([]),[s,o]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{let{maskData:n,urls:r}=e.reduce((e,n)=>{let i=((e,a,t)=>{if(!eC(e))return null;let{id:n,mask_image:i,mask_bounds:r,is_hidden:l}=e,[s,o]=r[0],[d,u]=r[1],c=(e=>{try{let a=atob(e),t=Uint8Array.from(a,e=>e.charCodeAt(0)),n=new Blob([t],{type:"image/png"});return URL.createObjectURL(n)}catch{return null}})(i);return c?{maskData:{id:n,isHidden:!!l,maskHeight:u*t,maskHeightRatio:u,maskUrl:c,maskWidth:d*a,maskWidthRatio:d,maskX:s*a,maskXRatio:s,maskY:o*t,maskYRatio:o},maskUrl:c}:null})(n,a,t);return i&&(e.maskData.push(i.maskData),e.urls.push(i.maskUrl)),e},{maskData:[],urls:[]});if(l(n),0===n.length)return i([]),o(!1),()=>r.forEach(e=>URL.revokeObjectURL(e));let s=!1;return o(!0),(async()=>{let e=n.map(async e=>{let a=document.createElement("canvas"),t=a.getContext("2d",{willReadFrequently:!0});if(!t)return null;let{maskWidth:n,maskHeight:i}=e;a.width=n,a.height=i;try{let a=new Image;return a.crossOrigin="anonymous",new Promise(r=>{a.onload=()=>{if(s)return void r(null);t.drawImage(a,0,0,n,i),r(t)},a.onerror=()=>r(null),a.src=e.maskUrl})}catch{return null}}),a=await Promise.all(e);s||(i(a),o(!1))})(),()=>{s=!0,r.forEach(e=>URL.revokeObjectURL(e))}},[e,a,t]),{cutoutContexts:n,maskData:r,isLoading:s}}(e,T,F),L=function({maskData:e,cutoutContexts:a,imageContainerX:t,imageContainerY:n,setHoveredCutoutIndex:i,viewParameter:r,viewType:l}){let{logContextEvent:s}=(0,N.u)(),{checkExperiment:o}=(0,eu.r)(),{anyEnabled:d,group:u}=o("web_cutout_hit_detection_cache"),c="control"===u?1:"employees"===u?5:Number(u.split("_")[1]||5),p=(0,x.useRef)(new Map);(0,x.useEffect)(()=>{p.current.clear()},[e]);let m=(0,x.useCallback)((e,a)=>{e!==a&&(i(e),null!==e&&s({event_type:105,element:14154,view_parameter:r,view_type:l,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}))},[i,s,r,l]);return(0,x.useCallback)((i,r,l)=>{let s=d?`${Math.round(i.clientX/c)*c},${Math.round(i.clientY/c)*c}`:"";if(d&&p.current.has(s))return void m(p.current.get(s)??null,r);let o=i.clientX-t,u=i.clientY-n;for(let t=e.length-1;t>=0;t-=1){let n=e[t],i=a[t];if(i&&n&&t!==l&&ek(o,u,n)&&eP(i,o-n.maskX,u-n.maskY)){d&&p.current.set(s,t),m(t,r);return}}d&&p.current.set(s,null),m(null,r)},[d,a,t,n,e,c,m])}({maskData:D,cutoutContexts:E,imageContainerX:t,imageContainerY:n,setHoveredCutoutIndex:l,viewParameter:d,viewType:u}),O=(0,x.useCallback)(()=>w(!1),[]),B=(0,x.useCallback)(e=>{(e.movementX||e.movementY)&&w(!0),0===e.buttons?L(e,a,r):l?.(null)},[L,a,r,l]),z=(0,x.useCallback)(e=>L(e,a,r),[L,a,r]),V=(0,x.useCallback)(()=>l(null),[l]),G=(0,x.useCallback)(()=>{if(S||null===a)return void w(!1);if(l(null),s(a),!D[a])return;let{maskXRatio:e,maskYRatio:t,maskWidthRatio:n,maskHeightRatio:i}=D[a],r=(0,eg.Z)({cropArea:{x:e,y:t,w:n,h:i},scaledWidth:T,scaledHeight:F}),c=(0,ep.Z)({cropArea:r,cropSource:9,trafficSource:o});window.location.search!==c&&(p({event_type:101,element:14154,view_parameter:d,view_type:u,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}),g(`${window.location.pathname}${c}`,{replace:!0}))},[S,g,a,p,D,F,T,l,s,o,d,u]);return(0,x.useEffect)(()=>{let e=f.current;if(e)return e.addEventListener("mousedown",O),e.addEventListener("mousemove",B),e.addEventListener("mouseup",z),e.addEventListener("mouseleave",V),e.addEventListener("click",G),()=>{e.removeEventListener("mousedown",O),e.removeEventListener("mousemove",B),e.removeEventListener("mouseup",z),e.removeEventListener("mouseleave",V),e.removeEventListener("click",G)}},[O,B,z,V,G]),(0,U.jsxs)(v.xu,{ref:f,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"number"==typeof a?"pointer":"auto"}},"data-bitmaps-ready":D.length>0,"data-test-id":"cutouts-container",left:!0,position:"absolute",right:!0,role:"none",top:!0,children:[(0,U.jsx)(em.Z,{unsafeCSS:eh.iF}),D.map((e,t)=>(0,U.jsx)(eb,{isHovered:a===t,isObjectLevelCrop:j,isPinLevelCrop:I,isSelected:r===t,mask:e,pinKey:h,viewParameter:d,viewType:u},e.id))]})}var eI=t(739067),eR=t(378547);let ej=(void 0!==l||(l=t(582328)).hash&&"2d79886cca650301394af9cbacdeede4"!==l.hash&&console.error("The definition of 'StelaCutouts_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function eE({bitmapMasks:e,hoveredCutoutIndex:a,imageContainerX:n,imageContainerY:i,pinImageHovered:r,pinKey:l,selectedCutoutIndex:s,setHoveredCutoutIndex:o,setSelectedCutoutIndex:d,trafficSource:u,viewParameter:c,viewType:p}){(0,_.Z)("StelaCutouts","/app/www/Cutouts/StelaCutouts.tsx");let m=(0,$.D)(),g=(0,R.TH)(),{logContextEvent:h}=(0,N.u)(),y=(0,R.s0)(),f=(0,b.Z)(ej,l),{getNormalizedPinImage:S}=(0,M.Z)({pinKey:f,maxWidth:m?K.M:Z.Wm}),w=(0,x.useRef)(null),[k,P]=(0,x.useState)(!1),[C,F]=(0,x.useState)([]),[T,I]=(0,x.useState)(!1),[j,E]=(0,x.useState)(!1),{w:D,h:L}=(0,A.mB)(g.search),{height:O,width:B}=S(),z=(0,x.useMemo)(()=>Number(D)===B&&Number(L)===O||void 0===D&&void 0===L,[L,O,B,D]),V=(0,x.useMemo)(()=>({commerce_data:JSON.stringify({pin_has_cutout:!0})}),[]);(0,x.useEffect)(()=>{if(!e)return;let a=[];async function n({id:e,isHidden:n,maskHeightRatio:i,maskImage:r,maskWidthRatio:l,maskXRatio:s,maskYRatio:o,pinImageHeight:d,pinImageWidth:u}){let{ContourTracer:c,initializeWasm:p}=await t.e("95563").then(t.bind(t,193386));await p();let m=new c,g=atob(r),h=new Blob([Uint8Array.from(g,e=>e.charCodeAt(0))],{type:"image/png"}),y=await createImageBitmap(h),f=m.trace(y,{useAlpha:!1,threshold:80}),_=URL.createObjectURL(h);return a.push(_),{contours:f,contourXRatio:u*l/y.width,contourYRatio:d*i/y.height,id:e,isHidden:n,maskHeightRatio:i,maskUrl:_,maskWidthRatio:l,maskXRatio:s,maskYRatio:o}}let i=[];return e.forEach(e=>{let{id:a,mask_image:t,mask_bounds:r,is_hidden:l}=e,[s,o]=r?.[0]??[],[d,u]=r?.[1]??[];if(void 0!==a&&void 0!==t&&void 0!==s&&void 0!==o&&void 0!==d&&void 0!==u){let e=n({id:a,isHidden:!!l,maskHeightRatio:u,maskImage:t,maskWidthRatio:d,maskXRatio:s,maskYRatio:o,pinImageHeight:O,pinImageWidth:B});i.push(e)}}),(async()=>{F(await Promise.all(i))})(),()=>{a.forEach(e=>{URL.revokeObjectURL(e)})}},[e,O,B]);let G=(0,x.useMemo)(()=>{let e=[];return C.forEach((a,t)=>{let{contours:n}=a;n&&0!==n.length&&(e[t]=n.map(e=>{let a=e.points.map(e=>e.x),t=e.points.map(e=>e.y);return{minX:Math.min(...a),minY:Math.min(...t),maxX:Math.max(...a),maxY:Math.max(...t)}}))}),e},[C]),H=(0,x.useCallback)(e=>{let t=e.clientX-n,r=e.clientY-i;for(let e=C.length-1;e>=0;e-=1){let n=C[e];if(e===s||!n)continue;let{contours:i,contourXRatio:l,contourYRatio:d,maskXRatio:u,maskYRatio:m}=n,g=(t-u*B)/l,y=(r-m*O)/d,f=G[e];if(i.some((e,a)=>{let t=f?.[a];return t&&g>=t.minX&&g<=t.maxX&&y>=t.minY&&y<=t.maxY&&(0,eI.Z)({x:g,y:y},e.points)})){a!==e&&(o?.(e),h({event_type:105,element:14154,view_parameter:c,view_type:p,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}));return}}o?.(null)},[C,G,a,n,i,h,O,B,s,o,c,p]),W=()=>P(!1),Y=e=>{(e.movementX||e.movementY)&&P(!0),0===e.buttons?H(e):o?.(null)},X=e=>{H(e)},q=()=>o?.(null),Q=(0,x.useCallback)(()=>{if(k||null===a||!C[a])return void P(!1);d?.(a);let{maskXRatio:e,maskYRatio:t,maskWidthRatio:n,maskHeightRatio:i}=C[a],r=(0,eg.Z)({cropArea:{x:e,y:t,w:n,h:i},scaledWidth:B,scaledHeight:O}),l=(0,ep.Z)({cropArea:r,cropSource:9,trafficSource:u});l!==window.location.search&&(h({event_type:101,element:14154,view_parameter:c,view_type:p,aux_data:V}),y(`${window.location.pathname}${l}`,{replace:!0}))},[V,C,k,y,a,h,O,B,d,u,c,p]);return((0,x.useEffect)(()=>{let e=w.current;return e&&(e.addEventListener("mousedown",W),e.addEventListener("mousemove",Y),e.addEventListener("mouseup",X),e.addEventListener("mouseleave",q),e.addEventListener("click",Q)),()=>{e&&(e.removeEventListener("mousedown",W),e.removeEventListener("mousemove",Y),e.removeEventListener("mouseup",X),e.removeEventListener("mouseleave",q),e.removeEventListener("click",Q))}}),e)?(0,U.jsxs)(v.xu,{ref:w,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"number"==typeof a?"pointer":"auto"}},"data-bitmaps-ready":C.length>0,"data-test-id":"cutouts-container",left:!0,position:"absolute",right:!0,role:"none",top:!0,children:[(0,U.jsx)(em.Z,{unsafeCSS:eh.iF}),C.map((e,t)=>(0,U.jsx)(eR.Z,{auxData:V,bitmapData:e,hasAnimatedCutoutsOnLand:j,hasLoggedRender:T,hoveredCutoutIndex:a,index:t,isPinLevelCrop:z,pinImageHovered:r,pinKey:f,selectedCutoutIndex:s,setHasAnimatedCutoutsOnLand:E,setHasLoggedRender:I,viewParameter:c,viewType:p},e.id))]}):null}var eZ=t(68408);let eM=(void 0!==s||(s=t(934209)).hash&&"66496d579d49595f2dec36d1c939738c"!==s.hash&&console.error("The definition of 'VisualSearchCropper_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function eA({cropArea:e,cropSource:a,imageContainerX:t=0,imageContainerY:n=0,imageSize:i,pinKey:r,trafficSource:l,viewParameter:s,viewType:o}){(0,_.Z)("VisualSearchCropper","/app/www/VisualSearch/VisualSearchCropper.tsx");let{checkExperiment:d}=(0,eu.r)(),u=(0,b.Z)(eM,r),c=(0,R.s0)(),p=(0,eZ.Z)({pinKey:u}),[m,g]=(0,x.useState)("none"),[h,y]=(0,x.useState)(null),[f,S]=(0,x.useState)(-1),{bitmap_masks:v}=p??{},w=(0,x.useMemo)(()=>(v??[]).filter(eC).map(e=>{let{id:a,mask_bounds:t}=e,[n,i]=t[0],[r,l]=t[1];return{x:n,y:i,w:r,h:l,id:a}}),[v]);return(0,x.useEffect)(()=>{let a=(0,L.Z)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0});if(w&&w.length){let e=(0,ec.Z)(w,a);g("cutouts"),S(e.indexToHide)}},[e,w,i.height,i.width]),(0,U.jsx)(ed.Z,{cropArea:e,cropSource:a,hoveredCutoutIndex:h,imageContainerX:t,imageContainerY:n,imageSize:i,objectDetection:m,onChange:({cropArea:e,cropSource:a})=>{if("cutouts"===m){let t=(0,L.Z)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0}),{isCropAreaOnDotArea:n,indexToHide:r}=(0,ec.Z)(w,t);n&&(a=9,S?.(r))}let t=window.location.search,n=(0,ep.Z)({cropArea:e,cropSource:a,trafficSource:l});t!==n&&c({pathname:window.location.pathname,search:n})},setHoveredCutoutIndex:y,setSelectedCutoutIndex:S,viewParameter:s,viewType:o,children:(()=>{if("cutouts"!==m||!v?.length)return null;let{anyEnabled:e}=d("web_cutout_glow");return(0,U.jsx)(e?eT:eE,{bitmapMasks:v,hoveredCutoutIndex:h,imageContainerX:t,imageContainerY:n,pinKey:u,selectedCutoutIndex:f,setHoveredCutoutIndex:y,setSelectedCutoutIndex:S,trafficSource:l,viewParameter:s,viewType:o})})()})}let eD=(void 0!==o||(o=t(984110)).hash&&"727c8ab2c1c256e3b4478a36890f92d6"!==o.hash&&console.error("The definition of 'RelatedProductsImageContent_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);function eL({cropArea:e,cropSource:a,description:t,descriptorModules:n,height:i,imageContainerX:r,imageContainerY:l,imageUrl:s,pinKey:o,trafficSource:d,viewParameter:u,viewType:c,width:p}){(0,_.Z)("RelatedProductsImageContent","/app/common/react/components/shopping/RelatedProducts/RelatedProductsImageContent.tsx");let m=(0,$.D)(),g=(0,b.Z)(eD,o),{defaultColor:h,selectedColor:y,hoveredColor:f,pressedColor:x}=es(g.dominantColor),S=(0,q.A)(),w=n&&n.length>0;return(0,U.jsx)(v.xu,{"data-test-id":"flashlight-enabled-image",height:i,width:p,children:(0,U.jsxs)(v.zd,{height:i,rounding:m?6:4,width:p,children:[(0,U.jsx)(X.Z,{_enableViewTransitions:!0,type:"image",children:(0,U.jsx)(v.Ee,{alt:t,naturalHeight:i,naturalWidth:p,onLoad:()=>{(0,Q.Nx)("visualSearchMainPinImageRender"),S&&S.markConstraintComplete("visualSearchMainPinImageRender")},src:s})}),(0,U.jsx)(eA,{cropArea:e,cropSource:a,imageContainerX:r,imageContainerY:l,imageSize:{height:i,width:p},pinKey:g,trafficSource:d,viewParameter:u,viewType:c}),w&&(0,U.jsx)(er,{defaultPillColor:h,descriptorModules:n,hoveredPillColor:f,pinKey:g,pressedPillColor:x,selectedPillColor:y}),m&&(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{insetInlineStart:0}},position:"absolute",top:!0,children:(0,U.jsx)(eo,{defaultPillColor:h,hoveredPillColor:f,pressedPillColor:x,viewParameter:u,viewType:c})})]})})}var eK=t(742235),e$=t(780879),eO=t(721465),eN=t(288910);let eB=(void 0!==d||(d=t(758809)).hash&&"20c2c7f4ff982fb93a9608faa14f3ed2"!==d.hash&&console.error("The definition of 'RelatedProductsUnifiedFeed_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d);function ez({alignStart:e,auxData:a,isFilterOpened:t,isProductOnlyFeed:n,oneBarModules:i,pinKey:r,viewParameter:l,viewType:s,visualSearchFlashlightUnifiedResource:o}){(0,_.Z)("RelatedProductsUnifiedFeed","/app/common/react/components/shopping/RelatedProducts/UnifiedFeed/RelatedProductsUnifiedFeed.tsx");let d=(0,b.Z)(eB,r),u=!n&&i&&i.length>0,{data:c}=o,p=c?.search_identifier;return(0,U.jsxs)(x.Fragment,{children:[u&&(0,U.jsx)(v.xu,{position:"relative",zIndex:new v.Ry(1),children:(0,U.jsx)(eN.v,{children:(0,U.jsx)(e$.f,{children:(0,U.jsx)(eK.default,{oneBarModulesKey:null,oneBarModulesRest:i,paddingX:8})})})}),(0,U.jsx)(v.xu,{overflow:"hidden",children:(0,U.jsx)(eO.Z,{alignStart:e,auxData:a,isFilterOpened:t,isProductFeed:n,pinKey:d,searchId:p,viewParameter:l,viewType:s,visualSearchFlashlightUnifiedResource:o})})]})}var eU=t(449029),eV=t(761578),eG=t(140725),eH=t(93966),eW=t(255957),eY=t(123998);function eX({cropSource:e}){return{viewType:72,viewParameter:9===e?3462:3050}}var eq=t(230543),eQ=t(74459);let eJ=(void 0!==u||(u=t(829187)).hash&&"3a9a747c3135f426fe0cf32ca9147a5d"!==u.hash&&console.error("The definition of 'VisualSearchContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),u);function e0({cropArea:e,cropSource:a,isProductPage:t,oneBarModules:n,pinKey:i,searchId:r,descriptorModules:l,title:s,trafficSource:o,visualSearchFlashlightUnifiedResource:d}){(0,_.Z)("VisualSearchContainer","/app/www/VisualSearch/VisualSearchContainer.tsx");let u=(0,b.Z)(eJ,i),{getNormalizedPinImage:c}=(0,M.Z)({pinKey:u,maxWidth:Z.Wm}),p=(0,R.TH)(),{width:m=0}=(0,eV.Z)()||{},g=(0,eq.t)(),h=(0,eQ.Z)(),{imageContainerScrollTop:y,imageContainerScrollTopForPinId:f}=(0,eU._)(),S=(0,x.useRef)(null),[w,k]=(0,x.useState)(0),[P,C]=(0,x.useState)(0),{state:F}=p||{},{internalNavigation:T=!1}=F||{},{width:I,height:j,url:E}=c(),A=I+O.n,D=t?0:A+48,L=m-h-D-O.n,{viewType:K,viewParameter:$}=eX({cropSource:a}),N={commerce_data:JSON.stringify({is_product_only_feed:t})},B=()=>{let e=S.current;if(e){let{x:a,y:t}=e.getBoundingClientRect(),{scrollTop:n}=e;k(a),C(t-n)}};return(0,ey.Z)(()=>{B(),S.current&&0!==y.current&&f.current===u.entityId&&(S.current.scrollTop=y.current)}),(0,U.jsx)(eW.Z,{constraints:t?[]:["visualSearchMainPinImageRender"],measureGridVisuallyComplete:!0,surface:"visual_search",children:(0,U.jsx)(eY.Z,{objectId:r,view:K,children:(0,U.jsx)(eG.Z,{log:{aux_data:N,view_type:K,view_parameter:$},children:(0,U.jsxs)(v.xu,{"data-test-id":"related-products",children:[(0,U.jsx)(Y,{isProductPage:t,title:t?s:"",viewParameter:$,viewType:K}),!t&&(0,U.jsx)(v.xu,{ref:S,bottom:!0,dangerouslySetInlineStyle:{__style:{top:g+80,left:h,right:h}},height:"inherit",marginBottom:3,marginStart:12,onScroll:()=>{B(),y.current=S.current?.scrollTop||0,f.current=u.entityId},overflow:"auto",position:"fixed",width:A,children:(0,U.jsx)(eL,{cropArea:e,cropSource:a,description:u.description??"",descriptorModules:l,height:j,imageContainerX:w,imageContainerY:P,imageSignature:u.imageSignature||"",imageUrl:E,pinKey:u,showAnimation:!T,trafficSource:o,viewParameter:$,viewType:K,width:I})}),(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{top:80*!t,left:D,right:D}},paddingX:eH.jC,position:"relative",width:L,children:(0,U.jsx)(ez,{auxData:N,isProductOnlyFeed:t,oneBarModules:n,pinKey:u,viewParameter:$,viewType:K,visualSearchFlashlightUnifiedResource:d})})]})})})})}var e1=t(762525),e2=t(355363),e5=t(159527),e6=t(845421),e3=t(816533),e4=t(757947),e8=t(162903);let e7=(void 0!==c||(c=t(172359)).hash&&"f426019c8f8e2668ff17a413d85a72dd"!==c.hash&&console.error("The definition of 'VisualSearchCarousel_story' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),c);function e9({auxData:e,hasActionCTA:a,legacyStory:t,searchIdentifier:n,storyKey:i,trafficSource:r,viewParameter:l,viewType:s}){(0,_.Z)("VisualSearchCarousel","/app/www/VisualSearch/VisualSearchCarousel.tsx");let o=(0,S.TH)(),d=(0,b.Z)(e7,i),u=(0,x.useCallback)(({item:t,index:i})=>{if(a&&d.objects&&i===d.objects.length-1){let a=t.images?.["236x"]?.url,n=o.pathname+"products/"+o.search;return a&&(0,U.jsx)(e4.Z,{auxData:e,buttonText:d.action?.text||"See more",component:14339,dataTestId:"shop-action-item-button",element:179,imageWidth:e3.Z,previewImageSrc:a,storyId:d.storyId??void 0,storyType:d.storyType,url:n,view:s,viewParameter:l})}return(0,U.jsx)(e6.r,{auxData:e,componentType:14339,isInDesktopCarousel:!0,pinId:t.id||"",pinImageCrop:{width:e3.Z,height:e3.Z},pinKey:null,slotIndex:i,surface:"VisualInspirationShoppingPin",trafficSource:r,viewData:{search_identifier:n},viewParameter:l,viewType:s})},[a,d.objects,d.action?.text,d.storyId,d.storyType,e,r,n,l,s,o.pathname,o.search]),c=t?.objects?.filter(e=>"pin"===e.type);return c&&0!==c.length?(0,U.jsx)(e8.Z,{items:c,itemWidth:e3.Z,renderItem:u,showBorder:!0,storyKey:d,view:s,viewParameter:l}):null}function ae({auxData:e,isProductOnlyFeed:a,oneBarModules:t,trafficSource:n,viewParameter:i,viewType:r,visualSearchFlashlightUnifiedResource:l}){(0,_.Z)("VisualSearchFeed","/app/www/VisualSearch/VisualSearchFeed.tsx");let s=(0,P.ZP)(),o=(0,x.useRef)(!1),{logContextEvent:d}=(0,N.u)(),u=!a&&t&&t.length>0,{data:c,isFetching:p,fetchMore:m,isAtEnd:g}=l,{results:h=[],search_identifier:y}=c||{},{action:f,objects:S}=h.find(e=>"story"===e.type&&"stela_shop"===e.story_type)||{},{text:w,url:b}=f||{},k=S?.length||0,C=!!(w&&b),F=(0,e5.Z)(()=>{o.current||(d({event_type:110,view_type:r,view_parameter:i}),o.current=!0)},1e3),T=(0,x.useCallback)(({data:t,itemIdx:l})=>{if("story"===t.type)return"unified_entry_point_flashlight_header"===t.story_type?null:(0,U.jsx)(e9,{auxData:e,hasActionCTA:C,legacyStory:t,searchIdentifier:y,storyKey:{type:"deprecated",data:t},trafficSource:n,viewParameter:i,viewType:r});if("pin"===t.type){let s=l+k-!!C;return(0,U.jsx)(e6.r,{auxData:e,componentType:0,pinId:t.id,pinKey:null,slotIndex:s,surface:a?"ShoppingDynamicHeightGrid":"SearchItem",trafficSource:n,viewData:{search_identifier:y},viewParameter:i,viewType:r})}return null},[e,y,n,r,i,C,k,a]);return(0,U.jsxs)(x.Fragment,{children:[u&&(0,U.jsx)(W.Z,{position:"sticky",shouldShowShadow:!0,children:(0,U.jsx)(eN.v,{children:(0,U.jsx)(e$.f,{children:(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{paddingInlineEnd:"8px"}},children:(0,U.jsx)(eK.default,{itemHeight:48,marginBottom:0,oneBarModulesKey:null,oneBarModulesRest:t,paddingBottom:12,paddingX:0})})})})}),(0,U.jsx)(v.xu,{"data-test-id":"visual-search-feed",onScroll:F,overflow:"hidden",children:(0,U.jsx)(e2.Z,{isAtEndOfFeed:g,itemCount:h.length,children:(0,U.jsx)(v.Rk,{align:a?"center":"start",getColumnSpanConfig:e=>{let a="story"===e.type&&e.display_options?.num_columns_requested;return 0===a?1/0:a||1},items:h,loadItems:m,minCols:1,renderItem:T,scrollContainer:()=>window})})}),(0,U.jsx)(v.kC,{alignItems:"stretch",justifyContent:"center",width:"100%",children:(0,U.jsx)(v.xH,{accessibilityLabel:s._('Loading visual search results', 'visualSearch.spinner.label', 'Accessibility label for spinner when loading the visual search results'),show:p})})]})}let aa=(void 0!==p||(p=t(452486)).hash&&"5bacba9a50f154e988220cb4b6be32b2"!==p.hash&&console.error("The definition of 'VisualSearchImage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),p);function at({cropArea:e,cropSource:a,description:t,height:n,imageContainerX:i,imageContainerY:r,imageUrl:l,pinKey:s,trafficSource:o,viewParameter:d,viewType:u,width:c}){(0,_.Z)("VisualSearchImage","/app/www/VisualSearch/VisualSearchImage.tsx");let p=(0,b.Z)(aa,s),m=(0,q.A)();return(0,U.jsx)(v.xu,{"data-test-id":"flashlight-enabled-image",height:n,width:c,children:(0,U.jsxs)(v.zd,{height:n,rounding:6,width:c,children:[(0,U.jsx)(X.Z,{_enableViewTransitions:!0,type:"image",children:(0,U.jsx)(v.Ee,{alt:t,naturalHeight:n,naturalWidth:c,onLoad:()=>{(0,Q.Nx)("visualSearchMainPinImageRender"),m&&m.markConstraintComplete("visualSearchMainPinImageRender")},src:l})}),(0,U.jsx)(eA,{cropArea:e,cropSource:a,imageContainerX:i,imageContainerY:r,imageSize:{height:n,width:c},pinKey:p,trafficSource:o,viewParameter:d,viewType:u})]})})}let an=(void 0!==m||(m=t(922081)).hash&&"0266a98499053ece967eca560905770c"!==m.hash&&console.error("The definition of 'VisualSearchImageContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),m);function ai({cropArea:e,cropSource:a,descriptorModules:t,pinKey:n,trafficSource:i,viewParameter:r,viewType:l}){(0,_.Z)("VisualSearchImageContainer","/app/www/VisualSearch/VisualSearchImageContainer.tsx");let s=(0,b.Z)(an,n),{getNormalizedPinImage:o}=(0,M.Z)({pinKey:s,maxWidth:K.M}),d=(0,eq.t)(),u=(0,eQ.Z)(),{imageContainerScrollTop:c,imageContainerScrollTopForPinId:p}=(0,eU._)(),m=(0,x.useRef)(null),[g,h]=(0,x.useState)(0),[y,f]=(0,x.useState)(0),{defaultColor:S,selectedColor:w,hoveredColor:k,pressedColor:P}=es(s.dominantColor),{width:C,height:F,url:T}=o(),I=C+16,R=(0,x.useCallback)(()=>{let e=m.current;if(e){let{x:a,y:t}=e.getBoundingClientRect(),{scrollTop:n}=e;h(a),f(t-n)}},[]),j=(0,x.useCallback)(()=>{R(),c.current=m.current?.scrollTop||0,p.current=s.entityId},[R,s.entityId,c,p]);return(0,ey.Z)(()=>{let e=m.current;if(!e)return;let a=c.current,t=p.current;return 0!==a&&t===s.entityId&&(e.scrollTop=a),R(),()=>{e.removeEventListener("scroll",j)}}),(0,U.jsxs)(x.Fragment,{children:[(0,U.jsx)(v.xu,{ref:m,bottom:!0,dangerouslySetInlineStyle:{__style:{top:d,insetInlineStart:u,overscrollBehavior:"contain"}},height:F,marginStart:3,onScroll:j,overflow:"auto",position:"fixed",width:I,children:(0,U.jsx)(v.xu,{height:F+64,children:(0,U.jsx)(at,{cropArea:e,cropSource:a,description:s.description??"",height:F,imageContainerX:g,imageContainerY:y,imageSignature:s.imageSignature||"",imageUrl:T,pinKey:s,trafficSource:i,viewParameter:r,viewType:l,width:C})})}),(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{top:d,insetInlineStart:u}},marginStart:5,marginTop:2,position:"fixed",children:(0,U.jsx)(eo,{defaultPillColor:S,hoveredPillColor:k,pressedPillColor:P,viewParameter:r,viewType:l})}),t&&t.length>0&&(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{top:d+F-64,insetInlineStart:u}},height:64,marginStart:3,position:"fixed",width:C,children:(0,U.jsx)(er,{defaultPillColor:S,descriptorModules:t,hoveredPillColor:k,pinKey:s,pressedPillColor:P,selectedPillColor:w})}),(0,U.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{boxSizing:"content-box"}},height:1,marginEnd:6,marginStart:3,minWidth:I})]})}let ar=(void 0!==g||(g=t(331921)).hash&&"3c3f391c3bf9eec79c18ed9a3fe63800"!==g.hash&&console.error("The definition of 'VisualSearchLayout_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),g);function al({cropArea:e,cropSource:a,isProductPage:t,oneBarModules:n,pinKey:i,searchId:r,descriptorModules:l,trafficSource:s,visualSearchFlashlightUnifiedResource:o}){(0,_.Z)("VisualSearchLayout","/app/www/VisualSearch/VisualSearchLayout.tsx");let d=(0,b.Z)(ar,i),u=(0,P.ZP)(),c=u._('Shop similar', 'visualSearch.productPage.header', 'Shop similar visual searched items.'),{viewType:p,viewParameter:m}=eX({cropSource:a}),g={commerce_data:JSON.stringify({is_product_only_feed:t})};return(0,U.jsx)(eW.Z,{constraints:t?[]:["visualSearchMainPinImageRender"],measureGridVisuallyComplete:!0,surface:"visual_search",children:(0,U.jsx)(eY.Z,{objectId:r,view:p,children:(0,U.jsxs)(eG.Z,{log:{aux_data:g,view_type:p,view_parameter:m},children:[t?(0,U.jsx)(Y,{isProductPage:!0,title:c,viewParameter:m,viewType:p}):(0,U.jsx)(e1.Z,{text:u._('Image Search Page', 'imageSearch.accessibilityHiddenHeading', 'Accessibility label for image search page')}),(0,U.jsxs)(v.kC,{height:"100%",width:"100%",children:[!t&&(0,U.jsx)(ai,{cropArea:e,cropSource:a,descriptorModules:l,pinKey:d,trafficSource:s,viewParameter:m,viewType:p}),(0,U.jsx)(v.kC.Item,{flex:"grow",children:(0,U.jsx)(ae,{auxData:g,isProductOnlyFeed:t,oneBarModules:n,trafficSource:s,viewParameter:m,viewType:p,visualSearchFlashlightUnifiedResource:o})})]})]})})})}let as=(void 0!==h||(h=t(553593)).hash&&"a97627ca011ed4139267bc5a970d6d7a"!==h.hash&&console.error("The definition of 'VisualSearchPageWithPinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),h);function ao({pinKey:e}){let a=(0,R.TH)(),t=(0,b.Z)(as,e),n=(0,$.D)(),{getNormalizedPinImage:i}=(0,M.Z)({pinKey:t,maxWidth:n?K.M:Z.Wm}),{cropSource:r,entrypoint:l,full_feed_title:s="",filters:o,hybrid_search_param:d,journey_depth:u,search_query:c,source_module_id:p,selected_descriptors:m,requestParams:g,rs:h}=(0,A.mB)(a.search),{width:y,height:f}=i(),_=(0,x.useMemo)(()=>(0,j.Z)(a,y,f)??{x:0,y:0,w:y,h:f},[a,y,f]),S=(0,D.Z)(Number(r))||5,v=a.pathname.includes("/products"),{searchId:w,visualSearchFlashlightUnifiedResource:k,oneBarModules:P,descriptorModules:C}=(0,E.Z)({resourceOptions:{crop:(0,L.Z)({cropArea:_,scaledWidth:y,scaledHeight:f}),crop_source:S,entry_source:v?"shopping":"flashlight",entrypoint:l||v&&"feed_module"||null,field_set_key:"shopping_grid_item",image_signature:t.imageSignature||void 0,is_shopping:v,pin_id:t.entityId,request_params:g,source:h,filters:o,hybrid_search_param:d,selected_descriptors:m,journey_depth:parseInt(u,10)||void 0,search_query:c,source_module_id:p}});return t?(0,U.jsx)(n?al:e0,{cropArea:_,cropSource:S,descriptorModules:C,isProductPage:v,oneBarModules:P,pinKey:t,searchId:w,title:s,trafficSource:h,visualSearchFlashlightUnifiedResource:k}):null}function ad({pinKey:e}){return(0,_.Z)("VisualSearchPageWithPinData","/app/www/VisualSearch/VisualSearchPageWithPinData.tsx"),(0,U.jsx)($.h,{children:(0,U.jsx)(ao,{pinKey:e})})}let au=(void 0!==y||(y=t(55575)).hash&&"0f7b98a1f02dbf8528df0452aa26efd4"!==y.hash&&console.error("The definition of 'RelatedProductsPageQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),y),ac=(void 0!==f||(f=t(376985)).hash&&"91d05676e413b7b47653c2f8fa609093"!==f.hash&&console.error("The definition of 'RelatedProductsPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),f);function ap({pinId:e,relatedProductsDataRef:a}){let t=(0,P.ZP)(),n=(0,k.Z)({strategy:"LEGACY",query:au,variables:{pinId:e},useGetLegacyData:()=>{let{data:e}=(0,C.Z)(a);return e}}),i=n?.v3GetPinQuery?.__typename==="V3GetPin"?n.v3GetPinQuery.data:null,r=(0,b.Z)(ac,i);return(0,U.jsx)(x.Suspense,{fallback:(0,U.jsx)(v.xH,{accessibilityLabel:t._('Loading Pin data', 'RelatedProductsPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0}),children:r&&(0,U.jsx)(ad,{pinKey:r})})}function am(){(0,_.Z)("RelatedProductsPage","/app/www/pages/authDesktop/RelatedProductsPage.tsx");let e=(0,S.$B)(),{pinId:a}=(0,T.Z)(e.params.id||""),{ref:t}=(0,F.Z)({name:"PinResource",options:{id:a,field_set_key:"detailed"}});return(0,U.jsx)(w.Z,{name:"RelatedProductsPage_RelatedProductsPageWrapper",children:(0,U.jsx)(x.Suspense,{fallback:(0,U.jsx)(I.Z,{}),children:(0,U.jsx)(ap,{pinId:a,relatedProductsDataRef:t})})})}},474147:function(e,a,t){t.d(a,{J:()=>h,Z:()=>x});var n=t(636208),i=t(35831),r=t(712064),l=t(356299),s=t(388023),o=t(428725),d=t(696323),u=t(339618);let c=new Set(["PinResource","RepinResource"]),p={ApiResource:e=>e?.url==="/v3/orientation/nux_creator_recommendations/"?"nux-creator-recommendations":e?.url==="/v3/users/me/interests/"?`recommended-interests:${e.data?.blend_type}`:e?.url===`/v3/usecases/${e.data?.use_case_id}/feed/`?"useCaseFeed":e?.url===`/v3/boards/${e.data?.board_id}/automagical/pins/`?`automagical-board-feed:${e.data?.board_id}`:"",AggregatedActivityFeedResource:e=>`trieditfeed:${e.aggregated_pin_data_id}`,AggregatedCommentFeedResource:e=>`aggregated-comments:${e.objectId}`,AggregatedCommentReplyFeedResource:e=>`${d.Z.AGGREGATED_COMMENT_REPLIES}:${e.objectId}`,BoardlessPinsResource:e=>`boardless-pins:${e.userId}`,BestPinsFeedAltResource:e=>`idea-page-best-pins:${e.interest}`,BoardArchiveResource:()=>"archived-boards",BoardContentRecommendationResource:e=>`recommendation-feed:${e.id}`,BoardFeedResource:e=>`boardfeed:${e.board_id}`,BoardSectionsRepinResource:e=>`board-sections:${e.board_id}`,BoardSectionsResource:e=>`board-sections:${e.board_id}`,BoardSectionPinsResource:e=>`board-section-pins:${e.section_id}`,BoardsFeedResource:e=>`profile-boards:${e.username}`,BoardToolsFeedResource:e=>`board-tools:${e.boardId}`,ConversationsResource:()=>"conversations",DidItLikedByResource:e=>`triedit-likes:${e.didItDataId}`,DidItUserFeedResource:e=>`profile-tried:${e.username}`,InterestResource:e=>`klp-pins:${e.interest}`,MoreIdeasTabsBoardsResource:()=>"homefeed-more-ideas-tabs",NewsHubResource:()=>"notifications",NewsHubDetailsResource:e=>`newshubdetail:${e.news_id}`,NuxInterestsResource:()=>"nuxTopics",PinsFromBrandResource:e=>`brand-pins:${e.pin}`,ReactionsResource:e=>`reactions:${e.pin_id}`,RelatedArticlesResource:e=>`related-articles:${e.article_id}`,RelatedModulesResource:e=>`related-modules:${e.pin_id}`,RelatedPinFeedResource:e=>`related-pins:${e.pin}`,RelatedStreamResource:e=>`related-story-pins:${e.pinId}`,SearchResource:e=>{let a=`search:${e.scope}:${e.query}:${e.filters||""}:${e.article||""}`;return e.auto_correction_disabled?`${a}:auto-correction-disabled`:a},BaseSearchResource:e=>{let{appliedProductFilters:a,article:t,auto_correction_disabled:n,filters:i,journey_depth:r,query:l,scope:s,selected_one_bar_modules:o,source_id:d,source_module_id:c,top_pin_ids:p}=e;return`search:${(0,u.Z)({appliedFilters:a,article:t,autoCorrectionDisabled:n,filters:i,journeyDepth:r,query:l,scope:s,selectedOneBarModules:o,sourceId:d,sourceModuleId:c,topPinIds:p})}`},SectionToolsFeedResource:e=>`section-tools:${e.sectionId}`,ShareSuggestionsTypeaheadResource:e=>`share-suggestions:${e.board||e.user}:${e.term}`,StoryFeedResource:e=>`story-feed:${e.feed_type}:${e.request_params}`,StoryPinTaggedProductsResource:()=>"story-pin-tagged-products",TodayArticleFeedResource:e=>`today-article:${e.id}`,TodayTabInterestFeedResource:e=>`today-article-interestfeed:${e.interest_id}`,TodayTabResource:()=>"today-tab",SeoTier1CandidateResource:()=>"tier1-feed",UnifiedCommentsResource:e=>`unified-comments:${e.aggregated_pin_id}`,UserActivityPinsResource:e=>`profile-pins-feed:${e.user_id}`,UserHomefeedResource:e=>e.pin_quiz?"pin-quiz":"homefeed",UserFollowingResource:e=>`user-following:${e.username}`,UserRecentActivityResource:e=>`user-recent-activity:${e.filter_type}`,UserStoryPinsFeedResource:e=>`story-pins-feed:${e.user_id}`,VisualLiveSearchResource:e=>`visual-search:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualLiveSearchProductFeedResource:e=>`visual-search-products:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualSearchFlashlightUnifiedResource:e=>`related-products-unified:${e.pin_id}`,InterestFollowingResource:e=>`topic-following:${e.username}`,UserPinsResource:e=>`profile-pins:${e.username}`,TopicFeedResource:e=>e.best_pins?`best-topic-pins:${e.interest}`:`topic-pins:${e.interest}`},m={AggregatedActivityFeedResource:({options:{aggregated_pin_data_id:e}})=>({type:d.Z.TRIED_IT_FEED,id:e}),AggregatedCommentFeedResource:({options:{objectId:e}})=>({type:d.Z.AGGREGATED_COMMENTS,id:e}),AggregatedCommentReplyFeedResource:({options:{isUnifiedComment:e,objectId:a}})=>({type:e?d.Z.AGGREGATED_COMMENT_REPLIES:d.Z.AGGREGATED_COMMENTS,id:a,reversed:!0}),ApiResource:({options:{url:e,data:a}})=>e===`/v3/usecases/${a?.use_case_id}/feed/`?{type:d.Z.USE_CASE_TAB,id:a.use_case_id}:e===`/v3/boards/${a?.board_id}/automagical/pins/`?{type:d.Z.AUTOMAGICAL_BOARD_FEED,id:a.board_id}:null,BoardFeedResource:({options:{board_id:e}})=>({type:d.Z.BOARDFEED,id:e}),BoardlessPinsResource:({options:{userId:e}})=>({type:d.Z.BOARDLESS_PINS,id:e}),BoardSectionPinsResource:({options:{section_id:e}})=>({type:d.Z.BOARD_SECTION_PINS,id:e}),BoardSectionsResource:({options:{board_id:e}})=>({type:d.Z.BOARD_SECTIONS,id:e}),BoardsResource:({options:{username:e,sort:a,filter_types:t}})=>({type:d.Z.PROFILE_BOARDS,id:(0,l.Z)(e,a,t)}),BaseSearchResource:({options:{appliedProductFilters:e,appliedUnifiedFilters:a,auto_correction_disabled:t,filters:n,journey_depth:i,query_pin_sigs:l,query:s,rs:o,scope:u,selected_one_bar_modules:c,source_id:p,source_module_id:m,top_pin_ids:g,user:h},response:y})=>({type:d.Z.SEARCH_PINS,id:(0,r.Tb)({appliedProductFilters:e,appliedUnifiedFilters:a,autoCorrectionDisabled:t,filters:n,journeyDepth:i,query:s,rs:o,scope:u,selectedOneBarModules:c,selectedPinImgSig:l,sourceId:p,sourceModuleId:m,topPinIds:g,user:h}),items:y.resource_response.data?.results||[]}),DidItCommentsResource:({options:{objectId:e}})=>({type:d.Z.AGGREGATED_COMMENTS,id:e,reversed:!0}),DidItUserFeedResource:({options:{username:e}})=>({type:d.Z.TRIED_IT_FEED,id:e}),RelatedArticlesResource:({options:{article_id:e}})=>({type:d.Z.TODAY_TAB,id:e}),StoryPinDraftsResource:({options:{userId:e}})=>({type:d.Z.STORY_PIN_DATA,id:e}),TodayTabInterestFeedResource:({options:{interest_id:e}})=>({type:d.Z.TODAY_ARTICLE_INTEREST_FEED,id:e}),TodayTabResource:()=>({type:d.Z.TODAY_TAB,id:"todayTab"}),UnifiedCommentsPreviewResource:({options:{aggregated_pin_id:e}})=>({type:d.Z.UNIFIED_COMMENTS,id:e}),UnifiedCommentsResource:({options:{aggregated_pin_id:e,is_reversed:a}})=>({type:d.Z.UNIFIED_COMMENTS,id:e,reversed:a}),UserActivityPinsResource:({options:{user_id:e}})=>({type:d.Z.PROFILE_PINS_FEED,id:e}),UserStoryPinsFeedResource:({response:e,options:{user_id:a}})=>({type:d.Z.STORY_PINS_FEED,id:a,items:e.resource_response.data||[]})},g=(e,{pinId:a,oldFeedId:t,newFeedId:n})=>t===n?e:((e,{pinId:a,feedId:t})=>e[t]?{...e,[t]:[{type:"pin",id:a},...e[t]]}:e)(((e,{pinId:a,feedId:t})=>e[t]?{...e,[t]:e[t].filter(e=>"pin"!==e.type||e.id!==a)}:e)(e,{pinId:a,feedId:t}),{pinId:a,feedId:n}),h=(e,a)=>e in p?p[e](a):null,y=(e,a)=>a?`board-section-pins:${a}`:`boardfeed:${e}`,f=(e,a)=>e.map(e=>{let{id:t,schema:n,type:i}=e;return"home_feed_tabs"===i?e:n?{id:t,type:n,trackingParams:"pin"===n?a.pins[t].tracking_params:void 0,user_id:void 0}:null}).filter(Boolean),_=(e,a,t)=>Object.keys(e).reduce((n,i)=>{let r=e[i]||[],l=r.filter(e=>{if(e.type!==a)return!0;if("reaction"===a){let a=e.id.lastIndexOf(":");return e.id.substring(0,a)!==t}return e.id!==t});return r.length!==l.length&&(n[i]=l),n},{...e}),x=(e={},a)=>{switch(a.type){case i.zP:case i.aW:{let{payload:t}=a,{resource:n,options:r,normalizedResponse:l,schema:u}=t;if(l&&n in p){let t=((e,a,t)=>{let n=t||s.Z[e];if(n===o.LR)return a.result;if(n===o.sN)return a.result.map(e=>({id:e,schema:"board"}));if(n===o.Gn)return a.result.map(e=>({id:e,schema:"user"}));if(n===o.Ht)return a.result.map(e=>({id:e,schema:"invite"}));if(n===o.fE)return a.result.map(e=>({id:e,schema:"reaction"}));if("object"==typeof n){let e=Object.entries(n).find(([,e])=>e===o.LR);if(e)return a.result[e[0]]}return null})(n,l,u);if(t&&Array.isArray(t)){let s=p[n](r);if("BoardToolsFeedResource"===n||"SectionToolsFeedResource"===n)return{...e,[s]:t};if("UnifiedCommentsResource"===n){let n=f(t,l.entities);if(e[s]&&(i.zP||i.aW===a.type))return{...e,[s]:[...e[s],...n]};return{...e,[s]:n}}{let n=[...a.type===i.aW&&e[s]||[],...f(t,l.entities)];return{...e,[s]:n}}}}else{let{data:n}=t.response.resource_response;if(!t.options?.redux_normalize_feed)return e;let r=m[t.resource]({options:t.options,response:t.response});if(r){let{type:t,id:l,items:s,reversed:o}=r,u=(s||n||[]).filter(Boolean).map(e=>((e,a)=>{switch(e.type){case"story":return{id:e.id??"",type:"story",story_type:e.story_type??""};case"module":return{id:e.id,type:"module",name:e.name};case"user":return{id:e.id,type:"user"};case"board":return a===d.Z.PROFILE_BOARDS?{id:e.id,type:"board",onProfile:!0,profileGroup:e.archived_by_me_at?"archived":e.privacy||"public"}:{id:e.id,type:"board",onProfile:!1};case"board_section":return{type:"boardsection",id:e.id};case"triedit":return{type:"triedit",id:e.id};case"aggregatedcomment":return{type:"aggregatedcomment",id:e.id};case"home_feed_tab":return{type:"home_feed_tab",id:e.id,name:e.name};case"storypindata":return{id:e.id,type:"storypindata"};case"todayarticle":return{type:"todayarticle",id:e.id};case"unifiedcommentspreview":return"userdiditdata"===e.unified_comment.type?{type:"triedit",id:e.unified_comment.id}:{type:"aggregatedcomment",id:e.unified_comment.id};default:let t="useCaseFeed"===a&&"tracking_params"in e;return{type:"pin",id:e.id??"",...t&&{trackingParams:e.tracking_params}}}})(e,t));o&&(u=u.reverse());let c=`${t}:${l}`,p=e[c];if(p||a.type!==i.aW){let t=p||[],n=u;return a.type===i.aW&&(n=o?u.concat(t):t.concat(u)),{...e,[c]:n}}}}break}case"FEED_ITEM_REORDERED":{let{payload:{feedType:t,feedId:i,itemType:r,targetItemId:l,sourceItemId:s}}=a,o=`${t}:${i}`,u=e[o]||[],c=-1,p=-1;if([d.Z.BOARDFEED,d.Z.BOARD_SECTION_PINS,d.Z.BOARD_SECTIONS,"profileBoards"].includes(t)&&(c=u.findIndex(e=>e.type===r&&e.id===s),p=u.findIndex(e=>e.type===r&&e.id===l)),-1!==c&&-1!==p)return{...e,[o]:(0,n.Z)(u,c,p)};break}case"FEED_ITEMS_REMOVED":{let{payload:{feedType:t,feedId:n,inverseSelection:i,itemType:r,itemIds:l=[]}}=a,s=`${t}:${n}`,o=e[s]||[];if(o&&o.length>0&&(t===d.Z.BOARD_SECTION_PINS||t===d.Z.BOARDFEED)){let a=o.filter(e=>{let a=l.includes(e.id);return!(e.type===r&&(i&&!a||!i&&a))}),t=!!a.find(e=>"pin"===e.type);return{...e,[s]:t?a:[]}}if(o&&o.length>0&&t===d.Z.BOARD_SECTIONS||o&&o.length>0&&(t===d.Z.AGGREGATED_COMMENTS||t===d.Z.BOARDLESS_PINS||t===d.Z.PROFILE_PINS_FEED||t===d.Z.STORY_PINS_FEED||t===d.Z.UNIFIED_COMMENTS||t===d.Z.TRIED_IT_FEED||t===d.Z.STORY_PIN_DATA)){let a=o.filter(e=>{let a=l.includes(e.id);return!(e.type===r&&a)});return{...e,[s]:a}}break}case"FEED_ITEMS_ADDED":{let{payload:{feedType:t,feedId:n,itemType:i,itemIds:r=[],prepend:l}}=a,s=`${t}:${n}`,o=e[s]||[];if(o&&(t===d.Z.BOARD_SECTION_PINS||t===d.Z.BOARDFEED||t===d.Z.BOARDLESS_PINS)){let a=r.map(e=>({id:e,type:i})),t=0;"story"===(o[0]||{}).type&&(t=1),"story"===(o[1]||{}).type&&(t=2);let n=[...o.slice(0,t),...a,...o.slice(t)];return{...e,[s]:n}}if(o&&t===d.Z.BOARD_SECTIONS){let a=[...r].reverse().map(e=>({id:e,type:"boardsection"})),t=o?[...a,...o]:[...a];return{...e,[s]:t}}if(t===d.Z.AGGREGATED_COMMENTS||t===d.Z.AGGREGATED_COMMENT_REPLIES||t===d.Z.PROFILE_PINS_FEED||t===d.Z.STORY_PINS_FEED||t===d.Z.UNIFIED_COMMENTS){let a=r.map(e=>({id:e,type:i})),t=o?[...l?a:o,...l?o:a]:a;return{...e,[s]:t}}if(t===d.Z.TRIED_IT_FEED){let a=r.map(e=>({id:e,type:i})),t=o?[...a,...o]:a;return{...e,[s]:t}}break}case"FEED_INVALIDATE":{let{payload:{feedType:t,feedId:n}}=a,i=`${t}:${n}`;return e[i],{...e,[i]:null}}case"APPEND_FEED_ITEMS":{let{payload:{id:t,items:n,options:i}}=a,r=e[t];if(!r)return{...e,[t]:n};{let a;return a=i.isPrepend?r[0]&&"story"===r[0].type?[].concat(r[0],n,r.slice(1)):n.concat(r):r.concat(n),{...e,[t]:a}}}case"PIN_DELETE":{let{payload:{pinId:t}}=a;return _(e,"pin",t)}case"BOARD_ARCHIVE":{let{payload:{boardId:t,username:n}}=a,i=`profile-boards:${n??""}`;if(e[i])return{...e,[i]:e[i].filter(e=>e.id!==t)};break}case"BOARD_UNARCHIVE":{let{payload:{boardId:t}}=a,n="archived-boards";if(e[n])return{...e,[n]:e[n].filter(e=>e.id!==t)};break}case"BOARD_DELETE":{let{payload:{boardId:t}}=a;return _(e,"board",t)}case"BOARD_SECTION_DELETE":{let{payload:{boardSectionId:t}}=a;return _(e,"boardsection",t)}case"PINS_MOVE":{let{payload:{source:t,target:n,pinIds:i,userId:r}}=a,l=t.boardlessPins&&r&&`boardless-pins:${r}`||t.boardId&&y(t.boardId,t.sectionId),s=y(n.boardId,n.sectionId);return i.reduce((e,a)=>g(e,{pinId:a,oldFeedId:l,newFeedId:s}),e)}case"PINS_MOVE_ALL":{let{payload:{source:t,target:n,excludePinIds:i}}=a,r=y(t.boardId,t.sectionId),l=y(n.boardId,n.sectionId),s={...e,[r]:i.map(e=>({type:"pin",id:e}))};return delete s[l],s}case"PIN_EDIT":{let{payload:{pinId:t,boardId:n,sectionId:i="",source:{boardId:r,sectionId:l}}}=a;return g(e,{pinId:t,oldFeedId:y(r,l),newFeedId:y(n,i)})}case i.AF:if(c.has(a.payload.resource)){let t,n=a.payload.response.resource_response.data,{board:i}=n;if("quick_saves"===i.layout)t=`boardless-pins:${a.payload.options.user_id}`;else{let e=a.payload.options.section;t=e?`board-section-pins:${e}`:`boardfeed:${i.id}`}if(e[t]){let a={...e},i={id:n.id,type:"pin",trackingParams:n?.tracking_params};return a[t]=[i].concat(e[t]),a}}if("BoardSectionResource"===a.payload.resource&&a.payload.normalizedResponse){let t=a.payload.normalizedResponse.result,n=a.payload.normalizedResponse.entities.boardsections[t].board,i=`board-sections:${n}`;if(e[i]){let a={...e};return a[i]=[{id:t,type:"boardsection"}].concat(e[i]),a}}if("AggregatedCommentResource"===a.payload.resource&&a.payload.normalizedResponse){let t={id:a.payload.normalizedResponse.result,type:"aggregatedcomment"},n={...e};for(let i of["aggregated-comments","unified-comments"]){let r=`${i}:${a.payload.options.objectId}`;e[r]&&(n={...n,[r]:[t].concat(n[r])})}return n}if("AggregatedCommentReplyResource"===a.payload.resource&&a.payload.normalizedResponse){let t=`${d.Z.AGGREGATED_COMMENT_REPLIES}:${a.payload.options.objectId}`;return{...e,[t]:[...e[t]||[],{id:a.payload.normalizedResponse.result,type:"aggregatedComment"}]}}if("ReactionsResource"===a.payload.resource&&a.payload.normalizedResponse){let{reaction_pin_id:t,reaction_type:n}=a.payload.options;if("reaction"===a.payload.options.action_type){let i=`reactions:${a.payload.options.pin_id}`,r={...e},l={id:`${t}:${a.payload.options.user_id}:${n}`,type:"reaction",trackingParams:void 0};return r[i]=[l].concat(e[i]),r}if("unreaction"===a.payload.options.action_type)return _(e,"reaction",`${t}:${a.payload.options.user_id}`)}break;case"COMPLETE_STORY":{let{payload:{storyId:t}}=a;return _(e,"story",t)}}return e}},588836:function(e,a,t){t.d(a,{Z:()=>_});var n=t(281098),i=t(581722),r=t(825332),l=t(20256),s=t(111330),o=t(521009),d=t(346955),u=t(667835),c=t(19585),p=t(506662),m=t(753143),g=t(941404),h=t(572227),y=t(647709),f=t(785893);function _({alignIconLeft:e,bgColor:a,color:t,disableRedirect:_=!1,fallbackUrl:x,icon:S="arrow-back",onTouch:v,padding:w,placement:b,shouldUseFallbackUrl:k,size:P="lg",viewParameter:C,viewType:F,isVisualSearch:T}){(0,n.Z)("BackButton","/app/www/routing/BackButton.tsx");let I=(0,c.Z)(),R=(0,r.s0)(),j=(0,r.TH)(),E=(0,y.HG)(),Z=(0,i.v9)(e=>e.session.isAuthenticated),M=(0,o.Z)(),A=(0,h.Z)(),D=(0,u.vs)(),{viewType:L,viewParameter:K}=(0,d.SU)(),[$,O]=F?[F,C]:[L,K],N=()=>{let e=(0,m.M0)().getItem(s.pm);j.key||"/ideas"!==x?(0,g.My)(`pinner_conversion.back_button.${String(e?.[0].pageType)}`):(0,g.My)("pinner_conversion.back_button.no_history"),(0,g.My)(`web_back_button_click.${String(b)}.is_auth_${String(Z)}`),A({action:"click",item:"back-button"}),$&&M({view_type:$,view_parameter:O,element:34,event_type:102}),v&&v(),_||((!j.key||!j.state||j.state?.referrer==="redirect"||k)&&x?R(x):j.pathname.includes("/password/reset/")&&j.search&&j.search.includes("?nativeShouldDismiss=true")?R("/login/?dismissWebview=true"):R(-1))},B=D?u.t4:"white",z=(0,p.am)(j)||T||"white"===t;return(0,f.jsx)(l.xu,{"data-test-id":"back-button",children:e?(0,f.jsx)(l.xu,{alignItems:"center",display:"flex",height:48,marginStart:"cancel"===S?-1:-2,width:48,children:(0,f.jsx)(l.hU,{accessibilityLabel:I._('Back', 'navigation button', 'navigation button'),bgColor:a,icon:S,iconColor:!t&&(!a||["white","lightGray","transparent"].includes(a))?"gray":t,onClick:N,padding:"auto"!==w?w:2,size:P})}):(0,f.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:E||z||a?"":B,width:D&&!z?"fit-content":""}},rounding:"circle",children:(0,f.jsx)(l.hU,{accessibilityLabel:I._('Back', 'navigation button', 'navigation button'),bgColor:a||E?a:"transparent",icon:S,iconColor:!t&&(!a||["white","lightGray","transparent"].includes(a))?"gray":t,onClick:N,padding:"auto"!==w?w:2,size:P})})})}},339618:function(e,a,t){t.d(a,{Z:()=>n});function n({appliedFilters:e,article:a,autoCorrectionDisabled:t,filters:n,journeyDepth:i,query:r,scope:l,selectedOneBarModules:s,sourceId:o,sourceModuleId:d,topPinIds:u}){let c=[l,r,n,e,a,o,d,i,u].map(e=>e??"").join(":");return t&&(c+=":auto-correction-disabled"),s&&(c+=`:${s}`),c}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/6325-e46c740176bd06ad.mjs.map