(self.modernJsonp=self.modernJsonp||[]).push([["49793"],{625957:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FlashlightSpotlightDots_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetStringifiedCommerceAuxData_pin"}],type:"Pin",abstractKey:null};i.hash="3a8409077905af94eb39568e4a5a57fc";let a=i},703555:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StelaCutout_pin",selections:[{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"}],type:"Pin",abstractKey:null};i.hash="0b66eea622c037ef845cce3aa4cd2d46";let a=i},101844:function(e,t,n){n.d(t,{Z:()=>p});var i=n(281098),a=n(667294),o=n(20256),r=n(785893);let s={nw_horizontal:"inset(0 0 0 50%)",nw_vertical:"inset(50% 0 0 0)",ne_horizontal:"inset(0 50% 0 0)",ne_vertical:"inset(50% 0 0 0)",sw_horizontal:"inset(0 0 0 50%)",sw_vertical:"inset(0 0 50% 0)",se_horizontal:"inset(0 50% 0 0)",se_vertical:"inset(0 0 50% 0)"};function l({top:e,left:t,bottom:n,right:l,size:u,transition:c,opacity:h}){(0,i.Z)("AnchorStrokeCap","/app/packages/Cropper/AnchorStrokeCap.tsx");let d=(0,a.useMemo)(()=>{let i=((e,t,n,i)=>{let a=void 0!==e,o=void 0!==n,r=void 0!==t,s=void 0!==i;return a&&r&&!o&&!s?"nw":a&&s&&!o&&!r?"ne":o&&r&&!a&&!s?"sw":o&&s&&!a&&!r?"se":"none"})(e,t,n,l),a=0===e||0===n?"horizontal":0===t||0===l?"vertical":"none";return`${i}_${a}`},[e,t,n,l]),p=s[d]||"none";return(0,r.jsx)(o.xu,{color:"default",dangerouslySetInlineStyle:{__style:{top:e,left:t,right:l,bottom:n,clipPath:p,transition:c,opacity:h}},"data-test-id":d,height:u,position:"absolute",rounding:"circle",width:u})}var u=n(642407);function c({anchorSize:e,corner:t,maxTouchSize:n}){(0,i.Z)("AnchorTouchArea","/app/packages/Cropper/AnchorTouchArea.tsx");let a=u.FA[t],s=`${u.tT} ${t}`,l=Math.min(u.e4*u.MS,n),c=(l-e)/2,h=t.includes("n")?-c:void 0,d=t.includes("w")?-c:void 0,p=t.includes("s")?-c:void 0,x=t.includes("e")?-c:void 0;return(0,r.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{top:h,left:d,bottom:p,right:x,cursor:a,pointerEvents:"auto"}},"data-test-id":`cropper-corner-${t}`,height:l,id:s,position:"absolute",width:l})}var h=n(462404);let d=({x:e,y:t,size:n})=>`linear-gradient(black, black) ${e}px ${t}px / ${n}px ${n}px no-repeat`;function p({anchorSelection:e,h:t,handleCount:n,size:s,transition:p,visibility:x,w:y,x:f,y:m}){(0,i.Z)("CropperAnchors","/app/packages/Cropper/CropperAnchors.tsx");let g=2===n,v=g?u.jf:u.m6,w=g?u.O3:u.ps,S=s/2,b=u.e4/2-u.xh-w-u.eq+(0,h.Z)({w:y,h:t,minSize:u.eq,maxSize:0}),_=y+2*S-2*b,k=t+2*S-2*b,M=u.e4-s,j=Math.max(u.CT-M,u.AL),z=u.xh/2,$=s-z,Z=$-z,C=(Math.min(_,k)-u.dH)/2,P="ne"===e?1:v,E=d({x:_-$,y:0,size:$}),I="nw"===e?1:v,F=d({x:0,y:0,size:$}),A="sw"===e?1:v,T=d({x:0,y:k-$,size:$}),R="se"===e?1:v,D=d({x:_-$,y:k-$,size:$});return(0,r.jsxs)(o.xu,{dangerouslySetInlineStyle:{__style:{top:m-S+b,left:f-S+b,pointerEvents:"none",visibility:x,transition:p}},height:k,position:"absolute",width:_,children:[(0,r.jsx)(o.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${u.xh}px solid white`,borderRadius:`${j}px`,mask:E,pointerEvents:"none",transition:p,opacity:P}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(l,{opacity:P,right:0,size:u.xh,top:Z,transition:p}),(0,r.jsx)(l,{opacity:P,right:Z,size:u.xh,top:0,transition:p}),(0,r.jsx)(c,{anchorSize:s,corner:"ne",maxTouchSize:C}),(0,r.jsx)(o.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${u.xh}px solid white`,borderRadius:`${j}px`,mask:T,pointerEvents:"none",transition:p,opacity:A}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(l,{bottom:0,left:Z,opacity:A,size:u.xh,transition:p}),(0,r.jsx)(l,{bottom:Z,left:0,opacity:A,size:u.xh,transition:p}),(0,r.jsx)(c,{anchorSize:s,corner:"sw",maxTouchSize:C}),!g&&(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)(o.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${u.xh}px solid white`,borderRadius:`${j}px`,mask:F,pointerEvents:"none",transition:p,opacity:I}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(l,{left:0,opacity:I,size:u.xh,top:Z,transition:p}),(0,r.jsx)(l,{left:Z,opacity:I,size:u.xh,top:0,transition:p}),(0,r.jsx)(c,{anchorSize:s,corner:"nw",maxTouchSize:C}),(0,r.jsx)(o.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${u.xh}px solid white`,borderRadius:`${j}px`,mask:D,pointerEvents:"none",transition:p,opacity:R}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(l,{bottom:0,opacity:R,right:Z,size:u.xh,transition:p}),(0,r.jsx)(l,{bottom:Z,opacity:R,right:0,size:u.xh,transition:p}),(0,r.jsx)(c,{anchorSize:s,corner:"se",maxTouchSize:C})]})]})}},442212:function(e,t,n){n.d(t,{Z:()=>g});var i=n(281098),a=n(667294),o=n(20256),r=n(521009),s=n(642407),l=n(101844),u=n(740787),c=n(598600),h=n(826972),d=n(462404),p=n(503246),x=n(187356),y=n(274320),f=n(378547),m=n(785893);function g({children:e,cropArea:{x:t,y:n,w:g,h:v},cropSource:w,hoveredCutoutIndex:S,imageContainerX:b,imageContainerY:_,imageSize:{width:k=1,height:M=1},objectDetection:j,onChange:z,setHoveredCutoutIndex:$,setSelectedCutoutIndex:Z,viewParameter:C,viewType:P}){(0,i.Z)("CropperV2","/app/packages/Cropper/CropperV2.tsx");let{checkExperiment:E}=(0,y.r)(),I=(0,r.Z)(),F=(0,a.useRef)(null),A=(0,a.useMemo)(()=>({x:0,y:0,w:k,h:M}),[M,k]),T=(0,a.useMemo)(()=>(0,c.Z)({cropArea:{x:t,y:n,w:g,h:v},imageSize:{width:k,height:M}}),[v,g,t,n,M,k]),[R,D]=(0,a.useState)(()=>(0,p.ZP)({x:t,y:n,w:g,h:v},A)?A:T),L=(0,a.useMemo)(()=>(0,p.ZP)(R,A),[R,A]),[W,K]=(0,a.useState)("none"),[O,H]=(0,a.useState)("none"),[B,G]=(0,a.useState)(!1),[q,V]=(0,a.useState)(!1),[J,U]=(0,a.useState)(!1),[X,N]=(0,a.useState)(0),[Y,Q]=(0,a.useState)(0),{anyEnabled:ee,group:et}=E("web_cropper_object_selection"),{x:en,y:ei,w:ea,h:eo}=R,er=(0,a.useMemo)(()=>(0,d.Z)({w:ea,h:eo,minSize:s.Zn,maxSize:s.e4}),[eo,ea]),es=s.e4-er,el=ee?s.O3:s.ps,eu=s.Y4-er,ec=s.SP,eh=s.SP,ed=k-s.SP,ep=M-s.SP,ex="number"==typeof S,ey=q?"none":"0.3s cubic-bezier(0.42, 0, 0.58, 1.2)",ef=(0,u.Z)({cropperSelection:W,anchorSelection:O,hasMouseMoved:q}),em=ee?function({cropperSelection:e,isTargetOnObject:t,cropSource:n,hasClickedOnObject:i,experimentGroup:a}){return("none"===e||t)&&(9===n||i)?"enabled_dark"===a?s.pg:s.z3:0}({cropperSelection:W,isTargetOnObject:B,cropSource:w,hasClickedOnObject:J,experimentGroup:et}):0,eg=e=>{e.preventDefault(),e.stopPropagation();let{clientX:t,clientY:n,target:i}=e,a=t-b,o=n-_;V(!1),U(!1),N(a),Q(o);let{id:r}=i,[l,u="none"]=r.split(" "),c=`${l}`===s.tT,h=r===s.at,d=r===s.eX,p=r===x.P,y=r===f.I;c?(K("anchor"),H(u)):d?K("cropbox"):h?K("background"):(!(en<a&&a<en+ea&&ei<o&&o<ei+eo)||L?K("background"):K("cropbox"),G(p||y))},ev=e=>{if("none"===W)return;let{clientX:t,clientY:n}=e,i=t-b,a=n-_;if(!(Math.abs(i-X)<s.yG&&Math.abs(a-Y)<s.yG&&!q&&["cropbox","background"].includes(W)))switch(V(!0),G(!1),$?.(null),Z?.(-1),W){case"anchor":{let e=["nw","sw"].includes(O),t=["nw","ne"].includes(O),n=Math.max(Math.min(i,ed),ec),o=Math.max(Math.min(a,ep),eh),r=e?Math.min(n,en+ea-s.yz):en;D({x:r,y:t?Math.min(o,ei+eo-s.yz):ei,w:e?Math.max(en+ea-n,s.yz):Math.max(n-en,s.yz),h:t?Math.max(ei+eo-o,s.yz):Math.max(o-ei,s.yz)});break}case"cropbox":{let e=Math.max(Math.min(en+(i-X),k-ea-ec),ec),t=Math.max(Math.min(ei+(a-Y),M-eo-eh),eh);N(i),Q(a),D({x:e,y:t,w:ea,h:eo});break}case"background":{let e=Math.max(Math.min(i,k),0),t=Math.max(Math.min(a,M),0),n=e-X,o=t-Y;D({x:Math.min(X,e),y:Math.min(Y,t),w:Math.abs(n),h:Math.abs(o)})}}},ew=()=>{if(K("none"),H("none"),G(!1),V(!1),"none"===W)return;if(B&&("cutouts"===j&&ex||"dots"===j))return void U(!0);let e=(e,t)=>{z({cropArea:e,cropSource:t}),D(e)};if(q){let t=Math.max(Math.min(en,k-s.yz-ec),ec),n=Math.max(Math.min(ei,M-s.yz-eh),eh),i=eo<s.yz?s.yz:n+eo>M-eh?M-n-eh:eo,a=ea<s.yz?s.yz:t+ea>k-ec?k-t-ec:ea;e({x:t,y:n,w:a,h:i},6),"cropbox"===W?I({event_type:7603,view_type:P,view_parameter:C}):"anchor"===W?I({event_type:7604,view_type:P,view_parameter:C}):"background"===W&&I({event_type:16584,view_type:P,view_parameter:C})}else L||"background"===W?(e((0,h.Z)({mouseX:X,mouseY:Y,cropSize:s.Rk,minBound:s.SP,imageWidth:k,imageHeight:M}),6),I({event_type:16585,view_type:P,view_parameter:C})):"cropbox"===W&&(e(A,5),I({event_type:16586,view_type:P,view_parameter:C}))};return(0,a.useEffect)(()=>{J&&D(T)},[T,J]),(0,a.useEffect)(()=>{let e=F.current;return e?.addEventListener("mousedown",eg),window.addEventListener("mousemove",ev),window.addEventListener("mouseup",ew),()=>{e?.removeEventListener("mousedown",eg),window.removeEventListener("mousemove",ev),window.removeEventListener("mouseup",ew)}}),(0,m.jsxs)(o.xu,{ref:F,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:ef}},"data-test-id":"visual-search-cropper",left:!0,position:"absolute",right:!0,top:!0,children:[(0,m.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{border:`${el}px solid rgba(255, 255, 255, 0.20)`,borderRadius:`${eu}px`,boxShadow:"0 0 0 99999px rgba(0, 0, 0, 0.35)",left:en,top:ei,transition:ey,backgroundColor:`rgba(0, 0, 0, ${em})`}},height:eo,position:"absolute",width:ea}),(0,m.jsx)(o.xu,{bottom:!0,id:s.at,left:!0,position:"absolute",right:!0,top:!0}),(0,m.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{visibility:L?"hidden":"visible",left:en,top:ei}},"data-test-id":"cropper-section",height:eo,id:s.eX,position:"absolute",width:ea}),e,(0,m.jsx)(l.Z,{anchorSelection:O,h:eo,handleCount:ee?2:4,size:es,transition:ey,visibility:L||"background"===W&&q?"hidden":"visible",w:ea,x:en,y:ei})]})}},740787:function(e,t,n){n.d(t,{Z:()=>i});function i({cropperSelection:e,anchorSelection:t,hasMouseMoved:n}){if("background"===e&&n)return"crosshair";if("cropbox"===e&&n)return"move";if("anchor"===e){if("nw"===t||"se"===t)return"nwse-resize";else if("ne"===t||"sw"===t)return"nesw-resize"}return"auto"}},598600:function(e,t,n){n.d(t,{Z:()=>a});var i=n(642407);function a({cropArea:e,imageSize:t}){let{x:n,y:a,w:o,h:r}=e,{height:s,width:l}=t;if(!s||!l)return e;let u=n,c=a,h=o,d=r;return u<i.SP&&(u=i.SP,h-=i.SP-n),u+h>l-i.SP&&(h-=u+h-l+i.SP),c<i.SP&&(c=i.SP,d-=i.SP-a),c+d>s-i.SP&&(d-=c+d-s+i.SP),{x:u,y:c,w:h,h:d}}},826972:function(e,t,n){n.d(t,{Z:()=>a});let i=({coordinate:e,cropSize:t,maxBound:n,minBound:i})=>e<=i?i:n<=e+t?n-t:e;function a({cropSize:e,imageHeight:t,imageWidth:n,minBound:a,mouseX:o,mouseY:r}){let s=o-e/2,l=r-e/2,u=n-a,c=t-a;return{x:i({coordinate:s,minBound:a,maxBound:u,cropSize:e}),y:i({coordinate:l,minBound:a,maxBound:c,cropSize:e}),w:e,h:e}}},462404:function(e,t,n){n.d(t,{Z:()=>a});var i=n(642407);function a({w:e,h:t,minSize:n,maxSize:a}){let o=Math.min(e,t);return o<=i.yz?a-n:o<i.Kw?(a-n)/(i.Kw-i.yz)*(i.Kw-o):0}},187356:function(e,t,n){n.d(t,{P:()=>s,Z:()=>c}),n(281098);var i=n(667294),a=n(20256),o=n(19585),r=n(785893);let s="flashlight-dot-style",l=16,u=32,c=(0,i.forwardRef)(({icon:e,onClick:t,onMouseDown:n,onMouseEnter:c,onMouseLeave:h,onMouseUp:d,selected:p,style:x,text:y,x:f,y:m,zIndex:g,backdropDiameter:v=u,dotDiameter:w=l},S)=>{let[b,_]=(0,i.useState)(!1),k=(0,o.Z)(),M=b?v+4:v;return(0,r.jsx)(a.xu,{ref:S,dangerouslySetInlineStyle:{__style:{top:m-M/2,left:f-M/2,outline:"none"}},position:"absolute",zIndex:new a.Ry(g||0),children:(0,r.jsx)(a.iP,{accessibilityLabel:k._('Search this item', 'flashlight.dot.a11ylabel', 'accessibility label for flashlight dot'),dataTestId:"flashlight-dot",onMouseDown:n,onMouseEnter:({event:e})=>{_(!0),c?.({event:e})},onMouseLeave:({event:e})=>{_(!1),h?.({event:e})},onMouseUp:d,onTap:t,tabIndex:0,children:(0,r.jsxs)(a.xu,{alignItems:"center",borderStyle:"none",color:"default",dangerouslySetInlineStyle:{__style:{boxShadow:p?"0 0 0 3px #e60023":"none",borderRadius:w,top:(M-w)/2,left:(M-w)/2,...x}},"data-test-id":s,display:"flex",height:w,id:s,justifyContent:"center",padding:0,position:"absolute",width:w,children:[!!y&&(0,r.jsx)(a.xv,{align:"center",color:"default",inline:!0,size:"100",weight:"bold",children:y}),e&&(0,r.jsx)(a.JO,{accessibilityLabel:k._('Tag anchor', 'accessibility label for an anchor for an object in a pin', 'accessibility label for an anchor for an object in a pin'),color:"error",icon:e,inline:!0,size:w/2})]})})})})},941023:function(e,t,n){n.d(t,{Z:()=>m});var i,a=n(281098),o=n(667294);n(167912);var r=n(521009),s=n(187356),l=n(341742),u=n(785893);function c({showAnimation:e,auxData:t,index:n,isStela:i,onClick:o,onHover:c,onUnhover:h,spotlightCenter:d,viewParameter:p,viewType:x}){(0,a.Z)("FlashlightSpotlightDot","/app/packages/Flashlight/FlashlightSpotlightDot.tsx");let y=(0,r.Z)(),f=i?1221:1260;(0,l.Z)(()=>{y({event_type:120,element:f,aux_data:t,view_parameter:p,view_type:x})});let m=parseFloat((.1*(n+1)).toFixed(2)),g={animation:e?`spotlightDotPop 0.6s ease-out ${m}s both`:"none"};return(0,u.jsx)(s.Z,{onClick:()=>{y({aux_data:t,element:f,event_type:101,view_parameter:p,view_type:x}),o(n)},onMouseEnter:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),c?.(n)},onMouseLeave:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),h?.()},style:g,x:d.x,y:d.y})}var h=n(415546),d=n(369416),p=n(431338),x=n(556872);let y=`
@keyframes spotlightDotPop {
  0% {
    transform: scale(0);
  }

  100% {
    transform: scale(1);
  }
}`,f=(void 0!==i||(i=n(625957)).hash&&"3a8409077905af94eb39568e4a5a57fc"!==i.hash&&console.error("The definition of 'FlashlightSpotlightDots_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),m=({showAnimation:e,pinKey:t,imageSignature:n,imageSize:i,currentSpotlightIdx:r,handleSpotlightClick:s,handleSpotlightHover:l,handleSpotlightUnhover:m,viewParameter:g,viewType:v,visualObjects:w})=>{(0,a.Z)("FlashlightSpotlightDots","/app/packages/Flashlight/FlashlightSpotlightDots.tsx");let S=(0,h.Z)(f,t),b=(0,p.Z)(S),_=S?(S.visualObjects??[]).filter(e=>e.isStela):w??[];return(0,u.jsxs)(o.Fragment,{children:[(0,u.jsx)(d.Z,{unsafeCSS:y}),_.map((t,a)=>{if(a===r)return null;let{x:o,y:h,w:d,h:p}=t,y=(0,x.Z)({cropArea:{x:o,y:h,w:d,h:p},scaledWidth:i.width??0,scaledHeight:i.height??0}),f={x:y.x+y.w/2,y:y.y+y.h/2},w={...b({override:{entrypoint:"flashlight"}}),pin_id:S?.entityId??"",image_signature:n,visual_objects:JSON.stringify([{x:t.x,y:t.y,w:t.w,h:t.h}])},_=`${f.x}${f.y}`;return(0,u.jsx)(c,{auxData:w,index:a,isStela:!!t?.isStela,onClick:s,onHover:l,onUnhover:m,showAnimation:e,spotlightCenter:f,viewParameter:g,viewType:v},_)})]})}},74678:function(e,t,n){n.d(t,{Z:()=>i});function i({cropArea:{x:e,y:t,w:n,h:i},scaledWidth:a,scaledHeight:o}){return{x:e/a,y:t/o,w:n/a,h:i/o}}},556872:function(e,t,n){n.d(t,{Z:()=>i});function i({cropArea:e,scaledWidth:t,scaledHeight:n}){let i=e.h||0;return{h:Math.floor(i*n),w:Math.floor((e.w||0)*t),x:Math.floor((e.x||0)*t),y:Math.floor((e.y||0)*n)}}},854146:function(e,t,n){n.d(t,{Z:()=>h});var i=n(281098),a=n(667294),o=n(633301),r=n(20256),s=n(274320),l=n(665290),u=n(281503),c=n(785893);function h({imageHeight:e,imageUrl:t,imageWidth:n,isHovered:h,isPinLevelCrop:d,isSelected:p,maskHeight:x,maskId:y,maskUrl:f,maskWidth:m,maskX:g,maskY:v}){(0,i.Z)("CutoutOverlay","/app/www/Cutouts/CutoutOverlay.tsx");let{checkExperiment:w}=(0,s.r)(),S=w("web_cropper_object_selection").anyEnabled,b=(0,a.useRef)(null),_=S?h||p:h,k=d&&h?1.2:1,{svgElement:M,maskStyle:j}=(0,u.Z)({maskUrl:f,maskWidth:m,maskHeight:x,maskId:y,kind:"overlay"});return(0,c.jsx)(o.Z,{appear:p,classNames:l.We,in:_,nodeRef:b,timeout:{appear:l.VI,enter:l.eZ,exit:l.eZ},children:(0,c.jsxs)(r.xu,{ref:b,dangerouslySetInlineStyle:{__style:{left:g,top:v,...j,pointerEvents:"none",filter:`brightness(${k})`}},height:x,opacity:0,overflow:"hidden",position:"absolute",width:m,children:[M,(0,c.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{transform:`translate(-${g}px, -${v}px)`}},height:e,width:n,children:(0,c.jsx)(r.Ee,{alt:"cutout-overlay-image",color:"transparent",fit:"cover",naturalHeight:e,naturalWidth:n,src:t})})]})})}},378547:function(e,t,n){n.d(t,{Z:()=>v,I:()=>m});var i,a=n(281098),o=n(667294);n(167912);var r=n(825332),s=n(20256),l=n(980787),u=n(642407),c=n(415546),h=n(728994),d=n(854146);function p({contour:e,context:t,contourXRatio:n,contourYRatio:i}){t.beginPath(),e.points.forEach((e,a)=>{if(e){let o=e.x*n,r=e.y*i;0===a?t.moveTo(o,r):t.lineTo(o,r)}})}var x=n(814685),y=n(330510),f=n(785893);let m="stela-cutout",g=(void 0!==i||(i=n(703555)).hash&&"0b66eea622c037ef845cce3aa4cd2d46"!==i.hash&&console.error("The definition of 'StelaCutout_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function v({auxData:e,bitmapData:t,hasAnimatedCutoutsOnLand:n,hasLoggedRender:i,hoveredCutoutIndex:v,index:w,isPinLevelCrop:S,pinImageHovered:b,pinKey:_,selectedCutoutIndex:k,setHasAnimatedCutoutsOnLand:M,setHasLoggedRender:j,viewParameter:z,viewType:$}){(0,a.Z)("StelaCutout","/app/www/Cutouts/StelaCutout.tsx");let Z=(0,y.D)(),{logContextEvent:C}=(0,l.u)(),P=(0,r.TH)(),E=(0,c.Z)(g,_),{getNormalizedPinImage:I}=(0,h.Z)({pinKey:E,maxWidth:Z?x.M:u.Wm}),F=(0,o.useRef)(null),A=(0,o.useRef)(null),T=(0,o.useRef)(null),[R,D]=(0,o.useState)(0),[L,W]=(0,o.useState)(!1),[K,O]=(0,o.useState)(0),[H,B]=(0,o.useState)(!1),G=P.pathname.includes("visual-search"),{height:q,width:V,url:J}=I(),{contours:U,contourXRatio:X,contourYRatio:N,id:Y,isHidden:Q,maskHeightRatio:ee,maskUrl:et,maskWidthRatio:en,maskXRatio:ei,maskYRatio:ea}=t,eo=ei*V,er=ea*q,es=en*V,el=ee*q,eu=v===w,ec=k===w,eh=U&&U.length>0;(0,o.useEffect)(()=>{i||(C({event_type:120,element:14154,view_parameter:z,view_type:$,aux_data:e}),j?.(!0))},[e,i,C,j,z,$]),(0,o.useEffect)(()=>{F.current&&(F.current.width=es,F.current.height=el,A.current=new(window.OffscreenCanvas||window.HTMLCanvasElement)(es,el))},[es,el]);let ed=(0,o.useCallback)(()=>{B(!0)},[]);return(0,o.useEffect)(()=>{let e=F.current;return e?.addEventListener("transitionend",ed),()=>{e?.removeEventListener("transitionend",ed)}}),(0,o.useEffect)(()=>{if(!F.current||!A.current||!eh||!X||!N)return;let e=F.current.getContext("2d");return n?void e?.clearRect(0,0,F.current.width,F.current.height):((!H||b||Q&&eu)&&(T.current=requestAnimationFrame(()=>{if(!F.current||!A.current)return;let t=A.current.getContext("2d");e&&t&&(!function({contours:e,context:t,hasAnimatedCutoutsOnLand:n,hoveredCutoutIndex:i,index:a,isHidden:o,contourXRatio:r,contourYRatio:s,setTraceProgress:l,setHasAnimatedCutoutsOnLand:u,style:c,traceProgress:h,selectedCutoutIndex:d}){if(t.clearRect(0,0,t.canvas.width,t.canvas.height),!e||0===e.length||d===i&&i===a||d===a)return;let x={trace:{strokeStyle:"#fff",lineWidth:2},outline:{strokeStyle:"#fff",lineWidth:3}},y=o&&i===a,f=!o||y;if("trace"===c&&void 0!==h){let o=h,d=e[0].points.length;if(n){if(y||i===a){l(o=(o+900/((e,t,n)=>{let i=0;for(let a=0;a<e.length-1;a+=1){let o=e[a],r=e[a+1];if(o&&r){let e=(r.x-o.x)*t,a=(r.y-o.y)*n;i+=Math.sqrt(e*e+a*a)}}if(e.length>0){let a=e[0],o=e[e.length-1];if(a&&o){let e=(a.x-o.x)*t,r=(a.y-o.y)*n;i+=Math.sqrt(e*e+r*r)}}return i})(e[0].points,r,s)*3.2/1e3)%1);let n=Math.floor(.33*d),i=Math.floor(d*o),a=(i-n+d)%d;e.map(e=>({...e,points:a<i?e.points.slice(a,i):e.points.slice(a).concat(e.points.slice(0,i))})).forEach(e=>{e.points.length>1&&(t.strokeStyle=x[c].strokeStyle,p({contour:e,context:t,contourXRatio:r,contourYRatio:s}),f&&(t.lineWidth=x[c].lineWidth,t.stroke()))})}}else{let n,i;if(l(o+=o<=1?.0032:.009600000000000001),o>=2){l(1),u(!0);return}let a=Math.floor(.33*d);o<=1?i=((n=Math.floor(d*o))-a+d)%d:(n=d,i=Math.floor(d-a+a*(o-1))),e.map(e=>{let t=[];return t=i<n?e.points.slice(i,n):e.points.slice(i).concat(e.points.slice(0,n)),{...e,points:t}}).forEach(e=>{e.points.length>1&&(t.strokeStyle=x[c].strokeStyle,p({contour:e,context:t,contourXRatio:r,contourYRatio:s}),f&&(t.lineWidth=x[c].lineWidth,t.stroke()))})}}else e.forEach(e=>{p({contour:e,context:t,contourXRatio:r,contourYRatio:s}),f&&(t.strokeStyle=x[c].strokeStyle,t.lineWidth=x[c].lineWidth,t.stroke(),i===a&&(t.save(),t.fillStyle="rgba(255, 255, 255, 0.25)",t.fill(),t.restore()))})}({contours:U,context:t,contourXRatio:X,contourYRatio:N,index:w,isHidden:Q,hoveredCutoutIndex:v,opacity:R,setTraceProgress:O,hasAnimatedCutoutsOnLand:n,setHasAnimatedCutoutsOnLand:M,style:"trace",traceProgress:K,selectedCutoutIndex:k}),e.clearRect(0,0,F.current.width,F.current.height),e.drawImage(A.current,0,0))})),()=>{T.current&&(cancelAnimationFrame(T.current),T.current=null)})},[X,N,U,n,eh,v,w,H,Q,eu,R,b,k,M,K]),(0,o.useEffect)(()=>{if(b)W(!0),D(1);else if(L)D(0);else{D(1);let e=setTimeout(()=>{W(!1),D(0)},3e3);return()=>clearTimeout(e)}},[b,L,D]),(0,f.jsxs)(s.xu,{children:[(0,f.jsx)(d.Z,{imageHeight:q,imageUrl:J,imageWidth:V,isHovered:eu,isPinLevelCrop:S,isSelected:ec,maskHeight:el,maskId:Y,maskUrl:et,maskWidth:es,maskX:eo,maskY:er}),eh&&(0,f.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{top:er,left:eo}},height:el,position:"absolute",width:es,children:(0,f.jsx)("canvas",{ref:F,"data-test-id":"cutout-item",id:m,style:{opacity:G||b?1:R,transition:b||L||G?"none":"opacity 2s linear 1s"}})})]})}},665290:function(e,t,n){n.d(t,{Ii:()=>i,VI:()=>o,We:()=>a,eZ:()=>r,iF:()=>s});let i="stela-cutout",a="cutout-fade",o=2e3,r=300,s=`
  .${a}-appear {
    opacity: 0;
  }
  .${a}-appear-active {
    opacity: 1;
    transition: opacity ${o}ms;
  }
  .${a}-appear-done {
    opacity: 1;
  }

  .${a}-enter {
    opacity: 0;
  }
  .${a}-enter-active {
    opacity: 1;
    transition: opacity ${r}ms;
  }
  .${a}-enter-done {
    opacity: 1;
  }

  .${a}-exit {
    opacity: 1;
  }
  .${a}-exit-active {
    opacity: 0;
    transition: opacity ${r}ms;
  }
  .${a}-exit-done {
    opacity: 0;
  }
`},281503:function(e,t,n){n.d(t,{Z:()=>o});var i=n(281098),a=n(785893);function o({blurIntensity:e=.1,debugMode:t=!1,insetIntensity:n=2,kind:o,maskHeight:r,maskId:s,maskUrl:l,maskWidth:u,maxBlurLength:c=100}){(0,i.Z)("getInsetBlurMask","/app/www/Cutouts/getInsetBlurMask.tsx");let h=`${o}-${s}`,d=`insetBlurFilter-${h}`,p=`originalMask-${h}`,x=`featheredMask-${h}`,y=Math.min(c,Math.round(Math.min(u,r)))*e;return{svgElement:(0,a.jsxs)("svg",{"data-gestalt-valid-html":"Image",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:[(0,a.jsxs)("defs",{children:[(0,a.jsxs)("filter",{id:d,children:[(0,a.jsx)("feGaussianBlur",{edgeMode:"none",stdDeviation:y}),(0,a.jsx)("feComponentTransfer",{children:(0,a.jsx)("feFuncA",{amplitude:"1",exponent:n,offset:"0",type:"gamma"})})]}),(0,a.jsx)("mask",{id:p,children:(0,a.jsx)("image",{height:r,href:l,id:`${p}-image`,width:u})}),(0,a.jsx)("use",{href:`#${p}-image`,id:`${p}-white`,mask:`url(#${p})`}),(0,a.jsx)("mask",{id:x,children:(0,a.jsx)("use",{filter:`url(#${d})`,href:`#${p}-white`,mask:`url(#${p})`})})]}),t&&(0,a.jsx)("rect",{fill:"green",height:r,mask:`url(#${x})`,width:u,x:"0",y:"0"})]}),maskStyle:{mask:`url(#${x})`}}}},814685:function(e,t,n){n.d(t,{M:()=>i});let i=520}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/49793-ba54426a2b1c9ed9.mjs.map